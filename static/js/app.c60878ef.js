(function(){"use strict";var e={69:function(e,t,a){a.r(t),a.d(t,{default:function(){return he}});var s=a(6768),r=a(4232);const i={key:0,class:"loading-overlay"},o=["src"],n={class:"homepage container mt-5"},l={class:"carousel-section"},c={key:0,class:"loading-spinner"},d={key:1,id:"mainCarousel",class:"carousel slide position-relative carousel-fade","data-bs-ride":"carousel"},u={class:"carousel-indicators custom-indicators"},p=["data-bs-slide-to","aria-current","aria-label"],m={class:"carousel-inner rounded-4 shadow-lg"},h={class:"carousel-image-container"},g=["src"],k={key:1,class:"product-section mt-5"},f={class:"product-grid"},b={class:"product-image-wrapper"},v=["src"],L={class:"product-overlay"},y=["onClick","disabled"],w={class:"product-info"},C={class:"product-name"},I={key:0,class:"product-tag"},P={class:"sales-ranking mt-5"},A={key:0},_={key:1},E={key:2},F={class:"product-list"},x={class:"product-thumbnail-wrapper"},S=["src"],O={class:"product-overlay"},U=["onClick","disabled"],R={class:"product-details"},D={class:"range-name"},T={class:"product-name"},$={class:"sales-count"},M={class:"sales-ranking mt-5"},N={key:0},X={key:1},q={key:2},W={class:"product-list"},V={class:"product-thumbnail-wrapper"},B=["src"],K={class:"product-overlay"},J=["onClick","disabled"],Q={class:"product-details"},j={class:"range-name"},z={class:"product-name"},H={class:"sales-count"},G={key:2,class:"sales-ranking mt-4"},Z={class:"product-list"},Y={class:"product-thumbnail-wrapper"},ee=["src"],te={class:"product-overlay"},ae=["onClick","disabled"],se={class:"product-details"},re={class:"product-name"},ie={class:"price",style:{color:"red"}};function oe(e,t,a,oe,ne,le){return(0,s.uX)(),(0,s.CE)(s.FK,null,[ne.isPageLoading?((0,s.uX)(),(0,s.CE)("div",i,[(0,s.Lk)("img",{src:ne.loadingGif,alt:"載入中",class:"loading-gif"},null,8,o)])):(0,s.Q3)("",!0),(0,s.Lk)("div",n,[(0,s.Lk)("div",l,[ne.isLoading.carousel?((0,s.uX)(),(0,s.CE)("div",c,t[5]||(t[5]=[(0,s.Lk)("div",{class:"spinner-border",role:"status"},[(0,s.Lk)("span",{class:"visually-hidden"},"加載中...")],-1)]))):ne.carouselImages&&ne.carouselImages.length?((0,s.uX)(),(0,s.CE)("div",d,[(0,s.Lk)("div",u,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(ne.carouselImages,((e,t)=>((0,s.uX)(),(0,s.CE)("button",{key:"indicator-"+t,type:"button","data-bs-target":"#mainCarousel","data-bs-slide-to":t,class:(0,r.C4)([{active:0===t},"indicator-dot"]),"aria-current":0===t,"aria-label":"Slide"+(t+1)},null,10,p)))),128))]),(0,s.Lk)("div",m,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(ne.carouselImages,((a,i)=>((0,s.uX)(),(0,s.CE)("div",{key:"slide-"+i,class:(0,r.C4)(["carousel-item",{active:0===i}])},[(0,s.Lk)("div",h,[(0,s.Lk)("img",{src:e.$getImageUrl(a.url,"carousel"),class:"d-block w-100",alt:"輪播圖片",onError:t[0]||(t[0]=(...e)=>le.handleCarouselImageError&&le.handleCarouselImageError(...e))},null,40,g)])],2)))),128))]),t[6]||(t[6]=(0,s.Fv)('<button class="carousel-control-prev custom-control" type="button" data-bs-target="#mainCarousel" data-bs-slide="prev" data-v-61b5ad9a><span class="carousel-control-prev-icon" aria-hidden="true" data-v-61b5ad9a></span><span class="visually-hidden" data-v-61b5ad9a>Previous</span></button><button class="carousel-control-next custom-control" type="button" data-bs-target="#mainCarousel" data-bs-slide="next" data-v-61b5ad9a><span class="carousel-control-next-icon" aria-hidden="true" data-v-61b5ad9a></span><span class="visually-hidden" data-v-61b5ad9a>Next</span></button>',2))])):(0,s.Q3)("",!0)])]),ne.randomProducts&&ne.randomProducts.length>0?((0,s.uX)(),(0,s.CE)("div",k,[t[7]||(t[7]=(0,s.Lk)("div",{class:"section-header"},[(0,s.Lk)("h2",{class:"section-title"},"為您推薦"),(0,s.Lk)("div",{class:"section-subtitle"},"精選優質商品，專屬於您")],-1)),(0,s.Lk)("div",f,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(ne.randomProducts,((a,i)=>((0,s.uX)(),(0,s.CE)("div",{key:i,class:"product-card",style:(0,r.Tr)({animationDelay:.1*i+"s"})},[(0,s.Lk)("div",b,[(0,s.Lk)("img",{src:e.$getImageUrl(a.image,"product"),class:"product-image",onError:t[1]||(t[1]=(...t)=>e.handleImageError&&e.handleImageError(...t))},null,40,v),(0,s.Lk)("div",L,[(0,s.Lk)("button",{class:"view-details-btn",onClick:e=>le.viewDetails(a),disabled:!a||!a.id}," 查看詳情 ",8,y)])]),(0,s.Lk)("div",w,[(0,s.Lk)("h3",C,(0,r.v_)(a.name),1),"-"===a.quantity_sold?((0,s.uX)(),(0,s.CE)("div",I,"熱門推薦")):(0,s.Q3)("",!0)])],4)))),128))])])):(0,s.Q3)("",!0),t[15]||(t[15]=(0,s.Lk)("div",{class:"section-divider"},null,-1)),(0,s.Lk)("div",P,[t[10]||(t[10]=(0,s.Lk)("h2",null,"過去7日銷售排行",-1)),ne.isLoading.sales?((0,s.uX)(),(0,s.CE)("div",A,"載入中...")):ne.errors.sales?((0,s.uX)(),(0,s.CE)("div",_,(0,r.v_)(ne.errors.sales),1)):0===ne.sevenDaySalesRanking.length?((0,s.uX)(),(0,s.CE)("div",E,"暫無銷售數據")):(0,s.Q3)("",!0),(0,s.Lk)("div",F,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(ne.sevenDaySalesRanking,((a,i)=>((0,s.uX)(),(0,s.CE)("div",{key:i,class:"product-item"},[(0,s.Lk)("div",x,[(0,s.Lk)("img",{src:e.$getImageUrl(a.image,"product"),class:"product-thumbnail",onError:t[2]||(t[2]=(...t)=>e.handleImageError&&e.handleImageError(...t))},null,40,S),(0,s.Lk)("div",O,[(0,s.Lk)("button",{class:"view-details-btn",onClick:e=>le.viewDetails(a),disabled:!a||!a.id}," 查看詳情 ",8,U)])]),(0,s.Lk)("div",R,[(0,s.Lk)("div",D,[t[8]||(t[8]=(0,s.eW)("銷售排行第 ")),(0,s.Lk)("span",{class:(0,r.C4)(["range-number",ne.rankClass[i+1]])},(0,r.v_)(i+1),3),t[9]||(t[9]=(0,s.eW)("名 "))]),(0,s.Lk)("div",T,(0,r.v_)(a.name),1),(0,s.Lk)("div",$,"賣出 "+(0,r.v_)(a.sales_count)+" 件",1)])])))),128))])]),t[16]||(t[16]=(0,s.Lk)("div",{class:"section-divider"},null,-1)),(0,s.Lk)("div",M,[t[13]||(t[13]=(0,s.Lk)("h2",null,"過去30日銷售排行",-1)),ne.isLoading.sales?((0,s.uX)(),(0,s.CE)("div",N,"載入中...")):ne.errors.sales?((0,s.uX)(),(0,s.CE)("div",X,(0,r.v_)(ne.errors.sales),1)):0===ne.monthSalesRanking.length?((0,s.uX)(),(0,s.CE)("div",q,"暫無銷售數據")):(0,s.Q3)("",!0),(0,s.Lk)("div",W,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(ne.monthSalesRanking,((a,i)=>((0,s.uX)(),(0,s.CE)("div",{key:i,class:"product-item"},[(0,s.Lk)("div",V,[(0,s.Lk)("img",{src:e.$getImageUrl(a.image,"product"),class:"product-thumbnail",onError:t[3]||(t[3]=(...t)=>e.handleImageError&&e.handleImageError(...t))},null,40,B),(0,s.Lk)("div",K,[(0,s.Lk)("button",{class:"view-details-btn",onClick:e=>le.viewDetails(a),disabled:!a||!a.id}," 查看詳情 ",8,J)])]),(0,s.Lk)("div",Q,[(0,s.Lk)("div",j,[t[11]||(t[11]=(0,s.eW)("銷售排行第 ")),(0,s.Lk)("span",{class:(0,r.C4)(["range-number",ne.rankClass[i+1]])},(0,r.v_)(i+1),3),t[12]||(t[12]=(0,s.eW)("名 "))]),(0,s.Lk)("div",z,(0,r.v_)(a.name),1),(0,s.Lk)("div",H,"賣出 "+(0,r.v_)(a.sales_count)+" 件",1)])])))),128))])]),t[17]||(t[17]=(0,s.Lk)("div",{class:"section-divider"},null,-1)),le.processedSpecialOffers.length>0?((0,s.uX)(),(0,s.CE)("div",G,[t[14]||(t[14]=(0,s.Lk)("h2",null,"特價倒數計時商品",-1)),(0,s.Lk)("div",Z,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(le.processedSpecialOffers,((a,i)=>((0,s.uX)(),(0,s.CE)("div",{key:i,class:"product-item"},[(0,s.Lk)("div",Y,[(0,s.Lk)("img",{src:e.$getImageUrl(a.image,"product"),class:"product-thumbnail",onError:t[4]||(t[4]=(...e)=>le.handleSpecialOfferImageError&&le.handleSpecialOfferImageError(...e))},null,40,ee),(0,s.Lk)("div",te,[(0,s.Lk)("button",{class:"view-details-btn",onClick:t=>e.viewDetailsById(a.product_id),disabled:!a.product_id}," 查看詳情 ",8,ae)])]),(0,s.Lk)("div",se,[(0,s.Lk)("div",re,(0,r.v_)(a.name),1),(0,s.Lk)("div",ie,"特價 "+(0,r.v_)(le.formatPrice(a.price))+"元",1),(0,s.Lk)("div",{class:(0,r.C4)(["countdown-timer",a.status])},(0,r.v_)("upcoming"===a.status?"即將開始":"剩餘時間")+" 倒數"+(0,r.v_)(le.formatTime(a.countdown)),3)])])))),128))])])):(0,s.Q3)("",!0)],64)}a(4114),a(8992),a(4520),a(2577),a(3949),a(1454);var ne=a(4300),le=a(3664),ce=a.p+"static/img/loading.6a7c5061.gif";const de={carouselImages:[{url:"/img/happynewyear.png"},{url:"/img/welcome.jpg"}]};var ue={name:"HomePage",data(){return{isPageLoading:!0,loadingTimeout:null,loadingGif:ce,sevenDaySalesRanking:[],monthSalesRanking:[],specialOffers:[],products:[],countdownIntervals:[],isLoading:{sales:!1,offers:!1,carousel:!1,products:!1},errors:{sales:null,offers:null,carousel:null,products:null},randomProducts:null,carouselImages:[...de.carouselImages],rankClass:{1:"gold",2:"silver",3:"bronze"}}},async mounted(){setTimeout((()=>{this.isPageLoading=!1}),1500);try{await this.loadHomePageData(),this.carouselImages.length>0&&(await this.$nextTick(),this.initializeCarousel()),this.startCountdown()}catch(e){}finally{this.isPageLoading=!1,clearTimeout(this.loadingTimeout)}},methods:{handleError(e,t){this.errors[e]=`無法加載 ${e} 數據，請稍後再試。`,"carousel"===e&&(this.carouselImages=de.carouselImages)},handleSpecialOfferImageError(e){e&&e.target&&(e.target.onerror=null,e.target.src="/img/wrong.png")},handleCarouselImageError(e){e&&e.target&&(e.target.src.includes("happynewyear.png")||(e.target.onerror=null,e.target.src="/img/happynewyear.png"))},async loadHomePageData(){try{await this.loadProductsData(),this.randomProducts=this.getRandomProducts(5),await this.loadCarouselData(),setTimeout((()=>{this.loadSalesData(),this.loadOffersData()}),1e3)}catch(e){}},async loadSalesData(){this.isLoading.sales=!0;try{const[e,t]=await Promise.all([ne.A.rankingAPI.getRanking(7),ne.A.rankingAPI.getRanking(30)]);e.success&&Array.isArray(e.data)?this.sevenDaySalesRanking=this.processSalesRanking(e.data):this.sevenDaySalesRanking=[],t.success&&Array.isArray(t.data)?this.monthSalesRanking=this.processSalesRanking(t.data):this.monthSalesRanking=[]}catch(e){}finally{this.isLoading.sales=!1}},processSalesRanking(e){return Array.isArray(e)?e.map((e=>({id:e.id,name:e.name,sales_count:e.sales_count||0,image:e.image?this.$getImageUrl(e.image,"product"):"/img/wrong.png"}))).filter((e=>e.sales_count>0)).slice(0,10):[]},async loadOffersData(){this.isLoading.offers=!0;try{const e=await ne.A.specialOffersAPI.getAllSpecialOffers();e&&Array.isArray(e)&&(this.specialOffers=e.map((e=>({...e,countdown:e.countdown||36e3,product_id:Number(e.product_id)}))))}catch(e){this.errors.offers="無法加載特價商品數據",this.specialOffers=[]}finally{this.isLoading.offers=!1}},async loadCarouselData(){try{const e=await ne.A.carouselAPI.getAllCarouselImages();Array.isArray(e)&&e.length>0?this.carouselImages=e.filter((e=>e.visible)).map((e=>({...e,url:this.$getImageUrl(e.url,"carousel")}))):this.carouselImages=de.carouselImages}catch(e){this.carouselImages=de.carouselImages}finally{this.isLoading.carousel=!1}},async loadProductsData(){this.isLoading.products=!0;try{const e=await ne.A.productAPI.getAllProducts();this.products=e||[]}catch(e){this.errors.products="無法加載商品列表",this.products=[]}finally{this.isLoading.products=!1}},convertToSortedRankingWithProducts(e){return Object.entries(e).map((([e,t])=>{const a=Number(e),s=this.products.find((e=>e.id===a));return{product_id:e,quantity_sold:t,name:s?s.name:"未知商品",image:s?s.image:"/img/wrong.png"}})).sort(((e,t)=>t.quantity_sold-e.quantity_sold)).slice(0,5)},startCountdown(){if(this.clearCountdownIntervals(),!this.specialOffers||0===this.specialOffers.length)return;const e=()=>{const e=Date.now();this.specialOffers=this.specialOffers.map((t=>{const a=new Date(t.start_time).getTime(),s=t.end_time?new Date(t.end_time).getTime():a+1e3*t.duration;let r=0,i="active";return e<a?(r=a-e,i="upcoming"):e>=s&&e<=s?(r=s-e,i="active"):(r=0,i="ended"),{...t,countdown:Math.floor(r/1e3),status:i}}))};e();const t=setInterval(e,1e3);this.countdownIntervals.push(t)},clearCountdownIntervals(){this.countdownIntervals.forEach((e=>clearInterval(e))),this.countdownIntervals=[]},formatTime(e){if(e<=0)return"已結束";const t=Math.floor(e/86400),a=Math.floor(e%86400/3600),s=Math.floor(e%3600/60),r=e%60;return t>0?`${t}天${a}時${s}分${r}秒`:a>0?`${a}時${s}分${r}秒`:s>0?`${s}分${r}秒`:`${r}秒`},getProductImage(e){const t=this.products.find((t=>t.id===Number(e)));return t&&t.image?this.$getImageUrl(t.image,"product"):"/img/wrong.png"},getRandomProducts(e=5){const t=[...this.products];for(let a=t.length-1;a>0;a--){const e=Math.floor(Math.random()*(a+1));[t[a],t[e]]=[t[e],t[a]]}return t.slice(0,e).map((e=>({...e,quantity_sold:"-"})))},initializeCarousel(){this.$nextTick((()=>{const e=document.getElementById("mainCarousel");e&&new le.FN(e,{interval:5e3,touch:!0,pause:"hover",keyboard:!0})}))},viewDetails(e){e&&e.id?this.$router.push({name:"ProductDetail",params:{id:String(e.id)}}):this.$store.dispatch("notifications/showNotification",{type:"error",message:"無法查看商品詳情，請稍後再試"})},formatPrice(e){return e||0===e?e.toLocaleString("zh-TW",{minimumFractionDigits:0,maximumFractionDigits:0}):"0"}},beforeUnmount(){this.clearCountdownIntervals(),this.isPageLoading&&clearTimeout(this.loadingTimeout)},computed:{processedSpecialOffers(){const e=Date.now();return[...this.specialOffers].filter((t=>{const a=new Date(t.start_time).getTime(),s=new Date(t.end_time).getTime();return(e>=a&&e<=s||e<a)&&t.countdown>0&&t.price>0})).sort(((e,t)=>e.status!==t.status?"active"===e.status?-1:1:e.countdown-t.countdown))}}},pe=a(1241);const me=(0,pe.A)(ue,[["render",oe],["__scopeId","data-v-61b5ad9a"]]);var he=me},3061:function(e,t,a){a.d(t,{A:function(){return hc}});var s=a(8029),r=a(1387),i=(a(69),a(6768));function o(e,t,a,s,r,o){return t[0]||(t[0]=(0,i.Fv)('<h1 style="color:coral;" data-v-b5050256>關於我們</h1><br data-v-b5050256><br data-v-b5050256><div data-v-b5050256><div class="title" data-v-b5050256>公司願景</div><div class="content" data-v-b5050256> ECSHOP 電商平台致力於打造一個以消費者需求為核心的全球購物平台，通過先進的技術、優質的產品及卓越的服務，提供每一位顧客最便捷、愉快的購物體驗。 我們相信，透過創新和精確的市場洞察，能為消費者和合作夥伴創造更多的價值，並推動電商產業的進步。 我們的願景是成為全球消費者心目中的首選購物平台，無論是日常所需還是高端商品，ECSHOP 都能夠滿足不同客戶的需求，並且實現跨境無縫銷售的全球電商體驗。 </div><div class="title" data-v-b5050256>未來展望</div><div class="content" data-v-b5050256> ECSHOP 將持續不斷地創造優質的產品和優秀的服務，並持續推動消費者需求的解決方案，讓消費者能更輕鬆地在全球購物。 我們也將不斷地學習和進步，以提供給消&quot;&gt;未來，ECSHOP 將持續拓展產品品類，並加強與世界各地的品牌商及供應商的合作，為消費者提供更豐富的選擇。同時，我們將致力於智能化技術的應用，利用大數據分析、人工智慧和物聯網等前沿技術，提升用戶體驗，優化物流配送效率，並實現個性化推薦和精準行銷。 我們也將積極推動環保和可持續發展，通過綠色物流、減少包裝浪費等措施，承擔企業社會責任，為地球的未來做出貢獻。 展望未來，ECSHOP 將不斷創新，推動整個行業的數位化轉型，並且努力實現「消費者、合作夥伴與企業共贏」的目標。我們期待與您攜手，共創電商新時代的輝煌！</div></div>',4))}var n={name:"AboutUsPage"},l=a(1241);const c=(0,l.A)(n,[["render",o],["__scopeId","data-v-b5050256"]]);var d=c,u=a(4232),p=a(5130);const m={class:"cart-container container mt-5"},h={key:0,class:"text-center"},g={class:"table table-hover"},k=["src"],f=["onUpdate:modelValue","onInput"],b=["onClick"],v={class:"d-flex justify-content-between align-items-center mt-4"},L=["disabled"];function y(e,t,a,s,r,o){const n=(0,i.g2)("router-link");return(0,i.uX)(),(0,i.CE)("div",m,[t[5]||(t[5]=(0,i.Lk)("h2",{class:"text-center mb-4"},"我的購物車",-1)),0===s.cartItems.length?((0,i.uX)(),(0,i.CE)("div",h,[t[3]||(t[3]=(0,i.Lk)("p",null,"購物車是空的。",-1)),(0,i.bF)(n,{to:"/",class:"btn btn-primary"},{default:(0,i.k6)((()=>t[2]||(t[2]=[(0,i.eW)("去購物")]))),_:1})])):((0,i.uX)(),(0,i.CE)(i.FK,{key:1},[(0,i.Lk)("table",g,[t[4]||(t[4]=(0,i.Lk)("thead",null,[(0,i.Lk)("tr",null,[(0,i.Lk)("th",{scope:"col"},"商品圖片"),(0,i.Lk)("th",{scope:"col"},"商品名稱"),(0,i.Lk)("th",{scope:"col"},"單價"),(0,i.Lk)("th",{scope:"col"},"數量"),(0,i.Lk)("th",{scope:"col"},"小計"),(0,i.Lk)("th",{scope:"col"},"操作")])],-1)),(0,i.Lk)("tbody",null,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(s.cartItems,((e,a)=>((0,i.uX)(),(0,i.CE)("tr",{key:`${e.id}-${a}`},[(0,i.Lk)("td",null,[(0,i.Lk)("img",{src:e.image,alt:"item.name",class:"product-image",onError:t[0]||(t[0]=(...e)=>s.imageError&&s.imageError(...e))},null,40,k)]),(0,i.Lk)("td",null,(0,u.v_)(e.name),1),(0,i.Lk)("td",null,(0,u.v_)(e.price)+"元",1),(0,i.Lk)("td",null,[(0,i.bo)((0,i.Lk)("input",{type:"number",class:"form-control quantity-input","onUpdate:modelValue":t=>e.quantity=t,onInput:t=>s.updateQuantity(a,e.quantity),min:"1"},null,40,f),[[p.Jo,e.quantity,void 0,{number:!0}]])]),(0,i.Lk)("td",null,(0,u.v_)(e.quantity*e.price)+"元",1),(0,i.Lk)("td",null,[(0,i.Lk)("button",{class:"btn btn-danger",onClick:e=>s.removeItem(a)},"刪除",8,b)])])))),128))])]),(0,i.Lk)("div",v,[(0,i.Lk)("h4",null,"總計："+(0,u.v_)(s.cartTotal)+"元",1),(0,i.Lk)("button",{class:"btn btn-success",disabled:0===s.cartItems.length,onClick:t[1]||(t[1]=(...e)=>s.checkout&&s.checkout(...e))},"結帳",8,L)])],64))])}a(4114),a(1454);var w=a(782),C=a(4300),I={name:"ShopCart",setup(){const e=(0,w.Pj)(),t=(0,r.rd)(),a=(0,i.EW)((()=>e.state.cart.items)),s=(0,i.EW)((()=>e.getters["cart/cartTotal"])),o=(0,i.EW)((()=>e.state.auth&&e.state.auth.isLoggedIn)),n=(t,a)=>{(!Number.isInteger(a)||a<1)&&(a=1),e.dispatch("cart/updateItemQuantity",{index:t,quantity:a})},l=e=>{e.target.src="/img/wrong.png"},c=t=>{e.dispatch("cart/removeItemFromCart",t)},d=async()=>{if(!o.value)return e.dispatch("notifications/showNotification",{type:"warning",message:"請先登入！",timeout:2e3}),void t.push({name:"UserLogin",query:{redirect:"/cart"}});const r=localStorage.getItem("authToken");if(!r)return e.dispatch("notifications/showNotification",{type:"error",message:"登入狀態已過期，請重新登入！",timeout:2e3}),void t.push({name:"UserLogin",query:{redirect:"/cart"}});if(0===a.value.length)return void e.dispatch("notifications/showNotification",{type:"warning",message:"購物車是空的，無法結帳！",timeout:2e3});const i={user_id:e.state.auth.user.id,items:a.value.map((e=>({product_id:e.id,quantity:e.quantity,price:e.price}))),total:s.value};try{const a=await C.A.orderAPI.createOrder(i);if(a.orderId){if(e.dispatch("cart/clearShoppingCart"),e.dispatch("notifications/showNotification",{type:"success",message:"訂單已成功提交！",timeout:2e3}),window.WebSocket&&window.dashboardSocket)try{window.dashboardSocket.send(JSON.stringify({type:"newOrder",orderId:a.orderId,total:s.value,created_at:(new Date).toISOString()}))}catch(n){}t.push({name:"OrderConfirmation",params:{orderId:a.orderId}})}}catch(n){n.response&&403===n.response.status?(e.dispatch("notifications/showNotification",{type:"error",message:"權限不足或登入已過期，請重新登入！",timeout:2e3}),t.push({name:"UserLogin",query:{redirect:"/cart"}})):e.dispatch("notifications/showNotification",{type:"error",message:"提交訂單失敗，請稍後再試！",timeout:2e3})}};return{cartItems:a,cartTotal:s,updateQuantity:n,removeItem:c,checkout:d,imageError:l}}};const P=(0,l.A)(I,[["render",y],["__scopeId","data-v-fc09e874"]]);var A=P;const _={class:"container"},E={class:"mainArea text-center"},F={class:"filter-container"},x={class:"col-lg-10 mx-auto"},S={class:"tag-container"},O=["onClick"],U={class:"search-bar mb-4"},R={class:"filter-section mb-4"},D={class:"price-filter"},T=["max"],$={class:"price-value"},M={key:0,class:"no-products"},N={class:"product-container mt-4"},X={class:"product-grid"};function q(e,t,a,s,r,o){const n=(0,i.g2)("ProductCard");return(0,i.uX)(),(0,i.CE)(i.FK,null,[(0,i.Lk)("div",_,[(0,i.Lk)("div",E,[t[4]||(t[4]=(0,i.Lk)("h2",{class:"mb-4 section-title"},"商品列表",-1)),t[5]||(t[5]=(0,i.Lk)("h4",{class:"filter-title"},"篩選條件",-1)),(0,i.Lk)("div",F,[(0,i.Lk)("div",x,[t[2]||(t[2]=(0,i.Lk)("h4",{class:"filter-title"},"選擇標籤",-1)),(0,i.Lk)("div",S,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(s.availableTags,(e=>((0,i.uX)(),(0,i.CE)("button",{key:e,onClick:t=>s.toggleTag(e),class:(0,u.C4)([{btn:!0,"btn-primary":s.selectedTags.includes(e),"btn-outline-primary":!s.selectedTags.includes(e)},"tag-btn"])},(0,u.v_)(e),11,O)))),128))])]),(0,i.Lk)("div",U,[(0,i.bo)((0,i.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>s.searchQuery=e),class:"form-control",placeholder:"請輸入你想搜尋的關鍵字"},null,512),[[p.Jo,s.searchQuery]])]),(0,i.Lk)("div",R,[(0,i.Lk)("div",D,[t[3]||(t[3]=(0,i.Lk)("label",{class:"price-label"},"價格區間",-1)),(0,i.bo)((0,i.Lk)("input",{type:"range","onUpdate:modelValue":t[1]||(t[1]=e=>s.priceRange=e),min:"0",max:s.maxPrice,step:"500",class:"price-slider form-range"},null,8,T),[[p.Jo,s.priceRange]]),(0,i.Lk)("p",$,"現在最高價格："+(0,u.v_)(s.priceRange)+"元",1)])])])])]),0===s.filteredProducts.length?((0,i.uX)(),(0,i.CE)("div",M,t[6]||(t[6]=[(0,i.Lk)("p",{style:{"text-align":"center","font-size":"2rem",color:"red"}},"暫無符合條件的商品，請修改查詢條件！",-1)]))):(0,i.Q3)("",!0),(0,i.Lk)("div",N,[(0,i.Lk)("div",X,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(s.filteredProducts,(e=>((0,i.uX)(),(0,i.CE)("div",{class:"product-card-wrapper",key:e.id},[(0,i.bF)(n,{product:e,onAddToCart:s.addToCart},null,8,["product","onAddToCart"])])))),128))])])],64)}a(7642),a(8004),a(3853),a(5876),a(2475),a(5024),a(1698),a(8992),a(4520),a(3949),a(7550);var W=a(144);const V={class:"product-card"},B=["src"],K=["title"],J={class:"card-text"},Q=["disabled"];function j(e,t,a,s,r,o){const n=(0,i.g2)("router-link");return(0,i.uX)(),(0,i.CE)("div",V,[(0,i.bF)(n,{to:{name:"ProductDetail",params:{id:s.productId}}},{default:(0,i.k6)((()=>[(0,i.Lk)("img",{src:s.productImageUrl,class:"product-image",alt:"Product Image",onError:t[0]||(t[0]=(...e)=>s.imageError&&s.imageError(...e))},null,40,B),(0,i.Lk)("h3",{class:"product-name",title:a.product.name},(0,u.v_)(a.product.name),9,K),(0,i.Lk)("p",J,(0,u.v_)(s.formattedPrice)+" 元",1)])),_:1},8,["to"]),(0,i.Lk)("button",{class:"btn btn-primary",onClick:t[1]||(t[1]=(...e)=>s.handleAddToCart&&s.handleAddToCart(...e)),disabled:s.isAdding},(0,u.v_)(s.isAdding?"添加中...":"加入購物車"),9,Q)])}var z=a(5019),H={name:"ProductCard",props:{product:{type:Object,required:!0,validator:function(e){const t=["id","name","price","image"],a=t.every((t=>t in e));return!!a&&("string"===typeof e.id||"number"===typeof e.id&&"string"===typeof e.name&&""!==e.name.trim()&&"number"===typeof e.price&&e.price>=0&&"string"===typeof e.image&&""!==e.image.trim())}}},setup(e,{emit:t}){const a=(0,W.KR)(!1),s=(0,W.KR)(!1),r=(0,i.EW)((()=>String(e.product.id).trim())),o=(0,i.EW)((()=>(0,z.V)(e.product.image,"product"))),n=(0,i.EW)((()=>{const t=parseFloat(e.product.price);return isNaN(t)?"0 元":new Intl.NumberFormat("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0,maximumFractionDigits:0}).format(t)})),l=()=>{a.value||(a.value=!0,t("add-to-cart",e.product),setTimeout((()=>{a.value=!1}),1e3))},c=e=>{s.value||(s.value=!0,e.target.src=(0,z.V)("","icon"))};return{isAdding:a,productId:r,productImageUrl:o,formattedPrice:n,handleAddToCart:l,imageError:c}}};const G=(0,l.A)(H,[["render",j],["__scopeId","data-v-7d48f48e"]]);var Z=G,Y={name:"ProductsList",components:{ProductCard:Z},setup(){const e=(0,W.KR)([]),t=(0,W.KR)(!1),a=(0,W.KR)(null),s=(0,i.EW)((()=>{if(!Array.isArray(e.value))return 1e6;const t=e.value.map((e=>Number(e.price)));return t.length?Math.max(...t):1e6})),o=(0,W.KR)(s.value),n=(0,W.KR)([]),l=(0,W.KR)([]),c=(0,w.Pj)(),d=(0,r.rd)(),u=(0,r.lq)(),p=(0,i.EW)((()=>c.state.auth.isLoggedIn)),m=(0,W.KR)(""),h=(0,i.EW)((()=>Array.isArray(e.value)?e.value.filter((e=>{const t=Number(e.price),a=e.name.toLowerCase().includes(m.value.toLowerCase()),s=t<=o.value,r=e.tags||[],i=0===l.value.length||l.value.some((e=>r.includes(e)));return a&&s&&i})):[])),g=async()=>{t.value=!0,a.value=null;try{const t=await C.A.productAPI.getAllProducts();Array.isArray(t)?e.value=t.map((e=>({...e,id:String(e.id).trim(),price:Number(e.price),tags:Array.isArray(e.tags)?e.tags:[],image:(0,z.V)(e.image,"product")}))):e.value=[],o.value=s.value;const a=new Set;e.value.forEach((e=>{e.tags&&Array.isArray(e.tags)&&e.tags.forEach((e=>a.add(e)))})),n.value=Array.from(a)}catch(r){a.value="加載產品時出錯，請稍後再試！"}finally{t.value=!1}},k=e=>{l.value.includes(e)?l.value=l.value.filter((t=>t!==e)):l.value.push(e)},f=e=>{if(p.value)c.dispatch("cart/addProductToCart",e),c.dispatch("notifications/showNotification",{type:"success",message:`已將 ${e.name} 加入購物車`,timeout:2e3});else{c.dispatch("notifications/showNotification",{type:"warning",message:"請先登入會員再加入購物車！",timeout:2e3});const e=u.fullPath;d.push({name:"UserLogin",query:{redirect:e}})}};return(0,i.sV)((()=>{m.value=u.query.search||"",g().then((()=>{}))})),(0,i.wB)((()=>u.query.search),(e=>{m.value=e||""})),{products:e,maxPrice:s,priceRange:o,loading:t,error:a,isLoggedIn:p,filteredProducts:h,availableTags:n,selectedTags:l,searchQuery:m,toggleTag:k,addToCart:f,priceRange:o}}};const ee=(0,l.A)(Y,[["render",q],["__scopeId","data-v-a9845284"]]);var te=ee;const ae={class:"product-detail-page"},se={class:"container py-5"},re={"aria-label":"breadcrumb",class:"mb-4"},ie={class:"breadcrumb"},oe={class:"breadcrumb-item active","aria-current":"page"},ne={key:0,class:"product-detail"},le={class:"row g-4"},ce={class:"col-lg-6"},de={class:"sticky-top",style:{top:"2rem"}},ue={class:"image-container"},pe=["src","alt"],me={class:"thumbnail-container mt-3 d-flex gap-2"},he=["src","alt"],ge={class:"col-lg-6"},ke={class:"product-info-container"},fe={class:"product-header mb-4"},be={class:"product-name text-break mb-3"},ve={class:"product-meta d-flex align-items-center gap-3 mb-3"},Le={class:"product-sku text-muted"},ye={class:"product-price mb-0"},we={class:"product-description-section mb-4"},Ce={class:"product-description text-break"},Ie={class:"purchase-section"},Pe={class:"quantity-selector mb-4"},Ae={class:"input-group",style:{width:"150px"}},_e={class:"action-buttons d-grid gap-3"},Ee={class:"d-flex gap-2"},Fe={key:1,class:"loading"};function xe(e,t,a,s,r,o){return(0,i.uX)(),(0,i.CE)("div",ae,[(0,i.Lk)("div",se,[(0,i.Lk)("nav",re,[(0,i.Lk)("ol",ie,[t[7]||(t[7]=(0,i.Lk)("li",{class:"breadcrumb-item"},[(0,i.Lk)("a",{href:"/",class:"text-decoration-none"},"首頁")],-1)),t[8]||(t[8]=(0,i.Lk)("li",{class:"breadcrumb-item"},[(0,i.Lk)("a",{href:"/products",class:"text-decoration-none"},"商品列表")],-1)),(0,i.Lk)("li",oe,(0,u.v_)(s.product?.name||"商品詳情"),1)])]),s.product&&s.product.id?((0,i.uX)(),(0,i.CE)("div",ne,[(0,i.Lk)("div",le,[(0,i.Lk)("div",ce,[(0,i.Lk)("div",de,[(0,i.Lk)("div",ue,[(0,i.Lk)("img",{src:e.$getImageUrl(s.product.image,"product"),alt:s.product.name,class:"product-image",onError:t[0]||(t[0]=(...e)=>s.handleImageError&&s.handleImageError(...e))},null,40,pe)]),(0,i.Lk)("div",me,[((0,i.uX)(),(0,i.CE)(i.FK,null,(0,i.pI)(4,(a=>(0,i.Lk)("div",{key:a,class:"thumbnail-item"},[(0,i.Lk)("img",{src:e.$getImageUrl(s.product.image,"product"),alt:`${s.product.name} - 預覽圖 ${a}`,class:"thumbnail",onError:t[1]||(t[1]=(...e)=>s.handleImageError&&s.handleImageError(...e))},null,40,he)]))),64))])])]),(0,i.Lk)("div",ge,[(0,i.Lk)("div",ke,[(0,i.Lk)("div",fe,[(0,i.Lk)("h2",be,(0,u.v_)(s.product.name),1),(0,i.Lk)("div",ve,[(0,i.Lk)("span",Le,"商品編號: #"+(0,u.v_)(s.product.id),1),t[9]||(t[9]=(0,i.Lk)("span",{class:"product-category text-muted"},"分類: 一般商品",-1))]),(0,i.Lk)("h3",ye,"NT$ "+(0,u.v_)(s.product.price),1)]),(0,i.Lk)("div",we,[t[10]||(t[10]=(0,i.Lk)("h4",{class:"section-title mb-3"},"商品描述",-1)),(0,i.Lk)("p",Ce,(0,u.v_)(s.product.description),1)]),(0,i.Lk)("div",Ie,[(0,i.Lk)("div",Pe,[t[11]||(t[11]=(0,i.Lk)("label",{class:"form-label"},"數量",-1)),(0,i.Lk)("div",Ae,[(0,i.Lk)("button",{class:"btn btn-outline-secondary",onClick:t[2]||(t[2]=(...e)=>s.decreaseQuantity&&s.decreaseQuantity(...e))},"-"),(0,i.bo)((0,i.Lk)("input",{type:"number",class:"form-control text-center","onUpdate:modelValue":t[3]||(t[3]=e=>s.quantity=e),min:"1"},null,512),[[p.Jo,s.quantity]]),(0,i.Lk)("button",{class:"btn btn-outline-secondary",onClick:t[4]||(t[4]=(...e)=>s.increaseQuantity&&s.increaseQuantity(...e))},"+")])]),(0,i.Lk)("div",_e,[(0,i.Lk)("button",{class:"btn btn-primary btn-lg",onClick:t[5]||(t[5]=(...e)=>s.addToCart&&s.addToCart(...e))},t[12]||(t[12]=[(0,i.Lk)("i",{class:"fas fa-shopping-cart me-2"},null,-1),(0,i.eW)("加入購物車 ")])),(0,i.Lk)("div",Ee,[(0,i.Lk)("button",{class:"btn btn-outline-secondary btn-lg flex-grow-1",onClick:t[6]||(t[6]=(...e)=>s.goBack&&s.goBack(...e))},t[13]||(t[13]=[(0,i.Lk)("i",{class:"fas fa-arrow-left me-2"},null,-1),(0,i.eW)("返回商品列表 ")]))])])])])])])])):((0,i.uX)(),(0,i.CE)("div",Fe,t[14]||(t[14]=[(0,i.Lk)("div",{class:"spinner-border text-primary",role:"status"},[(0,i.Lk)("span",{class:"visually-hidden"},"正在加載...")],-1),(0,i.Lk)("p",null,"正在加載商品中...",-1)])))])])}var Se={name:"ProductDetail",setup(){const e=(0,w.Pj)(),t=(0,r.lq)(),a=(0,r.rd)(),s=(0,W.KR)(!1),o=(0,W.KR)(null),n=(0,i.EW)((()=>t.params.id)),l=(0,i.EW)((()=>o.value&&o.value.image?o.value.image:"/img/wrong.png")),c=(0,i.EW)((()=>e.state.auth.isLoggedIn)),d=async()=>{if(!m(n.value))return notificationTypes("error","商品格式不正確，無法加載商品詳情"),void a.go(-1);try{const e=await C.A.productAPI.getProductById(n.value);o.value={...e,image:(0,z.V)(e.image,"product")}}catch(e){notifiy("error","加載商品詳情失敗，請稍後再試！")}},u=e=>{s.value||(s.value=!0,e.target.src=(0,z.V)("","icon"))},p=()=>{c.value?(e.dispatch("cart/addProductToCart",o.value),h("success",`已將${o.value.name}加入購物車`)):g()},m=e=>/^[1-9]\d*$/.test(e),h=(t,a)=>{e.dispatch("notifications/showNotification",{type:t,message:a})},g=()=>{a.push({name:"UserLogin",query:{redirect:t.fullPath}})},k=()=>a.go(-1),f=(0,W.KR)(1),b=()=>{f.value++},v=()=>{f.value>1&&f.value--};return(0,i.sV)(d),{addToCart:p,goBack:k,product:o,productId:n,productImageUrl:l,handleImageError:u,quantity:f,increaseQuantity:b,decreaseQuantity:v,getImageUrl:z.V}}};const Oe=(0,l.A)(Se,[["render",xe],["__scopeId","data-v-a7902448"]]);var Ue=Oe;const Re={class:"member-page"},De={class:"container py-4"},Te={class:"member-profile mb-4"},$e={class:"profile-header d-flex align-items-center"},Me={class:"avatar-circle me-3 position-relative"},Ne={class:"initials"},Xe={class:"profile-info"},qe={class:"member-data"},We={class:"button-group"},Ve={class:"content-tabs mb-4 main-content"},Be={class:"tab-content"},Ke={class:"tab-pane fade show active",id:"profile"},Je={class:"content-card"},Qe={class:"card-body"},je={class:"content-grid"},ze={class:"content-section"},He={class:"info-block"},Ge={class:"info-content"},Ze={class:"mb-0"},Ye={class:"info-block"},et={class:"info-content"},tt={class:"mb-0"},at={class:"content-section"},st={class:"info-block"},rt={class:"info-content"},it={class:"mb-0"},ot={class:"info-block"},nt={class:"info-content"},lt={class:"mb-0"},ct={class:"modal fade",ref:"editModal",tabindex:"-1","aria-labelledby":"editModalLabel","aria-hidden":"true"},dt={class:"modal-dialog"},ut={class:"modal-content"},pt={class:"modal-body"},mt={class:"mb-3"},ht={class:"mb-3"},gt={class:"mb-3"},kt={class:"mb-3"},ft={class:"tab-pane fade",id:"addresses"},bt={class:"content-card"},vt={class:"card-body"},Lt={class:"d-flex justify-content-end mb-3"},yt={class:"address-list"},wt={class:"address-content"},Ct={class:"mb-2"},It={class:"mb-1"},Pt={class:"mb-0"},At={class:"address-actions"},_t=["onClick"],Et=["onClick"],Ft={class:"modal fade",ref:"recipientModal",tabindex:"-1"},xt={class:"modal-dialog"},St={class:"modal-content"},Ot={class:"modal-header"},Ut={class:"modal-title"},Rt={class:"modal-body"},Dt={class:"mb-3"},Tt={class:"mb-3"},$t={class:"mb-3"},Mt={type:"submit",class:"btn btn-primary"},Nt={class:"tab-pane fade",id:"orders"},Xt={class:"content-card"},qt={class:"card-body"},Wt={class:"order-list"},Vt=["onClick"],Bt={class:"order-id"},Kt={class:"order-date"},Jt={class:"order-amount"},Qt={key:0,class:"order-details"},jt=["src","alt"],zt={class:"product-info"},Ht={class:"mb-0"},Gt={class:"product-total"};function Zt(e,t,a,s,r,o){return(0,i.uX)(),(0,i.CE)("div",Re,[(0,i.Lk)("div",De,[(0,i.Lk)("div",Te,[(0,i.Lk)("div",$e,[(0,i.Lk)("div",Me,[(0,i.Lk)("span",Ne,(0,u.v_)(o.getUserInitials),1)]),(0,i.Lk)("div",Xe,[(0,i.Lk)("p",qe,"會員帳號 ： "+(0,u.v_)(r.userInfo.email),1),(0,i.Lk)("div",We,[(0,i.Lk)("button",{class:"btn btn-secondary me-2",onClick:t[0]||(t[0]=(...e)=>o.openEditModal&&o.openEditModal(...e))},t[12]||(t[12]=[(0,i.Lk)("i",{class:"fas fa-edit me-2"},null,-1),(0,i.eW)(" 編輯個人資料 ")])),(0,i.Lk)("div",null,[(0,i.Lk)("button",{class:"btn btn-outline-danger",onClick:t[1]||(t[1]=(...e)=>o.handleLogout&&o.handleLogout(...e))},t[13]||(t[13]=[(0,i.Lk)("i",{class:"fas fa-sign-out-alt me-2"},null,-1),(0,i.eW)("登出 ")]))])])])])]),(0,i.Lk)("div",Ve,[t[38]||(t[38]=(0,i.Lk)("ul",{class:"nav nav-pills mb-3",role:"tablist"},[(0,i.Lk)("li",{class:"nav-item",role:"presentation"},[(0,i.Lk)("button",{class:"nav-link active","data-bs-toggle":"pill","data-bs-target":"#profile"},[(0,i.Lk)("i",{class:"fas fa-user me-2"}),(0,i.eW)("個人資料 ")])]),(0,i.Lk)("li",{class:"nav-item",role:"presentation"},[(0,i.Lk)("button",{class:"nav-link","data-bs-toggle":"pill","data-bs-target":"#addresses"},[(0,i.Lk)("i",{class:"fas fa-map-marker-alt me-2"}),(0,i.eW)("收件地址 ")])]),(0,i.Lk)("li",{class:"nav-item",role:"presentation"},[(0,i.Lk)("button",{class:"nav-link","data-bs-toggle":"pill","data-bs-target":"#orders"},[(0,i.Lk)("i",{class:"fas fa-shopping-bag me-2"}),(0,i.eW)("訂單記錄 ")])])],-1)),(0,i.Lk)("div",Be,[(0,i.Lk)("div",Ke,[(0,i.Lk)("div",Je,[(0,i.Lk)("div",Qe,[(0,i.Lk)("div",je,[(0,i.Lk)("div",ze,[(0,i.Lk)("div",He,[t[15]||(t[15]=(0,i.Lk)("div",{class:"info-icon bg-primary-soft"},[(0,i.Lk)("i",{class:"fas fa-user text-primary"})],-1)),(0,i.Lk)("div",Ge,[t[14]||(t[14]=(0,i.Lk)("label",null,"會員姓名:",-1)),(0,i.Lk)("p",Ze,(0,u.v_)(r.userInfo.name),1)])]),(0,i.Lk)("div",Ye,[t[17]||(t[17]=(0,i.Lk)("div",{class:"info-icon bg-success-soft"},[(0,i.Lk)("i",{class:"fas fa-phone text-success"})],-1)),(0,i.Lk)("div",et,[t[16]||(t[16]=(0,i.Lk)("label",null,"聯絡電話:",-1)),(0,i.Lk)("p",tt,(0,u.v_)(r.userInfo.phone),1)])])]),t[22]||(t[22]=(0,i.Lk)("div",{class:"content-divider"},[(0,i.Lk)("div",{class:"vertical-divider"})],-1)),(0,i.Lk)("div",at,[(0,i.Lk)("div",st,[t[19]||(t[19]=(0,i.Lk)("div",{class:"info-icon bg-primary-soft"},[(0,i.Lk)("i",{class:"fas fa-envelope text-purple"})],-1)),(0,i.Lk)("div",rt,[t[18]||(t[18]=(0,i.Lk)("label",null,"電子信箱:",-1)),(0,i.Lk)("p",it,(0,u.v_)(r.userInfo.email),1)])]),(0,i.Lk)("div",ot,[t[21]||(t[21]=(0,i.Lk)("div",{class:"info-icon bg-warning-soft"},[(0,i.Lk)("i",{class:"fas fa-map-marker-alt text-warning"})],-1)),(0,i.Lk)("div",nt,[t[20]||(t[20]=(0,i.Lk)("label",null,"聯絡地址:",-1)),(0,i.Lk)("p",lt,(0,u.v_)(r.userInfo.address),1)])])])])])])]),(0,i.Lk)("div",ct,[(0,i.Lk)("div",dt,[(0,i.Lk)("div",ut,[t[28]||(t[28]=(0,i.Lk)("div",{class:"modal-header"},[(0,i.Lk)("h5",{class:"modal-title"},"編輯會員資料"),(0,i.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),(0,i.Lk)("div",pt,[(0,i.Lk)("form",{onSubmit:t[6]||(t[6]=(0,p.D$)(((...e)=>o.saveUserInfo&&o.saveUserInfo(...e)),["prevent"]))},[(0,i.Lk)("div",mt,[t[23]||(t[23]=(0,i.Lk)("label",{for:"name"},"姓名",-1)),(0,i.bo)((0,i.Lk)("input",{type:"text",class:"form-control",id:"name","onUpdate:modelValue":t[2]||(t[2]=e=>r.editUserInfo.name=e)},null,512),[[p.Jo,r.editUserInfo.name]])]),(0,i.Lk)("div",ht,[t[24]||(t[24]=(0,i.Lk)("label",{for:"userEmail",class:"form-label"},"電子郵件",-1)),(0,i.bo)((0,i.Lk)("input",{type:"email",id:"userEmail","onUpdate:modelValue":t[3]||(t[3]=e=>r.editUserInfo.email=e),class:"form-control",required:""},null,512),[[p.Jo,r.editUserInfo.email]])]),(0,i.Lk)("div",gt,[t[25]||(t[25]=(0,i.Lk)("label",{for:"userPhone",class:"form-label"},"聯絡電話",-1)),(0,i.bo)((0,i.Lk)("input",{type:"text",id:"userPhone","onUpdate:modelValue":t[4]||(t[4]=e=>r.editUserInfo.phone=e),class:"form-control",required:""},null,512),[[p.Jo,r.editUserInfo.phone]])]),(0,i.Lk)("div",kt,[t[26]||(t[26]=(0,i.Lk)("label",{for:"userAddress",class:"form-label"},"聯絡地址",-1)),(0,i.bo)((0,i.Lk)("input",{type:"text",id:"userAddress","onUpdate:modelValue":t[5]||(t[5]=e=>r.editUserInfo.address=e),class:"form-control",required:""},null,512),[[p.Jo,r.editUserInfo.address]])]),t[27]||(t[27]=(0,i.Lk)("button",{type:"submit",class:"btn btn-primary"},"保存變更",-1))],32)])])])],512),(0,i.Lk)("div",ft,[(0,i.Lk)("div",bt,[(0,i.Lk)("div",vt,[(0,i.Lk)("div",Lt,[(0,i.Lk)("button",{class:"btn btn-primary",onClick:t[7]||(t[7]=(...e)=>o.addRecipient&&o.addRecipient(...e))},t[29]||(t[29]=[(0,i.Lk)("i",{class:"fas fa-plus me-2"},null,-1),(0,i.eW)("新增地址 ")]))]),(0,i.Lk)("div",yt,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(r.recipients,((e,a)=>((0,i.uX)(),(0,i.CE)("div",{key:e.id||a,class:"address-item mb-3 p-3 rounded"},[(0,i.Lk)("div",wt,[(0,i.Lk)("h6",Ct,"收件人姓名 ： "+(0,u.v_)(e.name),1),(0,i.Lk)("p",It,[t[30]||(t[30]=(0,i.Lk)("i",{class:"fas fa-phone me-2 text-muted"},null,-1)),(0,i.eW)(" 聯絡電話 ： "+(0,u.v_)(e.phone),1)]),(0,i.Lk)("p",Pt,[t[31]||(t[31]=(0,i.Lk)("i",{class:"fas fa-map-marker-alt me-2 text-muted"},null,-1)),(0,i.eW)(" 收件地址 ： "+(0,u.v_)(e.address),1)])]),(0,i.Lk)("div",At,[(0,i.Lk)("button",{class:"btn btn-link",onClick:e=>o.editRecipientInfo(a)},t[32]||(t[32]=[(0,i.Lk)("i",{class:"fas fa-edit"},null,-1)]),8,_t),(0,i.Lk)("button",{class:"btn btn-link text-danger",onClick:e=>o.deleteRecipient(a)},t[33]||(t[33]=[(0,i.Lk)("i",{class:"fas fa-trash"},null,-1)]),8,Et)])])))),128))])])])]),(0,i.Lk)("div",Ft,[(0,i.Lk)("div",xt,[(0,i.Lk)("div",St,[(0,i.Lk)("div",Ot,[(0,i.Lk)("h5",Ut,(0,u.v_)(r.isEditing?"編輯收件地址":"新增收件地址"),1),t[34]||(t[34]=(0,i.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"},null,-1))]),(0,i.Lk)("div",Rt,[(0,i.Lk)("form",{onSubmit:t[11]||(t[11]=(0,p.D$)(((...e)=>o.saveRecipient&&o.saveRecipient(...e)),["prevent"]))},[(0,i.Lk)("div",Dt,[t[35]||(t[35]=(0,i.Lk)("label",{class:"form-label"},"收件人姓名",-1)),(0,i.bo)((0,i.Lk)("input",{type:"text",class:"form-control","onUpdate:modelValue":t[8]||(t[8]=e=>r.editRecipient.name=e),required:""},null,512),[[p.Jo,r.editRecipient.name]])]),(0,i.Lk)("div",Tt,[t[36]||(t[36]=(0,i.Lk)("label",{class:"form-label"},"聯絡電話",-1)),(0,i.bo)((0,i.Lk)("input",{type:"tel",class:"form-control","onUpdate:modelValue":t[9]||(t[9]=e=>r.editRecipient.phone=e),required:""},null,512),[[p.Jo,r.editRecipient.phone]])]),(0,i.Lk)("div",$t,[t[37]||(t[37]=(0,i.Lk)("label",{class:"form-label"},"收件地址",-1)),(0,i.bo)((0,i.Lk)("input",{type:"text",class:"form-control","onUpdate:modelValue":t[10]||(t[10]=e=>r.editRecipient.address=e),required:""},null,512),[[p.Jo,r.editRecipient.address]])]),(0,i.Lk)("button",Mt,(0,u.v_)(r.isEditing?"更新地址":"新增地址"),1)],32)])])])],512),(0,i.Lk)("div",Nt,[(0,i.Lk)("div",Xt,[(0,i.Lk)("div",qt,[(0,i.Lk)("div",Wt,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(r.orders,((t,a)=>((0,i.uX)(),(0,i.CE)("div",{key:t.id,class:"order-item"},[(0,i.Lk)("div",{class:"order-header",onClick:e=>o.toggleOrderDetails(a)},[(0,i.Lk)("div",null,[(0,i.Lk)("span",Bt,"#"+(0,u.v_)(t.id),1),(0,i.Lk)("span",Kt,(0,u.v_)(e.formateOrderDate(t.created_at)),1)]),(0,i.Lk)("div",null,[(0,i.Lk)("span",Jt,"NT$ "+(0,u.v_)(Math.round(t.total).toLocaleString()),1),(0,i.Lk)("i",{class:(0,u.C4)(["fas",r.expandedOrder===a?"fa-chevron-up":"fa-chevron-down","ms-2"])},null,2)])],8,Vt),r.expandedOrder===a?((0,i.uX)(),(0,i.CE)("div",Qt,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(t.items,(e=>((0,i.uX)(),(0,i.CE)("div",{key:e.id,class:"order-product"},[(0,i.Lk)("img",{src:e.product_image?`/img/products/${e.product_image}`:"/img/welcome.jpg",alt:e.name,class:"product-img"},null,8,jt),(0,i.Lk)("div",zt,[(0,i.Lk)("h6",null,(0,u.v_)(e.name),1),(0,i.Lk)("p",Ht," 數量："+(0,u.v_)(e.quantity)+" × NT$ "+(0,u.v_)(e.price),1)]),(0,i.Lk)("div",Gt," NT$ "+(0,u.v_)((e.quantity*e.price).toLocaleString()),1)])))),128))])):(0,i.Q3)("",!0)])))),128))])])])])])])])])}a(3215);var Yt=a(3664);function ea(e,t="操作失敗",a={}){const{showDetailedError:s=!1,customHandler:r=null}=a;if(e.response){const{status:a,data:s}=e.response,i=s?.message||e.message||t;if("function"===typeof r)return r(e);switch(a){case 401:alert("未授權：請重新登入");break;case 404:alert("資源未找到："+i);break;case 500:alert("伺服器錯誤，請稍後再試");break;default:alert(i)}}else e.request?alert("無法連接到伺服器，請檢查網絡"):alert(t)}const{userAPI:ta,recipientAPI:aa}=C.A;var sa={name:"MemberPage",data(){return{showRecipient:!1,expandedOrder:null,isEditing:!1,isLoadingRecipients:!1,recipients:[],editRecipient:{name:" ",phone:" ",address:" "},editingIndex:-1,userInfo:{id:null,name:" ",email:" ",phone:"",address:""},editUserInfo:{name:"",email:"",phone:"",address:""},orders:[]}},computed:{...(0,w.aH)("auth",{isLoggedIn:e=>e.isLoggedIn,user:e=>e.user||{}}),filteredOrders(){return this.orders.map((e=>({...e,formattedDate:this.formatOrderDate(e.created_at)})))},getUserInitials(){return this.userInfo.name?this.userInfo.name.substring(0,2).toUpperCase():"??"}},async mounted(){try{if(!this.isLoggedIn)return alert("請先登入會員！"),void this.$router.push("/UserLogin");const e=this.user.id;e?(this.loadUserInfo(e),this.loadOrders(),this.loadRecipients(e)):(alert("請先登入會員！"),this.$router.push("/UserLogin"))}catch(e){ea(e,"加載用戶信息失敗，請重試。")}},methods:{async loadUserInfo(e){try{const t=await C.A.userAPI.getUserInfo(e);t.success&&(this.userInfo=t.data)}catch(t){ea(t,"加載用戶信息失敗，請重試。")}},async loadOrders(){try{const e=await C.A.orderAPI.getOrders();e.success&&(this.orders=e)}catch(e){}},async loadRecipients(e){if(e)try{this.isLoadingRecipients=!0;const t=await C.A.recipientAPI.getRecipients(e);this.recipients=Array.isArray(t.data)?t.data:[]}catch(t){ea(t,"載入收件人資料失敗"),this.recipients=[]}finally{this.isLoadingRecipients=!1}},isRecipientValid(e){const t=/^[0-9]{10}$/;return e.name.trim()&&t.test(e.phone)&&e.address.trim()},async saveRecipient(){if(this.isRecipientValid(this.editRecipient))try{let e;this.isEditing?(e=await C.A.recipientAPI.updateRecipient(this.editRecipient.id,this.editRecipient),e.success&&(this.recipients[this.editingIndex]=e.data)):(e=await C.A.recipientAPI.addRecipient({...this.editRecipient,user_id:this.user.id}),e.success&&this.recipients.push(e.data)),this.hideModal(),alert(this.isEditing?"收件人資料已更新":"新增收件人成功"),await this.loadRecipients(this.user.id)}catch(e){ea(e,this.isEditing?"更新收件人失敗":"新增收件人失敗")}else alert("請檢查收件人資料是否完整且格式正確！")},async deleteRecipient(e){if(confirm("確定要刪除此收件人資料？"))try{const t=this.recipients[e].id,a=await C.A.recipientAPI.deleteRecipient(t);a.success&&(this.recipients.splice(e,1),alert("收件人資料已刪除"))}catch(t){ea(t,"刪除收件人敗")}},toggleRecipient(){this.showRecipient=!this.showRecipient},addRecipient(){this.isEditing=!1,this.editRecipient={name:"",phone:"",address:""},this.showModal()},editRecipientInfo(e){this.isEditing=!0,this.editingIndex=e,this.editRecipient={...this.recipients[e]},this.showModal()},toggleOrderDetails(e){const t=this.orders[e];if(!t.items||!t.items.length)return void alert("該訂單無法顯示細節！");const a=e=>e.product_name&&e.quantity>0&&e.price>=0;t.items.every(a)?this.expandedOrder=this.expandedOrder===e?null:e:alert("該訂單數據不完整，無法展開！")},showModal(){if(this.$refs.recipientModal){const e=new Yt.aF(this.$refs.recipientModal);e.show()}},hideModal(){const e=Yt.aF.getInstance(this.$refs.recipientModal);e&&e.hide()},...(0,w.i0)("auth",["logout"]),async handleLogout(){await this.logout(),alert("已成功登出!"),this.$router.push("/UserLogin")},formatOrderDate(e){if(!e)return"";const t=new Date(e);return t.toLocaleString("zh-TW",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"})},getOrderStatusClass(e){const t={pending:"badge bg-warning text-dark",processing:"badge bg-info text-white",shipped:"badge bg-primary text-white",completed:"badge bg-success text-white",cancelled:"badge bg-danger text-white"};return t[e]||"badge bg-secondary"},getOrderStatusText(e){const t={pending:"處理中",processing:"處理中",shipped:"已出貨",completed:"已完成",cancelled:"已取消"};return t[e]||"未知狀態"},openEditModal(){this.editUserInfo={...this.userInfo};const e=new Yt.aF(this.$refs.editModal);this.$refs.editModal.removeAttribute("aria-hidden"),e.show()},async saveUserInfo(){try{const e=this.user.id,t=await C.A.userAPI.updateUser(e,this.editUserInfo);t.success&&(this.userInfo=t.data,this.hideEditModal(),alert("個人資料已更新"))}catch(e){ea(e,"更新個人資料失敗"),alert("更新會員資料失敗，請稍後再試。")}},hideEditModal(){const e=Yt.aF.getInstance(this.$refs.editModal);e&&e.hide()}}};const ra=(0,l.A)(sa,[["render",Zt],["__scopeId","data-v-7b915641"]]);var ia=ra;const oa={class:"contact-container contact"},na={class:"contact-form"},la={class:"mb-3"},ca={class:"mb-3"},da={class:"mb-3"},ua={class:"mb-3"};function pa(e,t,a,s,r,o){return(0,i.uX)(),(0,i.CE)(i.FK,null,[t[11]||(t[11]=(0,i.Fv)('<div class="faq-search" data-v-876a9734><input type="text" class="form-control" id="faqSearch" placeholder="搜尋問題..." data-v-876a9734></div><div class="accordion" id="faqAccordion" data-v-876a9734><div class="accordion-item faq-item" data-v-876a9734><h2 class="accordion-header" id="headingOne" data-v-876a9734><button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne" data-v-876a9734> 問題一：如何註冊？ </button></h2><div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne" data-bs-parent="#faqAccordion" data-v-876a9734><div class="accordion-body" data-v-876a9734> 您可以點擊右上角的「註冊」按鈕，並按照提示填寫相關資訊來完成註冊。 </div></div></div><div class="accordion-item faq-item" data-v-876a9734><h2 class="accordion-header" id="headingTwo" data-v-876a9734><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo" data-v-876a9734> 問題二：忘記密碼怎麼辦？ </button></h2><div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#faqAccordion" data-v-876a9734><div class="accordion-body" data-v-876a9734> 您可以點擊「忘記密碼」連結，輸入您的電子郵件，系統將發送密碼重置的指引給您。 </div></div></div></div>',2)),(0,i.Lk)("div",oa,[t[10]||(t[10]=(0,i.Lk)("div",{class:"contact-info"},[(0,i.Lk)("h4",null,"或者透過以下表格聯絡")],-1)),(0,i.Lk)("div",na,[(0,i.Lk)("form",{onSubmit:t[4]||(t[4]=(0,p.D$)(((...e)=>o.submitMessage&&o.submitMessage(...e)),["prevent"]))},[(0,i.Lk)("div",la,[t[5]||(t[5]=(0,i.Lk)("label",{for:"name",class:"form-label"},"姓名",-1)),(0,i.bo)((0,i.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>r.formData.name=e),class:"form-control",id:"name",placeholder:"請輸入您的姓名"},null,512),[[p.Jo,r.formData.name]])]),(0,i.Lk)("div",ca,[t[6]||(t[6]=(0,i.Lk)("label",{for:"phone",class:"form-label"},"聯絡電話",-1)),(0,i.bo)((0,i.Lk)("input",{type:"phone","onUpdate:modelValue":t[1]||(t[1]=e=>r.formData.phone=e),class:"form-control",id:"phone",placeholder:"請輸入您的聯絡電話"},null,512),[[p.Jo,r.formData.phone]])]),(0,i.Lk)("div",da,[t[7]||(t[7]=(0,i.Lk)("label",{for:"email",class:"form-label"},"電子郵件",-1)),(0,i.bo)((0,i.Lk)("input",{type:"email","onUpdate:modelValue":t[2]||(t[2]=e=>r.formData.email=e),class:"form-control",id:"email",placeholder:"請輸入您的電子郵件"},null,512),[[p.Jo,r.formData.email]])]),(0,i.Lk)("div",ua,[t[8]||(t[8]=(0,i.Lk)("label",{for:"message",class:"form-label"},"留言",-1)),(0,i.bo)((0,i.Lk)("textarea",{"onUpdate:modelValue":t[3]||(t[3]=e=>r.formData.message=e),class:"form-control",id:"message",rows:"4",placeholder:"請輸入您的訊息"},null,512),[[p.Jo,r.formData.message]])]),t[9]||(t[9]=(0,i.Lk)("button",{type:"submit",class:"btn btn-primary"},"送出留言",-1))],32)])])],64)}var ma={name:"ContactUs",data(){return{formData:{name:"",phone:"",email:"",message:""}}},mounted(){const e=document.getElementById("faqSearch");e&&e.addEventListener("input",(function(){const t=e.value.toLowerCase();document.querySelectorAll(".faq-item").forEach((function(e){const a=e.querySelector("according-button").innerText.toLowerCase(),s=e.querySelector(".according-body").innerText.toLowerCase();a.includes(t)||s.includes(t)?e.style.display="block":e.style.display="none"}))}))},methods:{async submitMessage(){try{await C.A.messageAPI.createMessage(this.formData),this.$notify.success("訊息已成功送出，我們會盡快回覆您"),setTimeout((()=>{this.$router.push("/")}),2e3)}catch(e){this.$notify.error("訊息送出失敗，請稍後再試")}}}};const ha=(0,l.A)(ma,[["render",pa],["__scopeId","data-v-876a9734"]]);var ga=ha;function ka(e,t,a,s,r,o){return(0,i.uX)(),(0,i.CE)("div",null,[t[0]||(t[0]=(0,i.Lk)("h1",null,"搜尋結果",-1)),(0,i.Lk)("p",null,"搜尋關鍵字："+(0,u.v_)(o.searchQuery),1)])}var fa={name:"SearchResults",computed:{searchQuery(){return this.$route.query.q||"未指定"}}};const ba=(0,l.A)(fa,[["render",ka]]);var va=ba;const La={class:"register-page"},ya={class:"register-container container"},wa={class:"auth-card"},Ca={class:"row g-3"},Ia={class:"col-12"},Pa={class:"form-floating"},Aa={class:"col-12"},_a={class:"form-floating"},Ea={class:"col-12"},Fa={class:"form-floating"},xa={class:"col-12"},Sa={class:"form-floating"},Oa={class:"col-12"},Ua={class:"form-floating password-wrapper"},Ra=["type"],Da={class:"col-12"},Ta={class:"form-floating"},$a={key:0,class:"alert alert-danger mt-3"},Ma={class:"mb-0"},Na={class:"text-center mt-3"},Xa={class:"mb-0"};function qa(e,t,a,s,r,o){const n=(0,i.g2)("router-link");return(0,i.uX)(),(0,i.CE)("div",La,[(0,i.Lk)("div",ya,[(0,i.Lk)("div",wa,[t[17]||(t[17]=(0,i.Lk)("div",{class:"auth-header text-center mb-4"},[(0,i.Lk)("h2",{class:"fw-bold text-primary"},"會員註冊"),(0,i.Lk)("p",{class:"text-muted"},"創建您的帳號，開始購物之旅")],-1)),(0,i.Lk)("form",{onSubmit:t[7]||(t[7]=(0,p.D$)(((...e)=>o.handleRegister&&o.handleRegister(...e)),["prevent"])),class:"auth-form"},[(0,i.Lk)("div",Ca,[(0,i.Lk)("div",Ia,[(0,i.Lk)("div",Pa,[(0,i.bo)((0,i.Lk)("input",{type:"text",class:"form-control",id:"username","onUpdate:modelValue":t[0]||(t[0]=e=>r.username=e),placeholder:"請輸入姓名",required:""},null,512),[[p.Jo,r.username]]),t[8]||(t[8]=(0,i.Lk)("label",{for:"username"},"會員姓名",-1))])]),(0,i.Lk)("div",Aa,[(0,i.Lk)("div",_a,[(0,i.bo)((0,i.Lk)("input",{type:"email",class:"form-control",id:"email","onUpdate:modelValue":t[1]||(t[1]=e=>r.email=e),placeholder:"請輸入電子信箱",required:""},null,512),[[p.Jo,r.email]]),t[9]||(t[9]=(0,i.Lk)("label",{for:"email"},"電子郵件",-1))])]),(0,i.Lk)("div",Ea,[(0,i.Lk)("div",Fa,[(0,i.bo)((0,i.Lk)("input",{type:"tel",class:"form-control",id:"phone","onUpdate:modelValue":t[2]||(t[2]=e=>r.phone=e),placeholder:"請輸入手機號碼",required:""},null,512),[[p.Jo,r.phone]]),t[10]||(t[10]=(0,i.Lk)("label",{for:"phone"},"手機號碼",-1))])]),(0,i.Lk)("div",xa,[(0,i.Lk)("div",Sa,[(0,i.bo)((0,i.Lk)("input",{type:"text",class:"form-control",id:"address","onUpdate:modelValue":t[3]||(t[3]=e=>r.address=e),placeholder:"請輸入收件地址",required:""},null,512),[[p.Jo,r.address]]),t[11]||(t[11]=(0,i.Lk)("label",{for:"address"},"收件地址",-1))])]),(0,i.Lk)("div",Oa,[(0,i.Lk)("div",Ua,[(0,i.bo)((0,i.Lk)("input",{type:r.showPassword?"text":"password",class:"form-control",id:"password","onUpdate:modelValue":t[4]||(t[4]=e=>r.password=e),placeholder:"請設定密碼",required:""},null,8,Ra),[[p.hp,r.password]]),t[12]||(t[12]=(0,i.Lk)("label",{for:"password"},"密碼",-1)),(0,i.Lk)("button",{type:"button",class:"btn btn-link password-toggle",onClick:t[5]||(t[5]=e=>r.showPassword=!r.showPassword)},[(0,i.Lk)("i",{class:(0,u.C4)(r.showPassword?"fas fa-eye-slash":"fas fa-eye")},null,2)])])]),(0,i.Lk)("div",Da,[(0,i.Lk)("div",Ta,[(0,i.bo)((0,i.Lk)("input",{type:"password",class:"form-control",id:"confirmpassword","onUpdate:modelValue":t[6]||(t[6]=e=>r.confirmpassword=e),placeholder:"請再次輸入密碼",required:""},null,512),[[p.Jo,r.confirmpassword]]),t[13]||(t[13]=(0,i.Lk)("label",{for:"confirmpassword"},"確認密碼",-1))])])]),r.formErrors.length?((0,i.uX)(),(0,i.CE)("div",$a,[(0,i.Lk)("ul",Ma,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(r.formErrors,(e=>((0,i.uX)(),(0,i.CE)("li",{key:e},(0,u.v_)(e),1)))),128))])])):(0,i.Q3)("",!0),t[16]||(t[16]=(0,i.Lk)("button",{type:"submit",class:"btn btn-primary w-100 mt-4"},[(0,i.Lk)("i",{class:"fas fa-user-plus me-2"}),(0,i.eW)("註冊 ")],-1)),(0,i.Lk)("div",Na,[(0,i.Lk)("p",Xa,[t[15]||(t[15]=(0,i.eW)("已經有帳號？ ")),(0,i.bF)(n,{to:"/UserLogin",class:"text-primary text-decoration-none"},{default:(0,i.k6)((()=>t[14]||(t[14]=[(0,i.eW)(" 立即登入 ")]))),_:1})])])],32)])])])}var Wa={name:"UserRegister",data(){return{username:"",phone:"",address:"",email:"",password:"",confirmpassword:"",formErrors:[],showPassword:!1}},methods:{async handleRegister(){try{this.formErrors=[];const e=this.validateForm();if(e.length>0)return void(this.formErrors=e);const t=await C.A.userAPI.register({name:this.sanitizeInput(this.username),phone:this.sanitizeInput(this.phone),address:this.sanitizeInput(this.address),email:this.sanitizeInput(this.email.trim().toLowerCase()),password:this.sanitizeInput(this.password),role:"user"});t.success&&(alert("註冊成功"),this.$router.push("/UserLogin"))}catch(e){ea(e,"註冊失敗，請稍後再試")}},validateForm(){const e=[];return this.username.trim()?this.username.length<2&&e.push("會員姓名至少需要2個字元"):e.push("請輸入會員姓名"),this.validatePhoneNumber(this.phone)||e.push("請輸入正確的手機號碼格式（10位數字）"),this.address.trim()?this.address.length<8&&e.push("地址需要更詳細"):e.push("請輸入地址"),this.validateEmail(this.email)||e.push("請輸入正確的電子郵件格式"),this.password?this.password.length<6?e.push("密碼長��需至少為6個字元"):/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{6,}$/.test(this.password)||e.push("密碼需包含至少一個字母和一個數字"):e.push("請設定密碼"),this.password!==this.confirmpassword&&e.push("兩次密碼不相符"),e},validatePhoneNumber(e){const t=/^09\d{8}$/;return t.test(e)},validateEmail(e){const t=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;return t.test(e)},sanitizeInput(e){return"string"!==typeof e?"":e.trim().replace(/<[^>]*>/g,"").replace(/[<>]/g,"")}}};const Va=(0,l.A)(Wa,[["render",qa],["__scopeId","data-v-6cb7400b"]]);var Ba=Va;const Ka={class:"login-page"},Ja={class:"login-container container"},Qa={class:"auth-card"},ja={class:"form-floating mb-3"},za={class:"form-floating mb-3"},Ha=["type"],Ga={class:"d-flex justify-content-between align-items-center mb-4"},Za={class:"text-center"},Ya={class:"mb-0"};function es(e,t,a,s,r,o){const n=(0,i.g2)("router-link");return(0,i.uX)(),(0,i.CE)("div",Ka,[(0,i.Lk)("div",Ja,[(0,i.Lk)("div",Qa,[t[11]||(t[11]=(0,i.Lk)("div",{class:"auth-header text-center mb-4"},[(0,i.Lk)("h2",{class:"fw-bold text-primary"},"會員登入"),(0,i.Lk)("p",{class:"text-muted"},"歡迎回來，請登入您的帳號")],-1)),(0,i.Lk)("form",{onSubmit:t[3]||(t[3]=(0,p.D$)(((...e)=>o.handleLogin&&o.handleLogin(...e)),["prevent"])),class:"auth-form"},[(0,i.Lk)("div",ja,[(0,i.bo)((0,i.Lk)("input",{type:"email",id:"email","onUpdate:modelValue":t[0]||(t[0]=e=>r.email=e),class:"form-control",placeholder:"請輸入電子郵件",required:""},null,512),[[p.Jo,r.email]]),t[4]||(t[4]=(0,i.Lk)("label",{for:"email"},"電子郵件",-1))]),(0,i.Lk)("div",za,[(0,i.bo)((0,i.Lk)("input",{type:r.showPassword?"text":"password",id:"password","onUpdate:modelValue":t[1]||(t[1]=e=>r.password=e),class:"form-control",placeholder:"請輸入密碼",required:""},null,8,Ha),[[p.hp,r.password]]),t[5]||(t[5]=(0,i.Lk)("label",{for:"password"},"密碼",-1)),(0,i.Lk)("button",{type:"button",class:"btn btn-link password-toggle",onClick:t[2]||(t[2]=e=>r.showPassword=!r.showPassword)},[(0,i.Lk)("i",{class:(0,u.C4)(r.showPassword?"fas fa-eye-slash":"fas fa-eye")},null,2)])]),(0,i.Lk)("div",Ga,[t[7]||(t[7]=(0,i.Lk)("div",{class:"form-check"},[(0,i.Lk)("input",{type:"checkbox",class:"form-check-input",id:"remember"}),(0,i.Lk)("label",{class:"form-check-label",for:"remember"},"記住我")],-1)),(0,i.bF)(n,{to:"/ForgotPwd",class:"text-primary text-decoration-none"},{default:(0,i.k6)((()=>t[6]||(t[6]=[(0,i.eW)(" 忘記密碼？ ")]))),_:1})]),t[10]||(t[10]=(0,i.Lk)("button",{type:"submit",class:"btn btn-primary w-100 mb-3"},[(0,i.Lk)("i",{class:"fas fa-sign-in-alt me-2"}),(0,i.eW)("登入 ")],-1)),(0,i.Lk)("div",Za,[(0,i.Lk)("p",Ya,[t[9]||(t[9]=(0,i.eW)("還沒有帳號？ ")),(0,i.bF)(n,{to:"/UserRegister",class:"text-primary text-decoration-none"},{default:(0,i.k6)((()=>t[8]||(t[8]=[(0,i.eW)(" 立即註冊 ")]))),_:1})])])],32)])])])}var ts={name:"UserLogin",data(){return{email:"",password:"",showPassword:!1}},methods:{...(0,w.i0)("auth",["login"]),async handleLogin(){try{const e=await this.login({email:this.email.trim().toLowerCase(),password:this.password});if(!e||!e.data)throw new Error("無法取得用戶資料或 token");const t=e.data;if(!t)throw new Error("無法取得用戶資料");alert("登入成功!歡迎"+t.name);const a=this.$route.query.redirect;a?this.$router.push(a):"admin"===t.role?this.$router.push("/admin"):this.$router.push("/Memberspage")}catch(e){ea(e,"登入失敗，請稍後再試")}}}};const as=(0,l.A)(ts,[["render",es],["__scopeId","data-v-4ba45f0c"]]);var ss=as;const rs={class:"container"},is={class:"mb-3"};function os(e,t,a,s,r,o){return(0,i.uX)(),(0,i.CE)("div",rs,[t[4]||(t[4]=(0,i.Lk)("h5",null,"忘記密碼",-1)),(0,i.Lk)("form",{onSubmit:t[1]||(t[1]=(0,p.D$)(((...e)=>o.handleForgotPassword&&o.handleForgotPassword(...e)),["prevent"]))},[(0,i.Lk)("div",is,[t[2]||(t[2]=(0,i.Lk)("label",{for:"email",class:"form-label"},"電子郵件",-1)),(0,i.bo)((0,i.Lk)("input",{type:"email","onUpdate:modelValue":t[0]||(t[0]=e=>r.email=e),class:"form-control",id:"email",required:""},null,512),[[p.Jo,r.email]])]),t[3]||(t[3]=(0,i.Lk)("button",{type:"submit",class:"btn btn-primary"},"發送重設密碼連結信",-1))],32)])}var ns=a(4373),ls={name:"ForgotPwd",data(){return{email:"",newPassword:""}},methods:{async handleForgotPassword(){try{const e=this.$route.params.token;await ns.A.post(`/api/reset-password/${e}`,{newPassword:this.newPassword}),alert("密碼已成功重新設置！"),this.$router.push("/login")}catch(e){alert("重設密碼失敗")}}}};const cs=(0,l.A)(ls,[["render",os]]);var ds=cs;const us={class:"order-confirmation container mt-5"},ps={key:0,class:"text-center"},ms={key:1,class:"text-center"},hs={key:2};function gs(e,t,a,s,r,o){const n=(0,i.g2)("router-link");return(0,i.uX)(),(0,i.CE)("div",us,[t[3]||(t[3]=(0,i.Lk)("h2",{class:"text-center mb-4"},"訂單確認",-1)),s.isLoading?((0,i.uX)(),(0,i.CE)("div",ps,t[0]||(t[0]=[(0,i.Lk)("p",null,"正在加載訂單詳情...",-1)]))):s.orderDetails?((0,i.uX)(),(0,i.CE)("div",hs,[(0,i.Lk)("p",null,"感謝您的購買，您的訂單編號是："+(0,u.v_)(s.orderId),1),(0,i.bF)(n,{to:"/",class:"btn btn-primary mt-3"},{default:(0,i.k6)((()=>t[2]||(t[2]=[(0,i.eW)("繼續購物！")]))),_:1})])):((0,i.uX)(),(0,i.CE)("div",ms,t[1]||(t[1]=[(0,i.Lk)("p",null,"無法加載訂單詳情，請稍後再試。",-1)])))])}var ks={name:"OrderConfirmation",setup(){const e=(0,r.lq)(),t=(0,w.Pj)(),a=(0,r.rd)(),s=e.params.orderId,o=(0,W.KR)(null),n=(0,W.KR)(!0),l=async()=>{n.value=!0;const e=/^[1-9]\d*$/.test(s);if(!e)return t.dispatch("notifications/showNotification",{type:"error",message:"訂單編號格式不正確，無法加載訂單詳情。"}),a.push("/").catch((e=>{e.name})),void(n.value=!1);try{const e=await C.A.orderAPI.getOrderById(s);if(!e||!e.id)return t.dispatch("notifications/showNotification",{type:"error",message:"訂單資料不完整，請聯繫客服。"}),void(n.value=!1);o.value=e}catch(r){r.response&&404===r.response.status?t.dispatch("notifications/showNotification",{type:"error",message:"訂單不存在，請確認您的訂單編號。"}):t.dispatch("notifications/showNotification",{type:"error",message:"加載訂單詳情時出錯，請稍後再試！"}),o.value=null}finally{n.value=!1}};return(0,i.sV)((()=>{s?l():a.push("/").catch((e=>{e.name}))})),{orderId:s,orderDetails:o,isLoading:n}}};const fs=(0,l.A)(ks,[["render",gs],["__scopeId","data-v-03bd47ad"]]);var bs=fs;const vs={class:"admin-dashboard container py-4"},Ls={class:"quick-actions mb-4"},ys={class:"row g-3"},ws={class:"col-md-3 col-sm-6"},Cs={class:"col-md-3 col-sm-6"},Is={class:"col-md-3 col-sm-6"},Ps={class:"col-md-3 col-sm-6"},As={class:"stats-overview mb-4"},_s={class:"row g-3"},Es={class:"col-md-3 col-sm-6"},Fs={class:"stat-card"},xs={class:"stat-info"},Ss={class:"col-md-3 col-sm-6"},Os={class:"stat-card"},Us={class:"stat-info"},Rs={class:"col-md-3 col-sm-6"},Ds={class:"stat-card"},Ts={class:"stat-info"},$s={class:"col-md-3 col-sm-6"},Ms={class:"stat-card"},Ns={class:"stat-info"},Xs={class:"card shadow-sm mb-4"},qs={class:"card-body"},Ws={class:"chart-container"},Vs={ref:"salesChart"},Bs={class:"row g-4 mb-4"},Ks={class:"col-md-6"},Js={class:"card shadow-sm h-100"},Qs={class:"card-body"},js={class:"comparison-item"},zs={class:"d-flex justify-content-between mb-2"},Hs={class:"fw-bold"},Gs={class:"d-flex justify-content-between mb-2"},Zs={class:"fw-bold"},Ys={class:"d-flex justify-content-between"},er={class:"fw-bold"},tr={class:"col-md-6"},ar={class:"card shadow-sm h-100"},sr={class:"card-body"},rr={class:"comparison-item"},ir={class:"d-flex justify-content-between mb-2"},or={class:"fw-bold"},nr={class:"d-flex justify-content-between"},lr={class:"fw-bold"};function cr(e,t,a,s,r,o){const n=(0,i.g2)("router-link");return(0,i.uX)(),(0,i.CE)("div",vs,[t[20]||(t[20]=(0,i.Lk)("div",{class:"dashboard-header mb-4"},[(0,i.Lk)("h2",{class:"fw-bold text-primary"},"管理後台儀表板"),(0,i.Lk)("p",{class:"text-muted"},"查看網站營運概況與重要數據")],-1)),(0,i.Lk)("div",Ls,[(0,i.Lk)("div",ys,[(0,i.Lk)("div",ws,[(0,i.bF)(n,{to:"/admin/CarouselImages",class:"quick-action-card"},{default:(0,i.k6)((()=>t[0]||(t[0]=[(0,i.Lk)("i",{class:"fas fa-images"},null,-1),(0,i.Lk)("span",null,"輪播圖片管理",-1)]))),_:1})]),(0,i.Lk)("div",Cs,[(0,i.bF)(n,{to:"/admin/products",class:"quick-action-card"},{default:(0,i.k6)((()=>t[1]||(t[1]=[(0,i.Lk)("i",{class:"fas fa-box"},null,-1),(0,i.Lk)("span",null,"商品管理",-1)]))),_:1})]),(0,i.Lk)("div",Is,[(0,i.bF)(n,{to:"/admin/orders",class:"quick-action-card"},{default:(0,i.k6)((()=>t[2]||(t[2]=[(0,i.Lk)("i",{class:"fas fa-shopping-cart"},null,-1),(0,i.Lk)("span",null,"訂單管理",-1)]))),_:1})]),(0,i.Lk)("div",Ps,[(0,i.bF)(n,{to:"/admin/users",class:"quick-action-card"},{default:(0,i.k6)((()=>t[3]||(t[3]=[(0,i.Lk)("i",{class:"fas fa-users"},null,-1),(0,i.Lk)("span",null,"使用者管理",-1)]))),_:1})])])]),(0,i.Lk)("div",As,[(0,i.Lk)("div",_s,[(0,i.Lk)("div",Es,[(0,i.Lk)("div",Fs,[t[5]||(t[5]=(0,i.Lk)("div",{class:"stat-icon bg-primary"},[(0,i.Lk)("i",{class:"fas fa-shopping-bag"})],-1)),(0,i.Lk)("div",xs,[(0,i.Lk)("h3",null,(0,u.v_)(r.todayOrders),1),t[4]||(t[4]=(0,i.Lk)("p",null,"今日訂單數",-1))])])]),(0,i.Lk)("div",Ss,[(0,i.Lk)("div",Os,[t[7]||(t[7]=(0,i.Lk)("div",{class:"stat-icon bg-success"},[(0,i.Lk)("i",{class:"fas fa-dollar-sign"})],-1)),(0,i.Lk)("div",Us,[(0,i.Lk)("h3",null,(0,u.v_)(o.formatNumber(r.todaySales)),1),t[6]||(t[6]=(0,i.Lk)("p",null,"今日銷售額",-1))])])]),(0,i.Lk)("div",Rs,[(0,i.Lk)("div",Ds,[t[9]||(t[9]=(0,i.Lk)("div",{class:"stat-icon bg-info"},[(0,i.Lk)("i",{class:"fas fa-user-plus"})],-1)),(0,i.Lk)("div",Ts,[(0,i.Lk)("h3",null,(0,u.v_)(r.todayNewMembers),1),t[8]||(t[8]=(0,i.Lk)("p",null,"今日新會員",-1))])])]),(0,i.Lk)("div",$s,[(0,i.Lk)("div",Ms,[t[11]||(t[11]=(0,i.Lk)("div",{class:"stat-icon bg-warning"},[(0,i.Lk)("i",{class:"fas fa-users"})],-1)),(0,i.Lk)("div",Ns,[(0,i.Lk)("h3",null,(0,u.v_)(r.totalMembers),1),t[10]||(t[10]=(0,i.Lk)("p",null,"總會員數",-1))])])])])]),(0,i.Lk)("div",Xs,[(0,i.Lk)("div",qs,[t[12]||(t[12]=(0,i.Lk)("h5",{class:"card-title mb-4"},[(0,i.Lk)("i",{class:"fas fa-chart-line me-2"}),(0,i.eW)("銷售趨勢 ")],-1)),(0,i.Lk)("div",Ws,[(0,i.Lk)("canvas",Vs,null,512)])])]),(0,i.Lk)("div",Bs,[(0,i.Lk)("div",Ks,[(0,i.Lk)("div",Js,[(0,i.Lk)("div",Qs,[t[16]||(t[16]=(0,i.Lk)("h5",{class:"card-title mb-3"},[(0,i.Lk)("i",{class:"fas fa-calendar-day me-2"}),(0,i.eW)("銷售比較 ")],-1)),(0,i.Lk)("div",js,[(0,i.Lk)("div",zs,[t[13]||(t[13]=(0,i.Lk)("span",null,"今日銷售額",-1)),(0,i.Lk)("span",Hs,(0,u.v_)(o.formatNumber(r.todaySales)),1)]),(0,i.Lk)("div",Gs,[t[14]||(t[14]=(0,i.Lk)("span",null,"昨日銷售額",-1)),(0,i.Lk)("span",Zs,(0,u.v_)(o.formatNumber(r.yesterdaySales)),1)]),(0,i.Lk)("div",Ys,[t[15]||(t[15]=(0,i.Lk)("span",null,"近7日銷售額",-1)),(0,i.Lk)("span",er,(0,u.v_)(o.formatNumber(r.last7DaySales)),1)])])])])]),(0,i.Lk)("div",tr,[(0,i.Lk)("div",ar,[(0,i.Lk)("div",sr,[t[19]||(t[19]=(0,i.Lk)("h5",{class:"card-title mb-3"},[(0,i.Lk)("i",{class:"fas fa-user-friends me-2"}),(0,i.eW)("會員統計 ")],-1)),(0,i.Lk)("div",rr,[(0,i.Lk)("div",ir,[t[17]||(t[17]=(0,i.Lk)("span",null,"今日新增會員",-1)),(0,i.Lk)("span",or,(0,u.v_)(r.todayNewMembers),1)]),(0,i.Lk)("div",nr,[t[18]||(t[18]=(0,i.Lk)("span",null,"累計會員總數",-1)),(0,i.Lk)("span",lr,(0,u.v_)(r.totalMembers),1)])])])])])])])}a(8872);var dr=a(3456),ur={name:"AdminDashboard",data(){return{todayOrders:0,todaySales:0,yesterdaySales:0,last7DaySales:0,salesData:[],lowStockProducts:[],todayNewMembers:0,totalMembers:0,carouselImages:[],products:[],sevenDaySalesRanking:[],monthSalesRanking:[],socket:null}},async mounted(){try{await this.loadDashboardData(),this.$nextTick((()=>{this.renderSalesChart()}))}catch(e){}},methods:{getLocalDateStr(e){const t=e?new Date(e):new Date;return t.toLocaleDateString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit"}).replace(/\//g,"-")},async loadDashboardData(){try{const[e,t,a]=await Promise.all([C.A.orderAPI.getOrders(),C.A.userAPI.getAllUsers(),C.A.productAPI.getAllProducts()]),s=e.data,r=t.data,i=a.data;this.products=i;const o=this.getLocalDateStr();this.todayOrders=s.filter((e=>{const t=this.getLocalDateStr(e.order_date);return t===o})).length;const n=new Date;n.setDate(n.getDate()-1);const l=this.getLocalDateStr(n),c=new Date;c.setDate(c.getDate()-7);const d=this.getLocalDateStr(c);this.todaySales=s.filter((e=>{const t=this.getLocalDateStr(e.order_date);return t===o})).reduce(((e,t)=>e+Number(t.total)),0),this.yesterdaySales=s.filter((e=>{const t=this.getLocalDateStr(e.order_date);return t===l})).reduce(((e,t)=>e+Number(t.total)),0),this.last7DaySales=s.filter((e=>{const t=this.getLocalDateStr(e.order_date);return t>=d&&t<=o})).reduce(((e,t)=>e+Number(t.total)),0);const u={};s.forEach((e=>{const t=e.order_date.split("T")[0],a=Number(e.total);u[t]?u[t]+=a:u[t]=a})),this.salesData=Object.keys(u).map((e=>({date:e,amount:u[e]}))).sort(((e,t)=>new Date(e.date)-new Date(t.date))),this.todayNewMembers=r.filter((e=>{if(e.created_at){const t=this.getLocalDateStr(e.created_at);return t===o}return!1})).length,this.totalMembers=r.length}catch(e){alert("加載儀表板數據時出錯，請稍後再試！")}},renderSalesChart(){const e=this.$refs.salesChart;if(e){const t=e.getContext("2d");this.chart=new dr.Ay(t,{type:"line",data:{labels:this.salesData.map((e=>e.date)),datasets:[{label:"銷售金額",data:this.salesData.map((e=>e.amount)),borderColor:"rgba(75,192,192,1)",backgroundColor:"rgba(75,192,192,0.1)",borderWidth:2,fill:!0,tension:.4}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:function(e){let t=e.dataset.label||"";return t&&(t+=": "),null!==e.parsed.y&&(t+=new Intl.NumberFormat("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0}).format(e.parsed.y)),t}}}}}})}},formatNumber(e){return Number(e).toLocaleString("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0,maximumFractionDigits:0}).replace(/^NT\$\s?/,"")},initWebSocket(){this.socket=new WebSocket("ws://localhost:5002/ws/admin"),this.socket.onmessage=e=>{const t=JSON.parse(e.data);"newOrder"===t.type&&this.updateDashboardData()}},updateDashboardData(e){const t=this.getLocalDateStr();e.order_date.split("T")[0]===t&&(this.todayOrders++,this.todaySales+=Number(e.total))},showEmptyChartMessage(){const e=document.getElementById("salesChart").getContext("2d");this.chart&&this.chart.destroy(),e.clearRect(0,0,e.width,e.height),e.font="14px Arial",e.fillStyle="#666",e.textAlign="center",e.fillText("資料尚未加載",e.width/2,e.height/2)},toggleRecipients(e){if(!this.users[e])return;this.users.forEach(((t,a)=>{a!==e&&t.showRecipients&&this.$set(t,"showRecipients",!1)}));const t=this.users[e];t.recipients&&t.recipients.length?this.$set(t,"showRecipients",!t.showRecipients):this.$store.dispatch("notifications/showNotification",{type:"warning",message:"該用戶沒有收件地址"})}}};const pr=(0,l.A)(ur,[["render",cr],["__scopeId","data-v-fddf2ccc"]]);var mr=pr;const hr={class:"admin-dashboard container mb-4"},gr={class:"tab-content",id:"adminTabContent"},kr={class:"tab-pane fade show active",id:"product",role:"tabpanel","aria-labelledby":"product-tab"},fr={class:"d-flex justify-content-between align-items-center mb-4"},br={class:"btn-group shadow-sm"},vr={class:"table"},Lr={class:"product-info-cell"},yr=["title"],wr=["onClick"],Cr={class:"text-nowrap text-center"},Ir={class:"product-description-container"},Pr=["onClick"],Ar={class:"text-center align-middle"},_r={class:"d-flex justify-content-center"},Er=["onClick"],Fr={class:"d-flex align-items-center"},xr=["value"],Sr={class:"card-footer bg-white d-flex justify-content-between align-items-center"},Or=["disabled"],Ur=["disabled"],Rr={class:"tab-pane fade",id:"brand",role:"tabpanel","aria-labelledby":"brand-tab"},Dr={class:"d-flex justify-content-between align-items-center mb-4"},Tr={class:"row row-cols-1 row-cols-md-3 g-4"},$r={class:"card h-100"},Mr={class:"card-body"},Nr={class:"d-flex justify-content-between align-items-center"},Xr={class:"card-title mb-0"},qr={class:"dropdown"},Wr={class:"dropdown-menu"},Vr=["onClick"],Br=["onClick"],Kr={class:"card-text text-muted mt-2"},Jr={class:"tab-pane fade",id:"tag",role:"tabpanel","aria-labelledby":"tag-tab"},Qr={class:"d-flex justify-content-start align-items-center mb-4"},jr={class:"row row-cols-1 row-cols-md-3 g-4"},zr={class:"card h-100"},Hr={class:"card-body"},Gr={class:"d-flex justify-content-between align-items-center"},Zr={class:"card-title mb-0"},Yr={class:"dropdown"},ei={class:"dropdown-menu"},ti=["onClick"],ai=["onClick"],si={class:"card-text text-muted mt-2"},ri={class:"modal fade",tabindex:"-1",ref:"tagModal"},ii={class:"modal-dialog"},oi={class:"modal-content"},ni={class:"modal-header"},li={class:"modal-body"},ci={class:"modal-footer"},di={class:"modal fade",tabindex:"-1",ref:"brandModal"},ui={class:"modal-dialog"},pi={class:"modal-content"},mi={class:"modal-header"},hi={class:"modal-body"},gi={class:"modal-footer"},ki={class:"modal fade",ref:"productDetailModal",tabindex:"-1"},fi={class:"modal-dialog modal-lg"},bi={class:"modal-content"},vi={class:"modal-header"},Li={key:0,class:"modal-body"},yi={class:"row"},wi={class:"col-md-6"},Ci=["src","alt"],Ii={class:"col-md-6"};function Pi(e,t,a,s,r,o){const n=(0,i.g2)("router-link");return(0,i.uX)(),(0,i.CE)(i.FK,null,[(0,i.Lk)("div",hr,[t[31]||(t[31]=(0,i.Lk)("h2",{class:"text-center"},"商品管理主頁",-1)),t[32]||(t[32]=(0,i.Lk)("ul",{class:"nav nav-pills nav-fill",id:"adminTab",role:"tablist"},[(0,i.Lk)("li",{class:"nav-item",role:"presentation"},[(0,i.Lk)("button",{class:"nav-link active",id:"product-tab","data-bs-toggle":"tab","data-bs-target":"#product",type:"button",role:"tab","aria-controls":"product","aria-selected":"true"},[(0,i.Lk)("i",{class:"bi bi-box-seam"}),(0,i.eW)("商品管理 ")])]),(0,i.Lk)("li",{class:"nav-item",role:"presentation"},[(0,i.Lk)("button",{class:"nav-link",id:"brand-tab","data-bs-toggle":"tab","data-bs-target":"#brand",type:"button",role:"tab","aria-controls":"brand","aria-selected":"false"}," 廠牌管理 ")]),(0,i.Lk)("li",{class:"nav-item",role:"presentation"},[(0,i.Lk)("button",{class:"nav-link",id:"tag-tab","data-bs-toggle":"tab","data-bs-target":"#tag",type:"button",role:"tab","aria-controls":"tag","aria-selected":"false"}," 標籤管理 ")])],-1)),(0,i.Lk)("div",gr,[(0,i.Lk)("div",kr,[(0,i.Lk)("div",fr,[(0,i.Lk)("div",br,[(0,i.bF)(n,{to:"/admin/CreateProduct",class:"btn btn-success d-flex align-items-center"},{default:(0,i.k6)((()=>t[15]||(t[15]=[(0,i.Lk)("i",{class:"bi bi-plus-circle me-2"},null,-1),(0,i.eW)("新增商品 ")]))),_:1}),(0,i.bF)(n,{to:"/admin/SpecialOffers",class:"btn btn-primary d-flex align-items-center"},{default:(0,i.k6)((()=>t[16]||(t[16]=[(0,i.Lk)("i",{class:"bi bi-tag me-2"},null,-1),(0,i.eW)("特價商品 ")]))),_:1})])]),t[20]||(t[20]=(0,i.Lk)("div",{class:"card-header bg-white d-flex justify-content-between align-items-center mb-3"},[(0,i.Lk)("h5",{class:"mb-0"},"商品清單")],-1)),(0,i.Lk)("table",vr,[t[18]||(t[18]=(0,i.Lk)("thead",null,[(0,i.Lk)("tr",{class:"text-nowrap text-center"},[(0,i.Lk)("th",null,"商品名稱"),(0,i.Lk)("th",null,"價格"),(0,i.Lk)("th",null,"庫存"),(0,i.Lk)("th",null,"描述"),(0,i.Lk)("th",null,"操作")])],-1)),(0,i.Lk)("tbody",null,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(o.paginatedProducts,((e,a)=>((0,i.uX)(),(0,i.CE)("tr",{key:e.id},[(0,i.Lk)("td",Lr,[(0,i.Lk)("span",{class:"product-name",title:e.name},(0,u.v_)(e.name),9,yr),(0,i.Lk)("button",{class:"btn btn-link btn-sm",onClick:t=>o.showProductDetail(e)}," 查看詳情 ",8,wr)]),(0,i.Lk)("td",null,"NT$"+(0,u.v_)(Math.round(e.price)),1),(0,i.Lk)("td",Cr,[(0,i.Lk)("span",{class:(0,u.C4)(e.stock<=10?"text-danger":"text-success")},(0,u.v_)(e.stock),3)]),(0,i.Lk)("td",null,[(0,i.Lk)("div",Ir,[(0,i.Lk)("p",{class:(0,u.C4)(["product-description mb-1",{expanded:e.isDescriptionExpanded}]),style:{"max-width":"200px",overflow:"hidden","text-overflow":"ellipsis"}},(0,u.v_)(e.isDescriptionExpanded?e.description:e.description.slice(0,50)+"..."),3),e.description.length>50?((0,i.uX)(),(0,i.CE)("button",{key:0,class:"btn btn-link btn-sm p-0",onClick:t=>o.toggleDescription(e)},(0,u.v_)(e.isDescriptionExpanded?"收起":"查看更多"),9,Pr)):(0,i.Q3)("",!0)])]),(0,i.Lk)("td",Ar,[(0,i.Lk)("div",_r,[(0,i.bF)(n,{to:{name:"EditProduct",params:{id:e.id}},class:"btn btn-warning btn-sm me-2"},{default:(0,i.k6)((()=>t[17]||(t[17]=[(0,i.eW)(" 編輯 ")]))),_:2},1032,["to"]),(0,i.Lk)("button",{class:"btn btn-danger btn-sm",onClick:t=>o.deleteProduct(e.id,a)}," 刪除 ",8,Er)])])])))),128))])]),(0,i.Lk)("div",Fr,[t[19]||(t[19]=(0,i.Lk)("label",{class:"me-2"},"每頁顯示：",-1)),(0,i.bo)((0,i.Lk)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>r.itemsPerPage=e),class:"form-select form-select-sm w-auto"},[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(r.itemsPerPageOptions,(e=>((0,i.uX)(),(0,i.CE)("option",{key:e,value:e},(0,u.v_)(e),9,xr)))),128))],512),[[p.u1,r.itemsPerPage,void 0,{number:!0}]])]),(0,i.Lk)("div",Sr,[(0,i.Lk)("div",null,"第 "+(0,u.v_)(r.currentPage)+" 頁，共 "+(0,u.v_)(o.totalPages)+" 頁",1),(0,i.Lk)("button",{class:"btn btn-outline-secondary",disabled:1===r.currentPage,onClick:t[1]||(t[1]=e=>r.currentPage--)}," 上一頁 ",8,Or),(0,i.Lk)("button",{class:"btn btn-outline-secondary",disabled:r.currentPage===o.totalPages,onClick:t[2]||(t[2]=e=>r.currentPage++)}," 下一頁 ",8,Ur)])])]),(0,i.Lk)("div",Rr,[(0,i.Lk)("div",Dr,[(0,i.Lk)("button",{class:"btn btn-success",onClick:t[3]||(t[3]=(...e)=>o.openCreateBrandModal&&o.openCreateBrandModal(...e))},t[21]||(t[21]=[(0,i.Lk)("i",{class:"bi bi-plus-circle me-2"},null,-1),(0,i.eW)("新增廠牌 ")]))]),(0,i.Lk)("div",Tr,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(r.brands,((e,a)=>((0,i.uX)(),(0,i.CE)("div",{key:e.id,class:"col"},[(0,i.Lk)("div",$r,[(0,i.Lk)("div",Mr,[(0,i.Lk)("div",Nr,[(0,i.Lk)("h6",Xr,(0,u.v_)(e.name),1),(0,i.Lk)("div",qr,[t[24]||(t[24]=(0,i.Lk)("button",{class:"btn btn-link",type:"button","data-bs-toggle":"dropdown"},[(0,i.Lk)("i",{class:"bi bi-three-vertical"})],-1)),(0,i.Lk)("ul",Wr,[(0,i.Lk)("li",null,[(0,i.Lk)("button",{class:"dropdown-item",onClick:e=>o.openEditBrandModal(a)},t[22]||(t[22]=[(0,i.Lk)("i",{class:"bi bi-pencil me-2"},null,-1),(0,i.eW)("編輯 ")]),8,Vr)]),(0,i.Lk)("li",null,[(0,i.Lk)("button",{class:"dropdown-item text-danger",onClick:t=>o.deleteBrand(e.id,a)},t[23]||(t[23]=[(0,i.Lk)("i",{class:"bi bi-trash me-2"},null,-1),(0,i.eW)("刪除 ")]),8,Br)])])])]),(0,i.Lk)("p",Kr,[(0,i.Lk)("small",null,"已標記商品:"+(0,u.v_)(e.productCount||0)+" 項",1)])])])])))),128))])]),(0,i.Lk)("div",Jr,[(0,i.Lk)("div",Qr,[t[26]||(t[26]=(0,i.Lk)("h5",{class:"mb-0"},"標籤列表",-1)),(0,i.Lk)("button",{class:"btn btn-success",onClick:t[4]||(t[4]=(...e)=>o.openCreateTagModal&&o.openCreateTagModal(...e))},t[25]||(t[25]=[(0,i.Lk)("i",{class:"bi bi-plus-circle me-2"},null,-1),(0,i.eW)("新增標籤 ")]))]),(0,i.Lk)("div",jr,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(r.tags,((e,a)=>((0,i.uX)(),(0,i.CE)("div",{key:e.id,class:"col"},[(0,i.Lk)("div",zr,[(0,i.Lk)("div",Hr,[(0,i.Lk)("div",Gr,[(0,i.Lk)("h6",Zr,[t[27]||(t[27]=(0,i.Lk)("i",{class:"bi bi-tag me-2"},null,-1)),(0,i.eW)((0,u.v_)(e.name),1)]),(0,i.Lk)("div",Yr,[t[30]||(t[30]=(0,i.Lk)("button",{class:"btn btn-link",type:"button","data-bs-toggle":"dropdown"},[(0,i.Lk)("i",{class:"bi bi-three-vertical"})],-1)),(0,i.Lk)("ul",ei,[(0,i.Lk)("li",null,[(0,i.Lk)("button",{class:"dropdown-item",onClick:e=>o.openEditTagModal(a)},t[28]||(t[28]=[(0,i.Lk)("i",{class:"bi bi-pencil me-2"},null,-1),(0,i.eW)("編輯 ")]),8,ti)]),(0,i.Lk)("li",null,[(0,i.Lk)("button",{class:"dropdown-item text-danger",onClick:t=>o.deleteTag(e.id,a)},t[29]||(t[29]=[(0,i.Lk)("i",{class:"bi bi-trash me-2"},null,-1),(0,i.eW)("刪除 ")]),8,ai)])])])]),(0,i.Lk)("p",si,[(0,i.Lk)("small",null,"已標記商品:"+(0,u.v_)(e.productCount||0)+" 項",1)])])])])))),128))])])]),(0,i.Lk)("div",ri,[(0,i.Lk)("div",ii,[(0,i.Lk)("div",oi,[(0,i.Lk)("div",ni,[t[33]||(t[33]=(0,i.Lk)("h5",{class:"modal-title"},"編輯標籤",-1)),(0,i.Lk)("button",{type:"button",class:"btn-close",onClick:t[5]||(t[5]=(...e)=>o.closeTagModal&&o.closeTagModal(...e))})]),(0,i.Lk)("div",li,[(0,i.bo)((0,i.Lk)("input",{type:"text","onUpdate:modelValue":t[6]||(t[6]=e=>r.tagForm.name=e),class:"form-control",placeholder:"標籤名稱"},null,512),[[p.Jo,r.tagForm.name]])]),(0,i.Lk)("div",ci,[(0,i.Lk)("button",{type:"button",class:"btn btn-secondary",onClick:t[7]||(t[7]=(...e)=>o.closeTagModal&&o.closeTagModal(...e))},"取消"),(0,i.Lk)("button",{type:"submit",class:"btn btn-primary",onClick:t[8]||(t[8]=(...e)=>o.saveTag&&o.saveTag(...e))},(0,u.v_)(r.isEditingTag?"保存變更":"新增標籤"),1)])])])],512),(0,i.Lk)("div",di,[(0,i.Lk)("div",ui,[(0,i.Lk)("div",pi,[(0,i.Lk)("div",mi,[t[34]||(t[34]=(0,i.Lk)("h5",{class:"modal-title"},"編輯廠牌",-1)),(0,i.Lk)("button",{type:"button",class:"btn-close",onClick:t[9]||(t[9]=(...e)=>o.closeBrandModal&&o.closeBrandModal(...e))})]),(0,i.Lk)("div",hi,[(0,i.bo)((0,i.Lk)("input",{type:"text","onUpdate:modelValue":t[10]||(t[10]=e=>r.brandForm.name=e),class:"form-control",placeholder:"廠牌名稱"},null,512),[[p.Jo,r.brandForm.name]])]),(0,i.Lk)("div",gi,[(0,i.Lk)("button",{class:"btn btn-secondary",onClick:t[11]||(t[11]=(...e)=>o.closeBrandModal&&o.closeBrandModal(...e))},"取消"),(0,i.Lk)("button",{class:"btn btn-primary",onClick:t[12]||(t[12]=(...e)=>o.saveBrand&&o.saveBrand(...e))},"保存")])])])],512),(0,i.Lk)("div",ki,[(0,i.Lk)("div",fi,[(0,i.Lk)("div",bi,[(0,i.Lk)("div",vi,[t[35]||(t[35]=(0,i.Lk)("h5",{class:"modal-title"},"商品詳細資訊",-1)),(0,i.Lk)("button",{type:"button",class:"btn-close",onClick:t[13]||(t[13]=(...e)=>o.closeProductDetailModal&&o.closeProductDetailModal(...e))})]),r.selectedProduct?((0,i.uX)(),(0,i.CE)("div",Li,[(0,i.Lk)("div",yi,[(0,i.Lk)("div",wi,[(0,i.Lk)("img",{src:r.selectedProduct.image||"/img/default-product.jpg",class:"img-fluid",onError:t[14]||(t[14]=e=>e.target.src="/img/default-product.jpg"),alt:r.selectedProduct.name},null,40,Ci)]),(0,i.Lk)("div",Ii,[(0,i.Lk)("h5",null,"商品名稱: "+(0,u.v_)(r.selectedProduct.name),1),(0,i.Lk)("p",null,"商品價格: "+(0,u.v_)(r.selectedProduct.price),1),(0,i.Lk)("p",null,"商品庫存: "+(0,u.v_)(r.selectedProduct.stock),1),(0,i.Lk)("p",null,"商品描述: "+(0,u.v_)(r.selectedProduct.description),1)])])])):(0,i.Q3)("",!0)])])],512)],64)}var Ai={name:"AdminProducts",data(){return{products:[],tags:[],selectedProduct:null,brands:[],productForm:{name:"",price:0,stock:0,description:"",brand_id:"",tag_ids:[]},tagForm:{name:""},brandForm:{name:""},isEditing:!1,currentIndex:null,isEditingTag:!1,isEditingBrand:!1,currentPage:1,itemsPerPage:10,itemsPerPageOptions:[10,20,50]}},mounted(){this.loadProducts(),this.loadTags(),this.loadBrands()},computed:{paginatedProducts(){const e=(this.currentPage-1)*this.itemsPerPage,t=e+this.itemsPerPage;return this.products.slice(e,t)},totalPages(){return Math.ceil(this.products.length/this.itemsPerPage)}},methods:{async loadProducts(){try{const e=await C.A.productAPI.getAllProducts();this.products=e.map((e=>({...e,isDescriptionExpanded:!1}))),this.currentPage>this.totalPages&&(this.currentPage=this.totalPages||1)}catch(e){ea(e,"加載產品時出錯，請稍後再試！")}},showProductDetail(e){this.selectedProduct={...e};const t=new Yt.aF(this.$refs.productDetailModal);t.show()},closeProductDetailModal(){const e=Yt.aF.getInstance(this.$refs.productDetailModal);e&&(e.hide(),this.selectedProduct=null)},async loadTags(){try{const e=await C.A.tagAPI.getAllTags();this.tags=Array.isArray(e)?e:[]}catch(e){ea(e,"加載標籤時錯誤，請稍候再試！"),this.tags=[]}},async loadBrands(){try{const e=await C.A.brandAPI.getAllBrands();this.brands=e}catch(e){ea(e,"加載廠牌時出錯，請稍候再試！")}},async saveTag(){try{if(this.isEditingTag)await C.A.tagAPI.updateTag(this.tagForm.id,this.tagForm),this.tags[this.currentIndex]={...this.tagForm};else{const e=await C.A.tagAPI.createTag(this.tagForm);this.tags.push(e.data)}}catch(e){ea(e,"保存標籤時出錯，請稍候再試！")}this.closeTagModal()},async saveBrand(){try{if(this.isEditingBrand)await C.A.brandAPI.updateBrand(this.brandForm.id,this.brandForm),this.brands[this.currentIndex]={...this.brandForm};else{const e=await C.A.brandAPI.createBrand(this.brandForm);this.brands.push(e.data)}}catch(e){ea(e,"保存廠牌時出錯，請稍候再試！")}this.closeBrandModal()},async deleteProduct(e,t){if(confirm("確定要刪除此商品？"))try{await C.A.productAPI.deleteProduct(e),this.products.splice(t,1)}catch(a){ea(a,"刪除產品時出錯，請稍後再試！")}},async deleteTag(e,t){if(confirm("確定要刪除此標籤？"))try{await C.A.tagAPI.deleteTag(e),this.tags.splice(t,1)}catch(a){ea(a,"刪除標籤時出錯，請稍後再試！")}},async deleteBrand(e,t){if(confirm("確定要刪除此廠牌？"))try{await C.A.brandAPI.deleteBrand(e),this.brands.splice(t,1)}catch(a){ea(a,"刪除廠牌時出錯，請稍後再試！")}},openCreateTagModal(){this.isEditingTag=!1,this.tagForm={name:""},this.$nextTick((()=>{const e=new Yt.aF(this.$refs.tagModal);e.show()}))},openCreateBrandModal(){this.isEditingBrand=!1,this.brandForm={name:""},this.$nextTick((()=>{const e=new Yt.aF(this.$refs.brandModal);e.show()}))},openEditTagModal(e){this.isEditingTag=!0,this.currentIndex=e,this.tagForm={...this.tags[e]};const t=new Yt.aF(this.$refs.tagModal);t.show()},openEditBrandModal(e){this.isEditingBrand=!0,this.currentIndex=e,this.brandForm={...this.brands[e]};const t=new Yt.aF(this.$refs.brandModal);t.show()},closeTagModal(){const e=Yt.aF.getInstance(this.$refs.tagModal);e&&e.hide()},closeBrandModal(){const e=Yt.aF.getInstance(this.$refs.brandModal);e&&e.hide()},toggleDescription(e){e.isDescriptionExpanded=!e.isDescriptionExpanded}},watch:{itemsPerPage(){this.currentPage=1}}};const _i=(0,l.A)(Ai,[["render",Pi],["__scopeId","data-v-a615c456"]]);var Ei=_i;const Fi={class:"admin-dashboard container py-4"},xi={class:"page-header mb-4"},Si={class:"d-flex justify-content-between align-items-center"},Oi={class:"card shadow-sm"},Ui={class:"table-responsive"},Ri={class:"table table-hover align-middle mb-0"},Di={class:"d-flex align-items-center"},Ti={class:"user-avatar me-3"},$i={class:"mb-0"},Mi={class:"text-muted"},Ni={class:"address-section"},Xi={class:"d-flex align-items-center"},qi=["onClick"],Wi={class:"me-2"},Vi={key:1,class:"text-muted"},Bi={class:"text-end"},Ki={class:"btn-group"},Ji=["onClick"],Qi=["onClick"],ji=["onClick"],zi={key:0},Hi={colspan:"6"},Gi={class:"recipient-list p-3"},Zi={class:"d-flex justify-content-between align-items-start"},Yi={class:"fw-bold"},eo={class:"text-muted small"},to={class:"text-muted small"},ao={class:"recipient-actions"},so=["onClick"],ro=["onClick"],io={class:"modal fade",tabindex:"-1",ref:"userModal"},oo={class:"modal-dialog"},no={class:"modal-content"},lo={class:"modal-header border-0"},co={class:"modal-title"},uo={class:"modal-body"},po={class:"mb-3"},mo={class:"mb-3"},ho={class:"mb-3"},go={class:"input-group"},ko=["type","required"],fo={class:"mb-3"},bo=["required"],vo={class:"mb-3"},Lo={key:0},yo={class:"mb-3"},wo={class:"mb-3"},Co={class:"modal-footer border-0"},Io={class:"modal fade",tabindex:"-1",ref:"recipientModal"},Po={class:"modal-dialog"},Ao={class:"modal-content"},_o={class:"modal-header border-0"},Eo={class:"modal-title"},Fo={class:"modal-body"},xo={class:"mb-3"},So={class:"mb-3"},Oo={class:"mb-3"},Uo={class:"modal-footer border-0"};function Ro(e,t,a,s,r,o){return(0,i.uX)(),(0,i.CE)("div",Fi,[(0,i.Lk)("div",xi,[(0,i.Lk)("div",Si,[t[21]||(t[21]=(0,i.Lk)("div",null,[(0,i.Lk)("h2",{class:"fw-bold text-primary mb-1"},"用戶管理"),(0,i.Lk)("p",{class:"text-muted mb-0"},"管理系統用戶和權限")],-1)),(0,i.Lk)("button",{class:"btn btn-primary",onClick:t[0]||(t[0]=(...e)=>o.openCreateUserModal&&o.openCreateUserModal(...e))},t[20]||(t[20]=[(0,i.Lk)("i",{class:"fas fa-user-plus me-2"},null,-1),(0,i.eW)("新增用戶 ")]))])]),(0,i.Lk)("div",Oi,[(0,i.Lk)("div",Ui,[(0,i.Lk)("table",Ri,[t[29]||(t[29]=(0,i.Lk)("thead",{class:"bg-light"},[(0,i.Lk)("tr",null,[(0,i.Lk)("th",{class:"py-3"},"用戶資訊"),(0,i.Lk)("th",{class:"py-3"},"權限"),(0,i.Lk)("th",{class:"py-3"},"收件地址"),(0,i.Lk)("th",{class:"py-3 text-end"},"操作")])],-1)),(0,i.Lk)("tbody",null,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(r.users,((e,a)=>((0,i.uX)(),(0,i.CE)(i.FK,{key:a},[(0,i.Lk)("tr",null,[(0,i.Lk)("td",null,[(0,i.Lk)("div",Di,[(0,i.Lk)("div",Ti,(0,u.v_)(o.getUserInitials(e.name)),1),(0,i.Lk)("div",null,[(0,i.Lk)("h6",$i,(0,u.v_)(e.name),1),(0,i.Lk)("small",Mi,(0,u.v_)(e.email),1)])])]),(0,i.Lk)("td",null,[(0,i.Lk)("span",{class:(0,u.C4)(o.getRoleBadgeClass(e.role))},(0,u.v_)(o.getRoleDisplayName(e.role)),3)]),(0,i.Lk)("td",Ni,[(0,i.Lk)("div",Xi,[e.recipients?.length?((0,i.uX)(),(0,i.CE)("button",{key:0,class:"btn btn-link btn-sm text-decoration-none d-flex align-items-center",onClick:(0,p.D$)((e=>o.toggleRecipients(a)),["stop"])},[(0,i.Lk)("span",Wi,(0,u.v_)(e.recipients?e.recipients.length:0)+" 個地址",1),(0,i.Lk)("i",{class:(0,u.C4)(["fas",e.showRecipients?"fa-chevron-up":"fa-chevron-down"])},null,2)],8,qi)):((0,i.uX)(),(0,i.CE)("span",Vi,"無收件地址"))])]),(0,i.Lk)("td",Bi,[(0,i.Lk)("div",Ki,[(0,i.Lk)("button",{class:"btn btn-outline-primary btn-sm",onClick:e=>o.openEditUserModal(a),title:"編輯用戶"},t[22]||(t[22]=[(0,i.Lk)("i",{class:"fas fa-edit"},null,-1)]),8,Ji),(0,i.Lk)("button",{class:"btn btn-outline-success btn-sm",onClick:e=>o.addRecipient(a),title:"新增收件地址"},t[23]||(t[23]=[(0,i.Lk)("i",{class:"fas fa-map-marker-alt"},null,-1)]),8,Qi),(0,i.Lk)("button",{class:"btn btn-outline-danger btn-sm",onClick:e=>o.deleteUser(a),title:"刪除用戶"},t[24]||(t[24]=[(0,i.Lk)("i",{class:"fas fa-trash"},null,-1)]),8,ji)])])]),e.showRecipients&&e.recipients&&e.recipients?.length?((0,i.uX)(),(0,i.CE)("tr",zi,[(0,i.Lk)("td",Hi,[(0,i.Lk)("div",Gi,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.recipients,((e,s)=>((0,i.uX)(),(0,i.CE)("div",{key:e.id||s,class:"address-item"},[(0,i.Lk)("div",Zi,[(0,i.Lk)("div",null,[(0,i.Lk)("div",Yi,(0,u.v_)(e.name),1),(0,i.Lk)("div",eo,[t[25]||(t[25]=(0,i.Lk)("i",{class:"fas fa-phone me-1"},null,-1)),(0,i.eW)((0,u.v_)(e.phone),1)]),(0,i.Lk)("div",to,[t[26]||(t[26]=(0,i.Lk)("i",{class:"fas fa-map-marker-alt me-1"},null,-1)),(0,i.eW)((0,u.v_)(e.address),1)])]),(0,i.Lk)("div",ao,[(0,i.Lk)("button",{class:"btn btn-outline-primary btn-sm me-2",onClick:e=>r.editRecipient(a,s),title:"編輯收件人"},t[27]||(t[27]=[(0,i.Lk)("i",{class:"fas fa-edit"},null,-1)]),8,so),(0,i.Lk)("button",{class:"btn btn-outline-danger btn-sm",onClick:e=>o.deleteRecipient(a,s),title:"刪除收件人"},t[28]||(t[28]=[(0,i.Lk)("i",{class:"fas fa-trash"},null,-1)]),8,ro)])])])))),128))])])])):(0,i.Q3)("",!0)],64)))),128))])])])]),(0,i.Lk)("div",io,[(0,i.Lk)("div",oo,[(0,i.Lk)("div",no,[(0,i.Lk)("div",lo,[(0,i.Lk)("h5",co,(0,u.v_)(r.isEditing?"編輯用戶":"新增用戶"),1),(0,i.Lk)("button",{type:"button",class:"btn-close",onClick:t[1]||(t[1]=(...e)=>o.closeModal&&o.closeModal(...e))})]),(0,i.Lk)("div",uo,[(0,i.Lk)("form",{onSubmit:t[10]||(t[10]=(0,p.D$)(((...e)=>o.saveUser&&o.saveUser(...e)),["prevent"])),class:"needs-validation"},[(0,i.Lk)("div",po,[t[30]||(t[30]=(0,i.Lk)("label",{class:"form-label"},"用戶名稱",-1)),(0,i.bo)((0,i.Lk)("input",{type:"text",class:"form-control","onUpdate:modelValue":t[2]||(t[2]=e=>r.userForm.name=e),required:""},null,512),[[p.Jo,r.userForm.name]])]),(0,i.Lk)("div",mo,[t[31]||(t[31]=(0,i.Lk)("label",{class:"form-label"},"電子郵件",-1)),(0,i.bo)((0,i.Lk)("input",{type:"email",class:"form-control","onUpdate:modelValue":t[3]||(t[3]=e=>r.userForm.email=e),required:""},null,512),[[p.Jo,r.userForm.email]])]),(0,i.Lk)("div",ho,[t[32]||(t[32]=(0,i.Lk)("label",{class:"form-label"},"密碼",-1)),(0,i.Lk)("div",go,[(0,i.bo)((0,i.Lk)("input",{type:r.showPassword?"text":"password",class:"form-control","onUpdate:modelValue":t[4]||(t[4]=e=>r.userForm.password=e),required:!r.isEditing},null,8,ko),[[p.hp,r.userForm.password]]),(0,i.Lk)("button",{type:"button",class:"btn btn-outline-secondary",onClick:t[5]||(t[5]=e=>r.showPassword=!r.showPassword)},[(0,i.Lk)("i",{class:(0,u.C4)(["fas",r.showPassword?"fa-eye-slash":"fa-eye"])},null,2)])])]),(0,i.Lk)("div",fo,[t[33]||(t[33]=(0,i.Lk)("label",{class:"form-label"},"確認密碼",-1)),(0,i.bo)((0,i.Lk)("input",{type:"password",class:"form-control","onUpdate:modelValue":t[6]||(t[6]=e=>r.userForm.confirmPassword=e),required:!r.isEditing||r.userForm.password},null,8,bo),[[p.Jo,r.userForm.confirmPassword]])]),(0,i.Lk)("div",vo,[t[35]||(t[35]=(0,i.Lk)("label",{class:"form-label"},"用戶權限",-1)),(0,i.bo)((0,i.Lk)("select",{class:"form-select","onUpdate:modelValue":t[7]||(t[7]=e=>r.userForm.role=e)},t[34]||(t[34]=[(0,i.Lk)("option",{value:"user"},"一般用戶",-1),(0,i.Lk)("option",{value:"admin"},"管理員",-1)]),512),[[p.u1,r.userForm.role]])]),"user"===r.userForm.role?((0,i.uX)(),(0,i.CE)("div",Lo,[(0,i.Lk)("div",yo,[t[36]||(t[36]=(0,i.Lk)("label",{class:"form-label"},"聯絡電話",-1)),(0,i.bo)((0,i.Lk)("input",{type:"tel",class:"form-control","onUpdate:modelValue":t[8]||(t[8]=e=>r.userForm.phone=e),required:""},null,512),[[p.Jo,r.userForm.phone]])]),(0,i.Lk)("div",wo,[t[37]||(t[37]=(0,i.Lk)("label",{class:"form-label"},"聯絡地址",-1)),(0,i.bo)((0,i.Lk)("input",{type:"text",class:"form-control","onUpdate:modelValue":t[9]||(t[9]=e=>r.userForm.address=e),required:""},null,512),[[p.Jo,r.userForm.address]])])])):(0,i.Q3)("",!0)],32)]),(0,i.Lk)("div",Co,[(0,i.Lk)("button",{type:"button",class:"btn btn-outline-secondary",onClick:t[11]||(t[11]=(...e)=>o.closeModal&&o.closeModal(...e))},"取消"),(0,i.Lk)("button",{type:"submit",class:"btn btn-primary",onClick:t[12]||(t[12]=(...e)=>o.saveUser&&o.saveUser(...e))},(0,u.v_)(r.isEditing?"保存變更":"新增用戶"),1)])])])],512),(0,i.Lk)("div",Io,[(0,i.Lk)("div",Po,[(0,i.Lk)("div",Ao,[(0,i.Lk)("div",_o,[(0,i.Lk)("h5",Eo,(0,u.v_)(r.isEditingRecipient?"編輯收件地址":"新增收件地址"),1),(0,i.Lk)("button",{type:"button",class:"btn-close",onClick:t[13]||(t[13]=(...e)=>o.closeRecipientModal&&o.closeRecipientModal(...e))})]),(0,i.Lk)("div",Fo,[(0,i.Lk)("form",{onSubmit:t[17]||(t[17]=(0,p.D$)(((...e)=>o.saveRecipient&&o.saveRecipient(...e)),["prevent"]))},[(0,i.Lk)("div",xo,[t[38]||(t[38]=(0,i.Lk)("label",{class:"form-label"},"收件人姓名",-1)),(0,i.bo)((0,i.Lk)("input",{type:"text",class:"form-control","onUpdate:modelValue":t[14]||(t[14]=e=>r.editRecipient.name=e),required:""},null,512),[[p.Jo,r.editRecipient.name]])]),(0,i.Lk)("div",So,[t[39]||(t[39]=(0,i.Lk)("label",{class:"form-label"},"聯絡電話",-1)),(0,i.bo)((0,i.Lk)("input",{type:"tel",class:"form-control","onUpdate:modelValue":t[15]||(t[15]=e=>r.editRecipient.phone=e),required:""},null,512),[[p.Jo,r.editRecipient.phone]])]),(0,i.Lk)("div",Oo,[t[40]||(t[40]=(0,i.Lk)("label",{class:"form-label"},"收件地址",-1)),(0,i.bo)((0,i.Lk)("input",{type:"text",class:"form-control","onUpdate:modelValue":t[16]||(t[16]=e=>r.editRecipient.address=e),required:""},null,512),[[p.Jo,r.editRecipient.address]])])],32)]),(0,i.Lk)("div",Uo,[(0,i.Lk)("button",{type:"button",class:"btn btn-outline-secondary",onClick:t[18]||(t[18]=(...e)=>o.closeRecipientModal&&o.closeRecipientModal(...e))},"取消"),(0,i.Lk)("button",{type:"submit",class:"btn btn-primary",onClick:t[19]||(t[19]=(...e)=>o.saveRecipient&&o.saveRecipient(...e))},(0,u.v_)(r.isEditingRecipient?"更新地址":"新增地址"),1)])])])],512)])}var Do={name:"AdminUsers",data(){return{users:[],userForm:{name:"",email:"",password:"",confirmPassword:"",role:"user",phone:"",address:""},isEditing:!1,currentIndex:null,showPassword:!1,editRecipient:{name:"",phone:"",address:"",user_id:null},isEditingRecipient:!1,editingRecipientIndex:-1}},mounted(){this.loadUsers(),document.addEventListener("click",this.handleClick)},beforeDestroy(){document.removeEventListener("click",this.handleClick)},handleClick(e){e.target.closest(".address-section")||this.users.forEach((e=>{e.showRecipients&&(e.showRecipients=!1)}))},methods:{async loadUsers(){try{const t=await C.A.userAPI.getAllUsers(),a=t.data;for(let s of a)try{const e=await C.A.recipientAPI.getRecipients(s.id);s.recipients=e.data||[],s.showRecipients=!1}catch(e){s.recipients=[]}this.users=a}catch(e){ea(e,"無法加載用戶資料")}},async deleteRecipient(e,t){try{const a=this.users[e],s=a.recipients[t];confirm("確定要刪除此收件人資料？")&&(await C.A.recipientAPI.deleteRecipient(s.id),a.recipients.splice(t,1))}catch(a){ea(a,"刪除收件人失敗")}},openCreateUserModal(){this.isEditing=!1,this.userForm={name:"",email:"",password:"",confirmPassword:"",role:"user",phone:"",address:""},this.$nextTick((()=>{const e=new Yt.aF(this.$refs.userModal);e.show()}))},openEditUserModal(e){this.isEditing=!0,this.currentIndex=e,this.userForm={...this.users[e]},this.userForm.password="",this.userForm.confirmPassword="";const t=new Yt.aF(this.$refs.userModal);t.show()},async saveUser(){try{if(this.userForm.password!==this.userForm.confirmPassword)return void alert("密碼和確認密碼不一致");if(this.isEditing){const e={name:this.userForm.name,email:this.userForm.email,role:this.userForm.role,phone:this.userForm.phone,address:this.userForm.address};this.userForm.password&&(e.password=this.userForm.password),await C.A.userAPI.updateUser(this.userForm.id,e),this.users[this.currentIndex]={...this.userForm}}else{const e={name:this.userForm.name,email:this.userForm.email,role:this.userForm.role,phone:this.userForm.phone,address:this.userForm.address,password:this.userForm.password},t=await C.A.userAPI.createUsers(e);this.users.push(t.data)}this.closeModal()}catch(e){alert("更新用戶資料失敗！")}},async deleteUser(e){if(confirm("確定要刪除此用戶嗎？"))try{await C.A.userAPI.deleteUsers(this.users[e].id),this.users.splice(e,1)}catch(t){alert("無法刪除用戶")}},closeModal(){this.$nextTick((()=>{const e=Yt.aF.getInstance(this.$refs.userModal);e&&e.hide()}))},getUserInitials(e){return e?e.substring(0,2).toUpperCase():"??"},getRoleBadgeClass(e){return"admin"===e?"badge bg-primary":"badge bg-success"},getRoleDisplayName(e){return"admin"===e?"管理員":"一般用戶"},toggleRecipients(e){if(!this.users[e])return;const t=this.users[e];t.recipients?.length?(this.users.forEach(((t,a)=>{a!==e&&(t.showRecipients=!1)})),t.showRecipients=!t.showRecipients):alert("此用戶沒有收件人資料")},addRecipient(e){const t=this.users[e].id;this.isEditingRecipient=!1,this.editRecipient={name:"",phone:"",address:"",user_id:t},this.showRecipientModal()},editRecipientInfo(e,t){this.isEditingRecipient=!0,this.editingRecipientIndex=t;const a=this.users[e].recipients[t];this.editRecipient={...a},this.showRecipientModal()},async saveRecipient(){if(this.isRecipientValid(this.editRecipient))try{let e;e=this.isEditingRecipient?await C.A.recipientAPI.updateRecipient(this.editRecipient.id,this.editRecipient):await C.A.recipientAPI.addRecipient(this.editRecipient);const t=this.$refs.recipientModal,a=Yt.aF.getInstance(t);a.hide(),await this.loadUsers(),alert(this.isEditingRecipient?"收件人資料已更新":"新增收件人成功")}catch(e){ea(e,this.isEditingRecipient?"更新收件人失敗":"新增收件人失敗")}else alert("請檢查收件人資料是否完整且格式正確！")},isRecipientValid(e){const t=/^[0-9]{10}$/;return e.name.trim()&&t.test(e.phone)&&e.address.trim()},showRecipientModal(){const e=new Yt.aF(this.$refs.recipientModal);e.show()},closeRecipientModal(){const e=Yt.aF.getInstance(this.$refs.recipientModal);e&&e.hide()}}};const To=(0,l.A)(Do,[["render",Ro],["__scopeId","data-v-3fbfdfaa"]]);var $o=To;const Mo={class:"admin-dashboard container mt-5"},No={class:"filters-container p-3 bg-light rounded-3 mb-4"},Xo={class:"row g-3"},qo={class:"col-md-5"},Wo={class:"input-group"},Vo={class:"col-md-4"},Bo={class:"col-md-3"},Ko={class:"table-responsive rounded-3 shadow-sm"},Jo={class:"table table-hover mb-0"},Qo={class:"align-middle"},jo={class:"align-middle"},zo={class:"d-flex align-items-center"},Ho={class:"user-avatar"},Go={class:"ms-2"},Zo={class:"align-middle fw-bold"},Yo={class:"align-middle"},en={class:"align-middle"},tn={class:"align-middle"},an=["onClick"],sn=["onClick","disabled"],rn={class:"pagination-container mt-4 d-flex justify-content-between align-items-center"},on={class:"page-info text-muted"},nn={class:"pagination-controls"},ln=["disabled"],cn=["disabled"];function dn(e,t,a,s,r,o){const n=(0,i.gN)("tooltip");return(0,i.uX)(),(0,i.CE)("div",Mo,[t[13]||(t[13]=(0,i.Lk)("div",{class:"dashboard-header mb-4"},[(0,i.Lk)("h2",{class:"text-primary fw-bold"},"訂單管理系統"),(0,i.Lk)("p",{class:"text-muted"},"管理所有訂單狀態與詳情")],-1)),(0,i.Lk)("div",No,[(0,i.Lk)("div",Xo,[(0,i.Lk)("div",qo,[(0,i.Lk)("div",Wo,[t[5]||(t[5]=(0,i.Lk)("span",{class:"input-group-text bg-white"},[(0,i.Lk)("i",{class:"fas fa-search text-muted"})],-1)),(0,i.bo)((0,i.Lk)("input",{type:"text",class:"form-control border-start-0",placeholder:"搜尋訂單號或用戶名","onUpdate:modelValue":t[0]||(t[0]=e=>r.searchQuery=e)},null,512),[[p.Jo,r.searchQuery]])])]),(0,i.Lk)("div",Vo,[(0,i.bo)((0,i.Lk)("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>r.selectedStatus=e),class:"form-select"},t[6]||(t[6]=[(0,i.Fv)('<option value="" data-v-50128844>所有訂單狀態</option><option value="pending" data-v-50128844>待確認</option><option value="shipped" data-v-50128844>已發貨</option><option value="completed" data-v-50128844>已完成</option><option value="cancelled" data-v-50128844>已取消</option>',5)]),512),[[p.u1,r.selectedStatus]])]),(0,i.Lk)("div",Bo,[(0,i.Lk)("button",{class:"btn btn-primary w-100",onClick:t[2]||(t[2]=(...e)=>o.filterOrders&&o.filterOrders(...e))},t[7]||(t[7]=[(0,i.Lk)("i",{class:"fas fa-filter me-2"},null,-1),(0,i.eW)("套用篩選 ")]))])])]),(0,i.Lk)("div",Ko,[(0,i.Lk)("table",Jo,[t[10]||(t[10]=(0,i.Lk)("thead",{class:"bg-light"},[(0,i.Lk)("tr",null,[(0,i.Lk)("th",{class:"py-3"},"訂單號"),(0,i.Lk)("th",{class:"py-3"},"用戶資訊"),(0,i.Lk)("th",{class:"py-3"},"總金額"),(0,i.Lk)("th",{class:"py-3"},"狀態"),(0,i.Lk)("th",{class:"py-3"},"建立日期"),(0,i.Lk)("th",{class:"py-3"},"操作")])],-1)),(0,i.Lk)("tbody",null,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(o.paginatedOrders,(e=>((0,i.uX)(),(0,i.CE)("tr",{key:e.id},[(0,i.Lk)("td",Qo,"#"+(0,u.v_)(e.id),1),(0,i.Lk)("td",jo,[(0,i.Lk)("div",zo,[(0,i.Lk)("span",Ho,(0,u.v_)(o.getUserInitials(e.user_id)),1),(0,i.Lk)("span",Go,(0,u.v_)(o.getUserName(e.user_id)),1)])]),(0,i.Lk)("td",Zo,(0,u.v_)(o.formatCurrency(e.total)),1),(0,i.Lk)("td",Yo,[(0,i.Lk)("span",{class:(0,u.C4)(o.getStatusBadgeClass(e.status))},(0,u.v_)(o.formatStatus(e.status)),3)]),(0,i.Lk)("td",en,(0,u.v_)(o.formatDate(e.order_date)),1),(0,i.Lk)("td",tn,[(0,i.Lk)("button",{class:"btn btn-outline-info btn-sm me-2",onClick:t=>o.viewOrderDetails(e)},t[8]||(t[8]=[(0,i.Lk)("i",{class:"fas fa-eye me-1"},null,-1),(0,i.eW)("查看 ")]),8,an),(0,i.bo)(((0,i.uX)(),(0,i.CE)("button",{class:"btn btn-outline-danger btn-sm",onClick:t=>o.cancelOrder(e),disabled:"cancelled"===e.status||"completed"===e.status},t[9]||(t[9]=[(0,i.Lk)("i",{class:"fas fa-times me-1"},null,-1),(0,i.eW)("取消 ")]),8,sn)),[[n,"cancelled"===e.status||"completed"===e.status?"無法取消已完成或已取消的訂單":"取消此訂單"]])])])))),128))])])]),(0,i.Lk)("div",rn,[(0,i.Lk)("div",on," 顯示第 "+(0,u.v_)(o.paginationInfo.start)+" 到 "+(0,u.v_)(o.paginationInfo.end)+" 筆，共 "+(0,u.v_)(o.filteredOrders.length)+" 筆 ",1),(0,i.Lk)("div",nn,[(0,i.Lk)("button",{class:"btn btn-outline-primary me-2",onClick:t[3]||(t[3]=(...e)=>o.prevPage&&o.prevPage(...e)),disabled:1===r.currentPage},t[11]||(t[11]=[(0,i.Lk)("i",{class:"fas fa-chevron-left me-1"},null,-1),(0,i.eW)("上一頁 ")]),8,ln),(0,i.Lk)("button",{class:"btn btn-outline-primary",onClick:t[4]||(t[4]=(...e)=>o.nextPage&&o.nextPage(...e)),disabled:r.currentPage===o.totalPages},t[12]||(t[12]=[(0,i.eW)(" 下一頁"),(0,i.Lk)("i",{class:"fas fa-chevron-right ms-1"},null,-1)]),8,cn)])])])}a(2577);var un=a(2952),pn=a.n(un),mn={name:"AdminOrders",data(){return{orders:[],users:[],searchQuery:"",selectedStatus:"",currentPage:1,itemsPerPage:10,debouncedFilter:null,loading:!1,showToast:!1,toastMessage:"",toastType:"success"}},computed:{filteredOrders(){return this.orders.filter((e=>{const t=e.user_id&&e.user_id.toString().toLowerCase().includes(this.searchQuery.toLowerCase())||e.id&&e.id.toString().toLowerCase().includes(this.searchQuery.toLowerCase()),a=!this.selectedStatus||e.status===this.selectedStatus;return t&&a}))},totalPages(){return Math.ceil(this.filteredOrders.length/this.itemsPerPage)||1},paginatedOrders(){const e=(this.currentPage-1)*this.itemsPerPage,t=this.currentPage*this.itemsPerPage;return this.filteredOrders.slice(e,t)},paginationInfo(){const e=(this.currentPage-1)*this.itemsPerPage+1,t=Math.min(this.currentPage*this.itemsPerPage,this.filteredOrders.length);return{start:e,end:t}}},methods:{async fetchOrders(){try{const e=await C.A.orderAPI.getOrders(),t=e.data;this.orders=t.map((e=>({...e,status:e.status||"pending"})))||[]}catch(e){e.response&&401===e.response.status?(alert("您的登入已過期，請重新登入。"),this.$store.dispatch("auth/logout"),this.$router.push("/UserLogin")):e.response&&403===e.response.status?(alert("您沒有權限訪問此頁面"),this.$router.push("/")):alert("加載訂單時出錯，請稍後再試"),this.orders=[]}},async fetchUsers(){try{const e=await C.A.userAPI.getAllUsers();this.users=e.data||[]}catch(e){alert("加載用戶時出錯，請稍候再試！"),this.users=[]}},viewOrderDetails(e){this.$router.push({name:"OrderDetail",params:{id:e.id}})},async cancelOrder(e){if(confirm("確定要取消這個訂單？"))try{await C.A.orderAPI.updateOrder(e.id,{status:"cancelled"}),e.status="cancelled",alert("訂單已成功取消。")}catch(t){alert("取消訂單時出錯")}},prevPage(){this.currentPage>1&&this.currentPage--},nextPage(){this.currentPage<this.totalPages&&this.currentPage++},formatCurrency(e){return new Intl.NumberFormat("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e)},formatStatus(e){const t={pending:"待確認",shipped:"已發貨",completed:"已完成",cancelled:"已取消"};return t[e]||"未知狀態"},formatDate(e){const t={year:"numeric",month:"2-digit",day:"2-digit"};return new Date(e).toLocaleDateString("zh-TW",t)},filterOrders(){this.currentPage=1},getUserName(e){const t=this.users.find((t=>t.id==e));return t?t.name:"未知用戶"},getStatusBadgeClass(e){const t={pending:"badge bg-warning text-dark",shipped:"badge bg-info text-white",completed:"badge bg-success text-white",cancelled:"badge bg-danger text-white"};return t[e]||"badge bg-secondary"},getUserInitials(e){const t=this.users.find((t=>t.id===e));return t?t.name.substring(0,2).toUpperCase():"??"},showNotification(e,t="success"){this.toastMessage=e,this.toastType=t,this.showToast=!0,setTimeout((()=>{this.showToast=!1}),3e3)}},async mounted(){try{await this.fetchOrders(),await this.fetchUsers()}catch(e){alert("獲取訂單或用戶數據時出錯，請稍後再試！")}},watch:{searchQuery(){this.debouncedFilter()},selectedStatus(){this.debouncedFilter()}}};const hn=(0,l.A)(mn,[["render",dn],["__scopeId","data-v-50128844"]]);var gn=hn;const kn={class:"container mt-5"},fn={class:"mb-3"},bn={class:"mb-3"},vn={class:"mb-3"},Ln={class:"mb-3"},yn={class:"mb-3"},wn={key:0,class:"text-danger"},Cn={class:"mb-3"},In={key:0,class:"text-danger"},Pn={class:"mb-3"},An={key:0},_n=["src"];function En(e,t,a,s,r,o){const n=(0,i.g2)("Multiselect");return(0,i.uX)(),(0,i.CE)("div",kn,[t[17]||(t[17]=(0,i.Lk)("h2",{class:"text-center mb-4"},"新增商品",-1)),(0,i.Lk)("form",{onSubmit:t[7]||(t[7]=(0,p.D$)(((...e)=>s.createProduct&&s.createProduct(...e)),["prevent"]))},[(0,i.Lk)("div",fn,[t[8]||(t[8]=(0,i.Lk)("label",{for:"productName",class:"form-label"},"商品名稱",-1)),(0,i.bo)((0,i.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>s.productForm.name=e),class:"form-control",required:""},null,512),[[p.Jo,s.productForm.name]])]),(0,i.Lk)("div",bn,[t[9]||(t[9]=(0,i.Lk)("label",{for:"description",class:"form-label"},"商品描述",-1)),(0,i.bo)((0,i.Lk)("textarea",{"onUpdate:modelValue":t[1]||(t[1]=e=>s.productForm.description=e),class:"form-control",required:""},null,512),[[p.Jo,s.productForm.description]])]),(0,i.Lk)("div",vn,[t[10]||(t[10]=(0,i.Lk)("label",{for:"price",class:"form-label"},"價格",-1)),(0,i.bo)((0,i.Lk)("input",{type:"number","onUpdate:modelValue":t[2]||(t[2]=e=>s.productForm.price=e),class:"form-control",required:""},null,512),[[p.Jo,s.productForm.price]])]),(0,i.Lk)("div",Ln,[t[11]||(t[11]=(0,i.Lk)("label",{for:"stock",class:"form-label"},"庫存",-1)),(0,i.bo)((0,i.Lk)("input",{type:"number","onUpdate:modelValue":t[3]||(t[3]=e=>s.productForm.stock=e),class:"form-control",required:""},null,512),[[p.Jo,s.productForm.stock]])]),(0,i.Lk)("div",yn,[t[12]||(t[12]=(0,i.Lk)("label",{for:"brand_id",class:"form-label"},"選擇品牌",-1)),(0,i.bF)(n,{modelValue:s.productForm.brand_id,"onUpdate:modelValue":t[4]||(t[4]=e=>s.productForm.brand_id=e),options:s.brands,searchable:!0,taggable:!0,label:"name",key:"id",valueProp:"id",placeholder:"搜尋或選擇品牌",onSelect:s.handleBrandSelect,onTag:s.createNewBrand},null,8,["modelValue","options","onSelect","onTag"]),!s.productForm.brand_id&&s.formSubmitted?((0,i.uX)(),(0,i.CE)("span",wn,"請選擇品牌")):(0,i.Q3)("",!0)]),(0,i.Lk)("div",Cn,[t[13]||(t[13]=(0,i.Lk)("label",{for:"tag_ids",class:"form-label"},"選擇標籤",-1)),(0,i.bF)(n,{modelValue:s.productForm.tag_ids,"onUpdate:modelValue":t[5]||(t[5]=e=>s.productForm.tag_ids=e),options:s.tags,searchable:!0,taggable:!0,label:"name",multiple:!0,key:"id",valueProp:"id",placeholder:"搜尋或選擇標籤",onSelect:s.handleTagSelect,onTag:s.createNewTag},null,8,["modelValue","options","onSelect","onTag"]),!s.productForm.tag_ids?.length&&s.formSubmitted?((0,i.uX)(),(0,i.CE)("span",In,"請選擇至少一個標籤")):(0,i.Q3)("",!0)]),(0,i.Lk)("div",Pn,[t[14]||(t[14]=(0,i.Lk)("label",{for:"productImage",class:"form-label"},"圖片上傳",-1)),(0,i.Lk)("input",{type:"file",class:"form-control",id:"productImage",onChange:t[6]||(t[6]=(...e)=>s.selectImage&&s.selectImage(...e)),accept:"image/*"},null,32)]),s.productForm.imagePreview?((0,i.uX)(),(0,i.CE)("div",An,[t[15]||(t[15]=(0,i.Lk)("h5",null,"圖片預覽",-1)),(0,i.Lk)("img",{src:s.productForm.imagePreview,alt:"商品圖片",style:{"max-width":"200px"}},null,8,_n)])):(0,i.Q3)("",!0),t[16]||(t[16]=(0,i.Lk)("button",{type:"submit",class:"btn btn-primary"},"新增商品",-1))],32)])}a(4603),a(7566),a(8721);var Fn=a(8074),xn={name:"CreateProduct",components:{Multiselect:Fn.Ay},setup(){const e=(0,r.rd)(),t=(0,W.Kh)({name:"",description:"",price:0,stock:0,brand_id:null,tag_ids:[],created_at:(new Date).toISOString().split("T")[0],imageFile:null,imagePreview:""}),a=()=>t.name.trim()?t.description.trim()?t.price<=0?(alert("價格必填且需大於 0"),!1):t.stock<=0?(alert("庫存必填且需大於 0"),!1):t.brand_id?!!t.tag_ids.length||(alert("請選擇至少一個標籤"),!1):(alert("請選擇品牌"),!1):(alert("商品描述必填"),!1):(alert("商品名稱必填"),!1),s=(0,W.KR)([]),o=(0,W.KR)([]),n=(0,W.KR)(!1),l=async()=>{try{const e=await C.A.brandAPI.getAllBrands();s.value=Array.isArray(e)?e:[]}catch(e){ea(e,"讀取品牌資料時出錯，請稍後再試！")}},c=async()=>{try{const e=await C.A.tagAPI.getAllTags();o.value=Array.isArray(e)?e:[]}catch(e){ea(e,"讀取標籤資料時出錯，請稍後再試！")}},d=e=>{t.brand_id=e},u=e=>{Array.isArray(e)?t.tag_ids=e:t.tag_ids=[e].filter(Boolean)},p=async e=>{try{const a=await C.A.brandAPI.createBrand(e),r=a.data;s.value.push(r),t.brand_id=r.id,alert("新品牌已添加")}catch(a){ea(a,"創建新品牌時出錯，請稍後再試！")}},m=async e=>{try{const a=await C.A.tagAPI.createTag(e),s=a.data;o.value.push(s),t.tag_ids.push(s.id),alert("新標籤已增加")}catch(a){ea(a,"創建新標籤時出錯，請稍後再試！")}};(0,i.sV)((()=>{l(),c()}));const h=async()=>{if(n.value=!0,a())if(t.brand_id&&t.tag_ids&&0!==t.tag_ids.length)try{const a=new FormData;let s=[];Array.isArray(t.tag_ids)&&(s=t.tag_ids.map((e=>"object"===typeof e?e.id:e))),a.append("name",t.name),a.append("description",t.description),a.append("price",String(t.price)),a.append("stock",String(t.stock)),a.append("brand_id","object"===typeof t.brand_id?t.brand_id.id:t.brand_id),a.append("tag_ids",JSON.stringify(s)),a.append("created_at",t.created_at),t.imageFile&&a.append("image",t.imageFile);await C.A.productAPI.createProduct(a);alert("商品新增成功"),e.push("/admin/products")}catch(s){ea(s,"新增商品時出錯，請稍後再試！")}finally{n.value=!1}else alert("請選擇品牌和至少一個標籤")},g=e=>{const a=e.target.files[0];if(a&&!a.type.startsWith("image/"))return alert("請上傳正確的圖片格式"),void(e.target.value="");t.imageFile=a,t.imagePreview=URL.createObjectURL(a)};return{productForm:t,brands:s,tags:o,formSubmitted:n,createProduct:h,selectImage:g,handleBrandSelect:d,handleTagSelect:u,validateForm:a,createNewBrand:p,createNewTag:m}}};const Sn=(0,l.A)(xn,[["render",En],["__scopeId","data-v-0117b6ca"]]);var On=Sn;const Un={class:"container mt-5"},Rn={key:0,class:"text-center my-5"},Dn={key:0,class:"text-center mb-4"},Tn=["src"],$n={class:"mb-3"},Mn={class:"mb-3"},Nn={class:"input-group"},Xn=["readonly"],qn={class:"mb-3"},Wn={class:"input-group"},Vn=["readonly"],Bn={class:"mb-3"},Kn={class:"input-group"},Jn=["readonly"],Qn={class:"mb-3"},jn={class:"input-group"},zn=["readonly"],Hn={class:"mb-3"},Gn={class:"input-group"},Zn={class:"mb-3"},Yn={class:"input-group"},el={class:"custom-tag"},tl=["onClick"];function al(e,t,a,s,r,o){const n=(0,i.g2)("Multiselect");return(0,i.uX)(),(0,i.CE)("div",Un,[t[23]||(t[23]=(0,i.Lk)("h2",{class:"text-center"},"編輯產品資訊",-1)),s.isLoading?((0,i.uX)(),(0,i.CE)("div",Rn,t[14]||(t[14]=[(0,i.Lk)("div",{class:"spinner-border text-primary",role:"status"},[(0,i.Lk)("span",{class:"visually-hidden"},"載入中...")],-1)]))):(0,i.Q3)("",!0),s.isLoading?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("form",{key:1,onSubmit:t[13]||(t[13]=(0,p.D$)(((...e)=>s.updateProduct&&s.updateProduct(...e)),["prevent"]))},[s.productForm.imagePreview?((0,i.uX)(),(0,i.CE)("div",Dn,[(0,i.Lk)("img",{src:s.productForm.imagePreview,alt:"Product Image",class:"product-image"},null,8,Tn)])):(0,i.Q3)("",!0),(0,i.Lk)("div",$n,[t[15]||(t[15]=(0,i.Lk)("label",{for:"productImage",class:"form-label"},"產品圖片",-1)),(0,i.Lk)("input",{type:"file",id:"productImage",class:"form-control",onChange:t[0]||(t[0]=(...e)=>s.selectImage&&s.selectImage(...e))},null,32)]),(0,i.Lk)("div",Mn,[t[16]||(t[16]=(0,i.Lk)("label",{for:"productName",class:"form-label"},"商品名稱",-1)),(0,i.Lk)("div",Nn,[(0,i.bo)((0,i.Lk)("input",{type:"text",id:"productName",class:"form-control","onUpdate:modelValue":t[1]||(t[1]=e=>s.productForm.name=e),readonly:!s.editableFields.name,required:""},null,8,Xn),[[p.Jo,s.productForm.name]]),(0,i.Lk)("button",{type:"button",class:"btn btn-outline-secondary",onClick:t[2]||(t[2]=e=>s.toggleEdit("name"))},(0,u.v_)(s.editableFields.name?"完成":"修改"),1)])]),(0,i.Lk)("div",qn,[t[17]||(t[17]=(0,i.Lk)("label",{for:"productPrice",class:"form-label"},"價格",-1)),(0,i.Lk)("div",Wn,[(0,i.bo)((0,i.Lk)("input",{type:"number",id:"productPrice",class:"form-control","onUpdate:modelValue":t[3]||(t[3]=e=>s.productForm.price=e),readonly:!s.editableFields.price,required:""},null,8,Vn),[[p.Jo,s.productForm.price]]),(0,i.Lk)("button",{type:"button",class:"btn btn-outline-secondary",onClick:t[4]||(t[4]=e=>s.toggleEdit("price"))},(0,u.v_)(s.editableFields.price?"完成":"修改"),1)])]),(0,i.Lk)("div",Bn,[t[18]||(t[18]=(0,i.Lk)("label",{for:"productStock",class:"form-label"},"庫存",-1)),(0,i.Lk)("div",Kn,[(0,i.bo)((0,i.Lk)("input",{type:"number",id:"productStock",class:"form-control","onUpdate:modelValue":t[5]||(t[5]=e=>s.productForm.stock=e),readonly:!s.editableFields.stock,required:""},null,8,Jn),[[p.Jo,s.productForm.stock]]),(0,i.Lk)("button",{type:"button",class:"btn btn-outline-secondary",onClick:t[6]||(t[6]=e=>s.toggleEdit("stock"))},(0,u.v_)(s.editableFields.stock?"完成":"修改"),1)])]),(0,i.Lk)("div",Qn,[t[19]||(t[19]=(0,i.Lk)("label",{for:"productDescription",class:"form-label"},"描述",-1)),(0,i.Lk)("div",jn,[(0,i.bo)((0,i.Lk)("textarea",{type:"number",id:"productDescription",class:"form-control","onUpdate:modelValue":t[7]||(t[7]=e=>s.productForm.description=e),readonly:!s.editableFields.description,required:""},null,8,zn),[[p.Jo,s.productForm.description]]),(0,i.Lk)("button",{type:"button",class:"btn btn-outline-secondary",onClick:t[8]||(t[8]=e=>s.toggleEdit("description"))},(0,u.v_)(s.editableFields.description?"完成":"修改"),1)])]),(0,i.Lk)("div",Hn,[t[20]||(t[20]=(0,i.Lk)("label",{for:"productBrand",class:"form-label"},"廠牌",-1)),(0,i.Lk)("div",Gn,[(0,i.bF)(n,{modelValue:s.productForm.brand_id,"onUpdate:modelValue":t[9]||(t[9]=e=>s.productForm.brand_id=e),options:s.brands,searchable:!0,label:"name","value-prop":"id",placeholder:"請選擇廠牌",disabled:!s.editableFields.brand_id,required:""},null,8,["modelValue","options","disabled"]),(0,i.Lk)("button",{type:"button",class:"btn btn-outline-secondary",onClick:t[10]||(t[10]=e=>s.toggleEdit("brand_id"))},(0,u.v_)(s.editableFields.brand_id?"完成":"修改"),1)])]),(0,i.Lk)("div",Zn,[t[21]||(t[21]=(0,i.Lk)("label",{for:"productTags",class:"form-label"},"標籤",-1)),(0,i.Lk)("div",Yn,[(0,i.bF)(n,{modelValue:s.productForm.tag_ids,"onUpdate:modelValue":t[11]||(t[11]=e=>s.productForm.tag_ids=e),options:s.tags,label:"name","value-prop":"id",placeholder:"請選擇標籤",disabled:!s.editableFields.tag_ids,required:"",multiple:""},{tag:(0,i.k6)((({option:e,remove:t})=>[(0,i.Lk)("span",el,[(0,i.eW)((0,u.v_)(e.name)+" ",1),(0,i.Lk)("button",{type:"button",onClick:a=>t(e)}," X ",8,tl)])])),_:1},8,["modelValue","options","disabled"]),(0,i.Lk)("button",{type:"button",class:"btn btn-outline-secondary",onClick:t[12]||(t[12]=e=>s.toggleEdit("tag_ids"))},(0,u.v_)(s.editableFields.tag_ids?"完成":"修改"),1)])]),t[22]||(t[22]=(0,i.Lk)("button",{type:"submit",class:"btn btn-primary"},"更新產品",-1))],32))])}var sl=a(4014),rl={name:"EditProduct",components:{Multiselect:sl.A},setup(){const e=(0,r.rd)(),t=(0,r.lq)(),a=t.params.id,s=(0,W.KR)(!0),o=(0,W.Kh)({name:!1,price:!1,stock:!1,description:!1,brand_id:!1,tag_ids:!1}),n=e=>{o[e]=!o[e]},l=(0,W.Kh)({name:"",description:"",price:0,stock:0,brand_id:null,tag_ids:[],imageFile:null,imagePreview:""}),c=(0,W.KR)([]),d=(0,W.KR)([]),u=async()=>{try{s.value=!0;const[e,t,r]=await Promise.all([axios.get(`/api/products/${a}`),axios.get("/api/brands"),axios.get("/api/tags")]);c.value=t.data,d.value=r.data;const i=e.data;l.name=i.name,l.description=i.description,l.price=i.price,l.stock=i.stock,l.imagePreview=i.image?`/${i.image}`:"",i.brand_id&&(l.brand_id=Number(i.brand_id)),i.tag_ids&&Array.isArray(i.tag_ids)&&(l.tag_ids=i.tag_ids.map((e=>Number(e))))}catch(e){alert("加載商品訊息時出錯，請稍後再試！")}finally{s.value=!1}},p=async()=>{try{if(!l.name)return void alert("請填寫商品名稱");if(!l.description)return void alert("請填寫商品描述");if(!l.price||isNaN(l.price))return void alert("請填寫有效的商品價格");if(!l.stock||isNaN(l.stock))return void alert("請填寫有效的商品庫存");if(!l.brand_id||isNaN(l.brand_id))return void alert("請選擇一個有效的廠牌");const t=new FormData;t.append("name",l.name),t.append("description",l.description),t.append("price",l.price),t.append("stock",l.stock),t.append("brand_id",l.brand_id),t.append("tag_ids",JSON.stringify(l.tag_ids)),l.imageFile&&t.append("image",l.imageFile),await ApiService.productAPI.updateProduct(a,t),alert("更新商品成功！"),e.push({name:"AdminProducts"})}catch(t){alert("更新商品時出錯，請稍後再試！")}},m=e=>{const t=e.target.files[0];t&&(l.imageFile=t,l.imagePreview=URL.createObjectURL(t))};return(0,i.sV)((async()=>{await u()})),{productForm:l,brands:c,tags:d,isLoading:s,editableFields:o,toggleEdit:n,updateProduct:p,selectImage:m}}};const il=(0,l.A)(rl,[["render",al]]);var ol=il;function nl(e,t,a,s,r,o){return(0,i.uX)(),(0,i.CE)("h5",null,"AdminContact")}var ll={name:"AdminContact"};const cl=(0,l.A)(ll,[["render",nl]]);var dl=cl;const ul={class:"order-detail container mt-5"},pl={key:0},ml={class:"order-info mb-4"},hl={class:"mb-3"},gl={class:"table table-bordered"},kl={key:1};function fl(e,t,a,s,r,o){return(0,i.uX)(),(0,i.CE)("div",ul,[t[13]||(t[13]=(0,i.Lk)("h2",{class:"text-center"},"訂單詳情",-1)),r.order?((0,i.uX)(),(0,i.CE)("div",pl,[(0,i.Lk)("div",ml,[(0,i.Lk)("p",null,[t[3]||(t[3]=(0,i.Lk)("strong",null,"訂單號：",-1)),(0,i.eW)((0,u.v_)(r.order.id),1)]),(0,i.Lk)("p",null,[t[4]||(t[4]=(0,i.Lk)("strong",null,"會員編號：",-1)),(0,i.eW)((0,u.v_)(r.order.user_id),1)]),(0,i.Lk)("p",null,[t[5]||(t[5]=(0,i.Lk)("strong",null,"用戶名：",-1)),(0,i.eW)((0,u.v_)(r.userName),1)]),(0,i.Lk)("p",null,[t[6]||(t[6]=(0,i.Lk)("strong",null,"建立日期：",-1)),(0,i.eW)((0,u.v_)(o.formatDate(r.order.created_at)),1)]),(0,i.Lk)("p",null,[t[7]||(t[7]=(0,i.Lk)("strong",null,"總金額：",-1)),(0,i.eW)((0,u.v_)(o.formatCurrency(r.order.total)),1)]),(0,i.Lk)("div",hl,[t[9]||(t[9]=(0,i.Lk)("label",{for:"orderStatus",class:"form-label"},[(0,i.Lk)("strong",null,"訂單狀態：")],-1)),(0,i.bo)((0,i.Lk)("select",{id:"orderStatus","onUpdate:modelValue":t[0]||(t[0]=e=>r.order.status=e),class:"form-select",onChange:t[1]||(t[1]=(...e)=>o.updateOrderStatus&&o.updateOrderStatus(...e))},t[8]||(t[8]=[(0,i.Lk)("option",{value:"pending"},"待確認",-1),(0,i.Lk)("option",{value:"shipped"},"已發貨",-1),(0,i.Lk)("option",{value:"completed"},"已完成",-1),(0,i.Lk)("option",{value:"cancelled"},"已取消",-1)]),544),[[p.u1,r.order.status]])])]),t[11]||(t[11]=(0,i.Lk)("h4",null,"商品列表",-1)),(0,i.Lk)("table",gl,[t[10]||(t[10]=(0,i.Lk)("thead",null,[(0,i.Lk)("tr",null,[(0,i.Lk)("th",null,"商品名稱"),(0,i.Lk)("th",null,"數量"),(0,i.Lk)("th",null,"單價"),(0,i.Lk)("th",null,"小計")])],-1)),(0,i.Lk)("tbody",null,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(r.order.items,(e=>((0,i.uX)(),(0,i.CE)("tr",{key:e.productId},[(0,i.Lk)("td",null,(0,u.v_)(e.product_name),1),(0,i.Lk)("td",null,(0,u.v_)(e.quantity),1),(0,i.Lk)("td",null,(0,u.v_)(o.formatCurrency(e.price)),1),(0,i.Lk)("td",null,(0,u.v_)(o.formatCurrency(e.price*e.quantity)),1)])))),128))])]),(0,i.Lk)("button",{class:"btn btn-secondary mt-3",onClick:t[2]||(t[2]=(...e)=>o.goBack&&o.goBack(...e))},"返回")])):((0,i.uX)(),(0,i.CE)("div",kl,t[12]||(t[12]=[(0,i.Lk)("p",null,"正在加載訂單詳情...",-1)])))])}var bl={name:"OrderDetail",props:["id"],data(){return{order:null,userName:"",store:(0,w.Pj)()}},methods:{async fetchOrderDetails(e){try{const t=await C.A.orderAPI.getOrderById(e);this.order=t||t.data,await this.fetchUserName(this.order.user_id)}catch(t){this.store.dispatch("notification/showNotification",{type:"error",message:"加載訂單詳情時出錯，請稍候再試！",timeout:2e3})}},async fetchUserName(e){try{const t=await C.A.userAPI.getUserInfo(e),a=t.data||t;this.userName=a.name||"未知用戶"}catch(t){this.userName="未知用戶"}},formatCurrency(e){return new Intl.NumberFormat("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e)},formatDate(e){const t={year:"numeric",month:"2-digit",day:"2-digit"};return new Date(e).toLocaleDateString("zh-TW",t)},async updateOrderStatus(){if(this.order)try{const e=await C.A.orderAPI.updateOrder(this.order.id,{status:this.order.status});if(!e.success)throw new Error(e.message||"訂單狀態更新失敗");this.order={...this.order,...e.data},this.store.dispatch("notifications/showNotification",{message:"訂單狀態已更新",type:"success",timeout:3e3})}catch(e){this.store.dispatch("notifications/showNotification",{type:"error",message:"更新訂單狀態時出錯，請稍後再試！",timeout:2e3})}},goBack(){this.$router.go(-1)}},mounted(){const e=this.id||this.$route.params.id;this.fetchOrderDetails(e)}};const vl=(0,l.A)(bl,[["render",fl],["__scopeId","data-v-abc0d824"]]);var Ll=vl;const yl={class:"carousel-management container mt-5"},wl={class:"image-grid mb-4"},Cl={class:"image-wrapper"},Il=["src","onLoad","onError"],Pl={class:"image-overlay"},Al={class:"action-buttons"},_l=["onClick"],El=["onClick"],Fl={class:"image-status mt-2"},xl={class:"upload-section p-4 bg-light rounded-3"},Sl={key:0,class:"preview-section mt-4"},Ol={class:"preview-container"},Ul=["src"],Rl={class:"preview-actions mt-3"};function Dl(e,t,a,s,r,o){return(0,i.uX)(),(0,i.CE)("div",yl,[t[12]||(t[12]=(0,i.Lk)("div",{class:"dashboard-header mb-4"},[(0,i.Lk)("h2",{class:"text-primary fw-bold"},"輪播圖片管理"),(0,i.Lk)("p",{class:"text-muted"},"管理網站首頁輪播圖片的顯示與排序")],-1)),(0,i.Lk)("div",wl,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(r.carouselImages,((a,s)=>((0,i.uX)(),(0,i.CE)("div",{key:a.id,class:"image-card"},[(0,i.Lk)("div",Cl,[(0,i.Lk)("img",{src:e.$getImageUrl(a.url,"carousel"),onLoad:e=>o.onImgLoad(e,s),onError:e=>o.onImgError(e,s),class:"carousel-image",alt:"輪播圖片"},null,40,Il),(0,i.Lk)("div",Pl,[(0,i.Lk)("div",Al,[(0,i.Lk)("button",{class:(0,u.C4)(["btn btn-light btn-sm me-2",{active:a.visible}]),onClick:e=>o.toggleImageVisibility(a)},[(0,i.Lk)("i",{class:(0,u.C4)(a.visible?"fas fa-eye":"fas fa-eye-slash")},null,2),(0,i.eW)(" "+(0,u.v_)(a.visible?"隱藏":"顯示"),1)],10,_l),(0,i.Lk)("button",{class:"btn btn-danger btn-sm",onClick:e=>o.deleteCarouselImage(a.id)},t[6]||(t[6]=[(0,i.Lk)("i",{class:"fas fa-trash-alt me-1"},null,-1),(0,i.eW)(" 刪除 ")]),8,El)])])]),(0,i.Lk)("div",Fl,[(0,i.Lk)("span",{class:(0,u.C4)(["status-badge",a.visible?"status-active":"status-inactive"])},(0,u.v_)(a.visible?"顯示中":"已隱藏"),3)])])))),128))]),(0,i.Lk)("div",xl,[t[11]||(t[11]=(0,i.Lk)("h4",{class:"mb-3"},[(0,i.Lk)("i",{class:"fas fa-cloud-upload-alt me-2"}),(0,i.eW)(" 上傳新圖片 ")],-1)),(0,i.Lk)("div",{class:(0,u.C4)(["upload-area",{dragging:r.isDragging}]),onDragover:t[2]||(t[2]=(0,p.D$)((()=>{}),["prevent"])),onDrop:t[3]||(t[3]=(0,p.D$)(((...e)=>o.handleFileDrop&&o.handleFileDrop(...e)),["prevent"]))},[(0,i.Lk)("input",{type:"file",onChange:t[0]||(t[0]=(...e)=>o.handleFileSelect&&o.handleFileSelect(...e)),accept:"image/*",ref:"fileInput",class:"d-none"},null,544),(0,i.Lk)("div",{class:"upload-placeholder",onClick:t[1]||(t[1]=t=>e.$refs.fileInput.click())},t[7]||(t[7]=[(0,i.Lk)("i",{class:"fas fa-plus-circle fs-2 mb-2"},null,-1),(0,i.Lk)("p",{class:"mb-1"},"點擊或拖曳圖片至此處上傳",-1),(0,i.Lk)("small",{class:"text-muted"},"支援 JPG、PNG、GIF 格式，檔案大小不超過 5MB",-1)]))],34),r.previewUrl?((0,i.uX)(),(0,i.CE)("div",Sl,[t[10]||(t[10]=(0,i.Lk)("h5",{class:"mb-3"},"預覽圖片",-1)),(0,i.Lk)("div",Ol,[(0,i.Lk)("img",{src:r.previewUrl,alt:"預覽圖片",class:"preview-image"},null,8,Ul),(0,i.Lk)("div",Rl,[(0,i.Lk)("button",{class:"btn btn-primary me-2",onClick:t[4]||(t[4]=(...e)=>o.confirmUpload&&o.confirmUpload(...e))},t[8]||(t[8]=[(0,i.Lk)("i",{class:"fas fa-check me-1"},null,-1),(0,i.eW)("確認上傳 ")])),(0,i.Lk)("button",{class:"btn btn-outline-secondary",onClick:t[5]||(t[5]=(...e)=>o.cancelUpload&&o.cancelUpload(...e))},t[9]||(t[9]=[(0,i.Lk)("i",{class:"fas fa-times me-1"},null,-1),(0,i.eW)("取消 ")]))])])])):(0,i.Q3)("",!0)]),r.showToast?((0,i.uX)(),(0,i.CE)("div",{key:0,class:(0,u.C4)(["toast-notification",`toast-${r.toastType}`])},(0,u.v_)(r.toastMessage),3)):(0,i.Q3)("",!0)])}var Tl={name:"AdminCarouselImages",data(){return{carouselImages:[],selectedFile:null,previewUrl:"",isDragging:!1,showToast:!1,toastMessage:"",toastType:"success"}},async mounted(){await this.loadCarouselImages()},methods:{async loadCarouselImages(){try{const e=await C.A.carouselAPI.getCarouselImages();this.carouselImages=e,this.carouselImages.forEach(((e,t)=>{}))}catch(e){ea(e,"加載輪播圖片失敗")}},async confirmUpload(){if(!this.selectedFile)return void alert("沒有選擇任何文件！");const e=new FormData;e.append("image",this.selectedFile);try{const t=await C.A.carouselAPI.uploadCarouselImages(e);this.carouselImages.push(t),alert("圖片上傳成功"),this.resetUpload()}catch(t){ea(t,"圖片上傳失敗")}},cancelUpload(){this.resetUpload()},resetUpload(){this.selectedFile=null,this.previewUrl="",this.$refs.fileInput.value=""},async deleteCarouselImage(e){if(confirm("確定要刪除這張圖片嗎？"))try{await C.A.carouselAPI.deleteCarouselImage(e),this.carouselImages=this.carouselImages.filter((t=>t.id!==e)),alert("圖片已刪除。")}catch(t){ea(t,"圖片刪除失敗")}},async toggleImageVisibility(e){const t=!e.visible;try{const a=await C.A.carouselAPI.updateCarouselImage(e.id,{visible:t});e.visible=a.visible,alert(`圖片已${t?"顯示":"隱藏"}。`)}catch(a){ea(a,"更新圖片狀態失敗")}},onImgLoad(e,t){},onImgError(e,t){e.target.onerror=null,e.target.src="https://ecshop-backend.onrender.com/api".replace(/\/$/,"")+"/img/wrong.png"},handleFile(e){const t=["image/jpeg","image/png","image/gif"],a=5242880;t.includes(e.type)?e.size>a?alert("圖片大小不可超過5MB!"):(this.selectedFile=e,this.previewUrl=URL.createObjectURL(e)):alert("僅支援 JPEG, PNG, GIF格式的圖片!")},handleFileDrop(e){this.isDragging=!1;const t=e.dataTransfer.files[0];t&&this.handleFile(t)},handleFileSelect(e){const t=e.target.files[0];t&&this.handleFile(t)},showNotification(e,t="success"){this.toastMessage=e,this.toastType=t,this.showToast=!0,setTimeout((()=>{this.showToast=!1}),3e3)}}};const $l=(0,l.A)(Tl,[["render",Dl],["__scopeId","data-v-056934bb"]]);var Ml=$l;const Nl={class:"special-offers-dashboard container mt-5"},Xl={class:"d-flex justify-content-end mb-3"},ql={class:"accordion",id:"specialOffersAccordion"},Wl={class:"accordion-item"},Vl={id:"collapseSpecialOffers",class:"accordion-collapse collapse show","aria-labelledby":"headingSpecialOffers","data-bs-parent":"#specialOffersAccordion"},Bl={class:"accordion-body"},Kl={class:"table"},Jl=["onClick"],Ql=["onClick"],jl={class:"modal fade",tabindex:"-1",ref:"specialOfferModal"},zl={class:"modal-dialog"},Hl={class:"modal-content"},Gl={class:"modal-header"},Zl={class:"modal-title"},Yl={class:"modal-body"},ec={class:"mb-3"},tc={key:0,class:"list-group mt-2"},ac=["onClick"],sc={key:1,class:"mt-2"},rc={class:"mb-3"},ic={class:"mb-3"},oc={class:"mb-3"},nc={class:"mb-3"},lc={class:"modal-footer"};function cc(e,t,a,s,r,o){return(0,i.uX)(),(0,i.CE)("div",Nl,[t[19]||(t[19]=(0,i.Lk)("h2",{class:"text-center"},"特價商品管理",-1)),(0,i.Lk)("div",Xl,[(0,i.Lk)("button",{class:"btn btn-success",onClick:t[0]||(t[0]=(...e)=>o.openCreateSpecialOfferModal&&o.openCreateSpecialOfferModal(...e))},"新增特價商品")]),(0,i.Lk)("div",ql,[(0,i.Lk)("div",Wl,[t[12]||(t[12]=(0,i.Lk)("h2",{class:"accordion-header",id:"headingSpecialOffers"},[(0,i.Lk)("button",{class:"accordion-button collapsed",type:"button","data-bs-toggle":"collapse","data-bs-target":"#collapseSpecialOffers","aria-expanded":"true","aria-controls":"collapseSpecialOffers"}," 特價商品管理 ")],-1)),(0,i.Lk)("div",Vl,[(0,i.Lk)("div",Bl,[(0,i.Lk)("table",Kl,[t[11]||(t[11]=(0,i.Lk)("thead",null,[(0,i.Lk)("tr",null,[(0,i.Lk)("th",null,"商品名稱"),(0,i.Lk)("th",null,"特價價格"),(0,i.Lk)("th",null,"倒數時間 (秒)"),(0,i.Lk)("th",null,"創建日期"),(0,i.Lk)("th",null,"操作")])],-1)),(0,i.Lk)("tbody",null,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(r.specialOffers,((e,t)=>((0,i.uX)(),(0,i.CE)("tr",{key:e?.id},[(0,i.Lk)("td",null,(0,u.v_)(o.getProductName(e.product_id)),1),(0,i.Lk)("td",null,(0,u.v_)(e.price),1),(0,i.Lk)("td",null,(0,u.v_)(o.formatTime(e.countdown)),1),(0,i.Lk)("td",null,(0,u.v_)(o.formatDate(e.created_at)),1),(0,i.Lk)("td",null,[(0,i.Lk)("button",{class:"btn btn-warning btn-sm me-2",onClick:e=>o.openEditSpecialOfferModal(t)},"編輯",8,Jl),(0,i.Lk)("button",{class:"btn btn-danger btn-sm",onClick:a=>o.deleteSpecialOffer(e.id,t)},"刪除",8,Ql)])])))),128))])])])])])]),(0,i.Lk)("div",jl,[(0,i.Lk)("div",zl,[(0,i.Lk)("div",Hl,[(0,i.Lk)("div",Gl,[(0,i.Lk)("h5",Zl,(0,u.v_)(r.isEditing?"編輯特價商品":"新增特價商品"),1),(0,i.Lk)("button",{type:"button",class:"btn-close",onClick:t[1]||(t[1]=(...e)=>o.closeSpecialOfferModal&&o.closeSpecialOfferModal(...e))})]),(0,i.Lk)("div",Yl,[(0,i.Lk)("div",ec,[t[14]||(t[14]=(0,i.Lk)("label",{for:"productSelect",class:"form-label"},"搜尋商品名稱",-1)),(0,i.bo)((0,i.Lk)("input",{type:"text",id:"productSearch",class:"form-control","onUpdate:modelValue":t[2]||(t[2]=e=>r.productSearchKeyword=e),onInput:t[3]||(t[3]=(...t)=>e.debouncedSearchProducts&&e.debouncedSearchProducts(...t)),required:""},null,544),[[p.Jo,r.productSearchKeyword]]),r.searchResults&&r.searchResults.length>0?((0,i.uX)(),(0,i.CE)("ul",tc,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(r.searchResults,(e=>((0,i.uX)(),(0,i.CE)("li",{class:"list-group-item list-group-item-action",key:e.id,onClick:t=>o.selectProduct(e)},(0,u.v_)(e.name),9,ac)))),128))])):(0,i.Q3)("",!0),r.selectedProduct?((0,i.uX)(),(0,i.CE)("div",sc,[t[13]||(t[13]=(0,i.Lk)("strong",null,"已選擇商品：",-1)),(0,i.eW)((0,u.v_)(r.selectedProduct.name)+" ",1),(0,i.Lk)("button",{type:"button",class:"btn btn-sm btn-outline-danger ms-2",onClick:t[4]||(t[4]=(...e)=>o.clearSelectedProduct&&o.clearSelectedProduct(...e))},"移除")])):(0,i.Q3)("",!0)]),(0,i.Lk)("div",rc,[t[15]||(t[15]=(0,i.Lk)("label",{for:"priceInput",class:"form-label"},"特價價格",-1)),(0,i.bo)((0,i.Lk)("input",{type:"number",id:"priceInput","onUpdate:modelValue":t[5]||(t[5]=e=>r.specialOfferForm.price=e),class:"form-control",placeholder:"請輸入特價價格",required:""},null,512),[[p.Jo,r.specialOfferForm.price]])]),(0,i.Lk)("div",ic,[t[16]||(t[16]=(0,i.Lk)("label",{for:"createdAtInput",class:"form-label"},"創建日期",-1)),(0,i.bo)((0,i.Lk)("input",{type:"date",id:"createdAtInput","onUpdate:modelValue":t[6]||(t[6]=e=>r.specialOfferForm.created_at=e),class:"form-control",required:""},null,512),[[p.Jo,r.specialOfferForm.created_at]])]),(0,i.Lk)("div",oc,[t[17]||(t[17]=(0,i.Lk)("label",{for:"startTimeInput",class:"form-label"},"開始時間",-1)),(0,i.bo)((0,i.Lk)("input",{type:"datetime-local",id:"startTimeInput","onUpdate:modelValue":t[7]||(t[7]=e=>r.specialOfferForm.start_time=e),class:"form-control",required:""},null,512),[[p.Jo,r.specialOfferForm.start_time]])]),(0,i.Lk)("div",nc,[t[18]||(t[18]=(0,i.Lk)("label",{for:"durationInput",class:"form-label"},"持續時間 (秒)",-1)),(0,i.bo)((0,i.Lk)("input",{type:"number",id:"durationInput","onUpdate:modelValue":t[8]||(t[8]=e=>r.specialOfferForm.duration=e),class:"form-control",placeholder:"請輸入持續時間",required:""},null,512),[[p.Jo,r.specialOfferForm.duration]])])]),(0,i.Lk)("div",lc,[(0,i.Lk)("button",{type:"button",class:"btn btn-secondary",onClick:t[9]||(t[9]=(...e)=>o.closeSpecialOfferModal&&o.closeSpecialOfferModal(...e))},"取消"),(0,i.Lk)("button",{type:"button",class:"btn btn-primary",onClick:t[10]||(t[10]=(...e)=>o.saveSpecialOffer&&o.saveSpecialOffer(...e))},(0,u.v_)(r.isEditing?"保存變更":"新增特價商品"),1)])])])],512)])}var dc={name:"SpecialOffers",data(){return{specialOffers:[],products:[],productMap:{},specialOfferForm:{product_id:"",price:"",start_time:"",duration:"",created_at:(new Date).toISOString().split("T")[0]},isEditing:!1,currentIndex:null,productSearchKeyword:"",searchResults:[],selectedProduct:null,countdownIntervals:[]}},mounted(){this.loadSpecialOffers(),this.loadProducts(),this.debouncedSearchProducts=pn()(this.searchProducts,500)},beforeUnmount(){this.clearCountdownIntervals()},methods:{async loadSpecialOffers(){try{const e=await C.A.specialOffersAPI.getAllSpecialOffers();this.specialOffers=e.map((e=>({...e,countdown:Math.floor((new Date(e.start_time).getTime()+1e3*e.duration-Date.now())/1e3)}))),this.startCountdown()}catch(e){ea(e,"加載特價商品時出錯，請稍後再試！")}},async searchProducts(){const e=this.productSearchKeyword.trim();if(e)try{const t=await C.A.productAPI.searchProducts({keyword:e,page:1,limit:10});this.searchResults=t}catch(t){ea(t,"搜尋商品時出錯，請稍後再試！")}else this.searchResults=[]},selectProduct(e){this.selectedProduct=e,this.specialOfferForm.product_id=e.id,this.searchResults=[],this.productSearchKeyword=""},clearSelectedProduct(){this.selectedProduct=null,this.specialOfferForm.product_id=""},async loadProducts(){try{const e=await C.A.productAPI.getAllProducts();this.products=e,this.productMap={},e.forEach((e=>{this.productMap[e.id]=e.name}))}catch(e){ea(e,"加載商品時出錯，請稍後再試！")}},formatDate(e){const t=new Date(e);return t.toLocaleDateString()},openCreateSpecialOfferModal(){this.isEditing=!1,this.specialOfferForm={id:null,product_id:"",price:0,countdown:0,created_at:""},this.selectedProduct=null,this.productSearchKeyword="",this.searchResults=[],this.$nextTick((()=>{const e=new Yt.aF(this.$refs.specialOfferModal);e.show()}))},async openEditSpecialOfferModal(e){this.isEditing=!0,this.currentIndex=e;const t={...this.specialOffers[e]};this.specialOfferForm=t;try{const e=await C.A.specialOffersAPI.getSpecialOfferById(t.id);this.selectedProduct=e}catch(a){ea(a,"取得商品資訊時出錯，請稍後再試！")}this.productSearchKeyword="",this.searchResults=[],this.$nextTick((()=>{const e=new Yt.aF(this.$refs.specialOfferModal);e.show()}))},getProductName(e){return this.productMap[e]||"未知商品"},closeSpecialOfferModal(){const e=Yt.aF.getInstance(this.$refs.specialOfferModal);e&&e.hide()},async saveSpecialOffer(){if(this.specialOfferForm.product_id&&void 0!==this.specialOfferForm.price&&""!==this.specialOfferForm.price&&this.specialOfferForm.start_time&&void 0!==this.specialOfferForm.duration&&""!==this.specialOfferForm.duration)try{const e={product_id:parseInt(this.specialOfferForm.product_id),price:parseFloat(this.specialOfferForm.price),start_time:new Date(this.specialOfferForm.start_time).toISOString().slice(0,19).replace("T"," "),duration:parseInt(this.specialOfferForm.duration)};this.isEditing?(await C.A.specialOffersAPI.updateSpecialOfferById(this.editingId,e),alert("特價商品已更新！")):(await C.A.specialOffersAPI.createSpecialOffer(e),alert("特價商品已新增！"),this.closeSpecialOfferModal(),this.loadSpecialOffers(),this.$store.dispatch("notifications/showNotification",{type:"success",message:this.isEditing?"特價商品已更新！":"特價商品已新增！",timeout:3e3})),this.closeSpecialOfferModal()}catch(e){ea(e,"保存特價商品時出錯，請稍後再試！"),this.$store.dispatch("notifications/showNotification",{type:"error",message:"保存失敗，請稍後再試！",timeout:2e3})}else alert("請填寫所有必填欄位！")},async deleteSpecialOffer(e,t){if(confirm("確定要刪除此特價商品？"))try{await C.A.specialOffersAPI.deleteSpecialOffer(e),this.specialOffers.splice(t,1),alert("特價商品已刪除！")}catch(a){ea(a,"刪除特價商品時出錯，請稍後再試！")}},startCountdown(){this.clearCountdownIntervals(),this.specialOffers&&0!==this.specialOffers.length&&this.specialOffers.forEach(((e,t)=>{if(e.countdown<=0)return;const a=setInterval((()=>{this.specialOffers[t].countdown>0?this.specialOffers[t].countdown-=1:clearInterval(a)}),1e3);this.countdownIntervals.push(a)}))},clearCountdownIntervals(){this.countdownIntervals.forEach((e=>clearInterval(e))),this.countdownIntervals=[]},formatTime(e){const t=Math.floor(e/3600),a=Math.floor(e%3600/60),s=e%60;return`${t.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}`},formatDate(e){const t=new Date(e),a=t.getFullYear(),s=`0${t.getMonth()+1}`.slice(-2),r=`0${t.getDate()}`.slice(-2);return`${a}-${s}-${r}`}}};const uc=(0,l.A)(dc,[["render",cc],["__scopeId","data-v-707c0d6e"]]);var pc=uc;const mc=(0,r.aE)({history:(0,r.Bt)("/ECshop"),routes:[{path:"/",name:"HomePage",component:()=>Promise.resolve().then(a.bind(a,69))},{path:"/admin",name:"AdminDashBoard",component:mr,meta:{requiresAuth:!0,role:"admin"}},{path:"/admin/Products",name:"AdminProducts",component:Ei,meta:{requiresAuth:!0,role:"admin"}},{path:"/admin/Users",name:"AdminUsers",component:$o,meta:{requiresAuth:!0,role:"admin"}},{path:"/admin/Orders",name:"AdminOrders",component:gn,meta:{requiresAuth:!0,role:"admin"}},{path:"/admin/Orders/:id(\\d+)",name:"OrderDetail",component:Ll,props:!0,meta:{requiresAuth:!0,role:"admin"}},{path:"/admin/CreateProduct",name:"CreateProduct",component:On,meta:{requiresAuth:!0,role:"admin"}},{path:"/admin/EditProduct/:id",name:"EditProduct",component:ol,meta:{requiresAuth:!0,role:"admin"}},{path:"/admin/AdminContact",name:"AdminContact",component:dl,meta:{requiresAuth:!0,role:"admin"}},{path:"/admin/CarouselImages",name:"CarouselImages",component:Ml,meta:{requiresAuth:!0,role:"admin"}},{path:"/admin/SpecialOffers",name:"SpecialOffers",component:pc,meta:{requiresAuth:!0,role:"admin"}},{path:"/ShopCart",name:"ShopCart",component:A,meta:{requiresAuth:!0}},{path:"/ProductsList",name:"ProductsList",component:te},{path:"/MembersPage",name:"MembersPage",component:ia,meta:{requiresAuth:!0}},{path:"/AboutUsPage",name:"AboutUsPage",component:d},{path:"/ContactUs",name:"ContactUs",component:ga},{path:"/SearchResults",name:"SearchResults",component:va},{path:"/UserRegister",name:"UserRegister",component:Ba},{path:"/UserLogin",name:"UserLogin",component:ss},{path:"/ForgotPwd",name:"ForgotPwd",component:ds},{path:"/ProductDetail/:id",name:"ProductDetail",component:Ue},{path:"/Order-Confirmation/:orderId",name:"OrderConfirmation",component:bs},{path:"/:pathMatch(.*)*",redirect:"/"}]});mc.beforeEach((async(e,t,a)=>{const r=!!localStorage.getItem("authToken");JSON.parse(localStorage.getItem("user"));if("/UserLogin"===e.path)return r?a({path:"/"}):a();if(r)try{const t=await s.A.dispatch("auth/checkAuthStatus");return!t&&e.meta.requiresAuth&&a({path:"/UserLogin",query:{redirect:e.fullPath}}),a()}catch(i){return a({path:"/UserLogin",query:{redirect:e.fullPath}})}if(e.meta.requiresAuth&&!r)return a({path:"/UserLogin",query:{redirect:e.fullPath}});a()}));var hc=mc},4300:function(e,t,a){var s=a(5720),r=a(4373);const i={setHeader(e,t){s.A.defaults.headers.common[e]=t},userAPI:{getAllUsers:()=>s.A.get("/users"),login:e=>s.A.post("/users/login",e),register:e=>s.A.post("/users/register",e),getUserInfo:e=>s.A.get(`/users/${e}`),updateUser:(e,t)=>s.A.put(`/users/${e}`,t)},productAPI:{getProducts:e=>s.A.get("/products",{params:e}),getProductById:e=>s.A.get(`/products/${e}`),createProduct:e=>s.A.post("/products",e),updateProduct:(e,t)=>s.A.put(`/products/${e}`,t),deleteProduct:e=>s.A.delete(`/products/${e}`),getAllProducts:()=>s.A.get("/products"),searchProducts:e=>s.A.get("/products/search",{params:e})},tagAPI:{getAllTags:()=>s.A.get("/tags"),createTag:e=>s.A.post("/tags",e),updateTag:(e,t)=>s.A.put(`/tags/${e}`,t),deleteTag:e=>s.A.delete(`/tags/${e}`)},brandAPI:{getAllBrands:()=>s.A.get("/brands"),createBrand:e=>s.A.post("/brands",{name:e}),updateBrand:(e,t)=>s.A.put(`/brands/${e}`,t),deleteBrand:e=>s.A.delete(`/brands/${e}`)},orderAPI:{createOrder:e=>s.A.post("/orders",e),getOrders:()=>s.A.get("/orders"),getOrderById:e=>s.A.get(`/orders/${e}`),updateOrder:(e,t)=>s.A.put(`/orders/${e}`,t)},recipientAPI:{getRecipients:e=>s.A.get("/recipients",{params:{user_id:e}}),updateRecipient:(e,t)=>s.A.put(`/recipients/${e}`,t),addRecipient:e=>s.A.post("/recipients",e),deleteRecipient:e=>s.A.delete(`/recipients/${e}`)},carouselAPI:{getAllCarouselImages:()=>s.A.get("/carousel_images"),getCarouselImages:()=>s.A.get("/carousel_images"),uploadCarouselImages:e=>s.A.post("/carousel_images",e,{headers:{"Content-Type":"multipart/form-data"}}),updateCarouselImage:(e,t)=>s.A.put(`/carousel_images/${e}`,t),deleteCarouselImage:e=>s.A.delete(`/carousel_images/${e}`)},specialOffersAPI:{getAllSpecialOffers:()=>s.A.get("/special_offers"),getSpecialOfferById:e=>s.A.get(`/special_offers/${e}`),createSpecialOffer:e=>s.A.post("/special_offers",e),updateSpecialOffer:(e,t)=>s.A.put(`/special_offers/${e}`,t),deleteSpecialOffer:e=>s.A.delete(`/special_offers/${e}`)},rankingAPI:{getRanking:e=>s.A.get("/sales/ranking",{params:{days:e}})},messageAPI:{createMessage:e=>s.A.post("/message",e)},createCancelToken:()=>{const e=r.A.CancelToken.source();return e}};t.A=i},5019:function(e,t,a){a.d(t,{V:function(){return s}});const s=(e,t)=>{const a="https://ecshop-backend.onrender.com/api".replace(/\/$/,""),s=a.replace(/\/api$/,"");if(!e)return`${s}/img/wrong.png`;if(e.startsWith("http"))return e;if(e.startsWith("/"))return a+e;switch(t){case"carousel":return`${a}/img/carouselImages/${e.split("/").pop()}`;case"product":return`${a}/img/products/${e.split("/").pop()}`;case"icon":return`${a}/img/icons/${e.split("/").pop()}`;default:return`${a}${e}`}}},5720:function(e,t,a){a(4114);var s=a(4373),r=a(3061);const i=s.A.create({baseURL:"https://ecshop-backend.onrender.com/api",timeout:1e4,withCredentials:!0});i.interceptors.request.use((e=>e),(e=>Promise.reject(e))),i.interceptors.response.use((e=>e.data),(e=>{e.response&&401===e.response.status&&(alert("登入已過期，請重新登入"),localStorage.removeItem("authToken"),localStorage.removeItem("user"),r.A.push("/UserLogin"));const t=e.config?.url.includes("/login")||e.config?.url?.includes("/register"),a=localStorage.getItem("authToken");return a&&!t&&e.config&&(e.config.headers["Authorization"]=`Bearer ${a}`),e.config&&!e.config.headers["Content-Type"]&&(e.config.headers["Content-Type"]="application/json"),Promise.reject(e)})),t.A=i},7335:function(e,t,a){var s=a(5130),r=a(6768),i=a(4232);const o={class:"notification-portal"},n={key:0,class:"modal"},l={class:"modal-content"},c={class:"main-content"};function d(e,t,a,s,d,u){const p=(0,r.g2)("NotificationComponent"),m=(0,r.g2)("MainHeader"),h=(0,r.g2)("router-view"),g=(0,r.g2)("MainFooter");return(0,r.uX)(),(0,r.CE)(r.FK,null,[(0,r.Lk)("div",o,[(0,r.bF)(p)]),t[3]||(t[3]=(0,r.Lk)("div",{class:"marquee"},[(0,r.Lk)("span",null,"2024.09.01，注意！本公司不會主動通知帳務問題，若有相關疑問請洽客服！小心詐騙！")],-1)),(0,r.bF)(m),(0,r.Lk)("div",{class:"floating-button",onClick:t[0]||(t[0]=(...e)=>s.toggleModal&&s.toggleModal(...e))},(0,i.v_)(s.modalVisible?"關閉介紹":"網站介紹"),1),s.modalVisible?((0,r.uX)(),(0,r.CE)("div",n,[(0,r.Lk)("div",l,[(0,r.Lk)("span",{class:"close",onClick:t[1]||(t[1]=(...e)=>s.toggleModal&&s.toggleModal(...e))},"×"),t[2]||(t[2]=(0,r.Fv)('<div class="notification-box" data-v-040f0953><h2 data-v-040f0953>網站介紹</h2><p data-v-040f0953> 本網站前端使用 <strong data-v-040f0953>Vue.js</strong> 搭配 <strong data-v-040f0953>Bootstrap 5</strong>，實現響應式設計 (RWD)，<br data-v-040f0953> 後端採用 <strong data-v-040f0953>Node.js</strong> 搭配 <strong data-v-040f0953>Express</strong>，資料庫使用 <strong data-v-040f0953>MySQL</strong>，部署於 <strong data-v-040f0953>Google Cloud Platform (GCP)</strong>。 </p><p data-v-040f0953> 全站採用 <strong data-v-040f0953>RESTful API</strong> 設計，前後端完全分離，確保資料交互的高效與穩定，<br data-v-040f0953> 提升系統的擴展性與維護性。 </p><hr data-v-040f0953><h3 data-v-040f0953>主要功能介紹</h3><ul data-v-040f0953><li data-v-040f0953><strong data-v-040f0953>會員系統：</strong>註冊 / 登入 / 登出 / 忘記密碼 / 修改密碼 / 編輯個人資料</li><li data-v-040f0953><strong data-v-040f0953>購物車系統：</strong>商品加入購物車 / 修改數量 / 移除 / 清空購物車</li><li data-v-040f0953><strong data-v-040f0953>訂單系統：</strong>查詢 / 修改 / 取消訂單</li><li data-v-040f0953><strong data-v-040f0953>商品管理系統：</strong>查看 / 修改 / 刪除商品</li><li data-v-040f0953><strong data-v-040f0953>後台管理中心：</strong>會員 / 商品 / 訂單全面控管 / 銷售曲線圖查看銷售額度</li><li data-v-040f0953><strong data-v-040f0953>首頁功能：</strong>銷售排行顯示 / 特價商品控管</li></ul></div>',1))])])):(0,r.Q3)("",!0),(0,r.Lk)("div",c,[(0,r.bF)(h)]),(0,r.bF)(g)],64)}var u=a(144),p=a(782);const m={class:"header-container"},h={class:"headerbar d-flex align-items-center"},g={key:0,class:"nav-toggle-wrapper d-flex align-items-center ms-2 d-lg-none"},k=["src"],f={class:"nav-content"},b={class:"nav-left-wrapper"},v=["to"],L={class:"nav-center-wrapper"},y={class:"search-container"},w={class:"search-input-wrapper"},C={class:"nav-right-wrapper"},I={class:"cartmember d-flex align-items-center"},P=["src"],A={key:0,class:"member-item d-flex align-items-center"},_={class:"cart-text welcome-text me-2"},E=["src"];function F(e,t,a,o,n,l){const c=(0,r.g2)("BNavbarToggle"),d=(0,r.g2)("router-link"),u=(0,r.g2)("BNavbarNav"),p=(0,r.g2)("BCollapse"),F=(0,r.g2)("BFormInput"),x=(0,r.g2)("BButton"),S=(0,r.g2)("BContainer"),O=(0,r.g2)("BNavbar");return(0,r.uX)(),(0,r.CE)("div",m,[(0,r.bF)(O,{toggleable:"lg",type:"light",variant:"light",class:"navbar-overlay px-0"},{default:(0,r.k6)((()=>[(0,r.bF)(S,{fluid:""},{default:(0,r.k6)((()=>[(0,r.Lk)("div",h,[(0,r.bF)(c,{onClick:l.toggleNav},null,8,["onClick"]),n.isNavOpen?(0,r.Q3)("",!0):((0,r.uX)(),(0,r.CE)("div",g,[(0,r.Lk)("img",{src:e.$getImageUrl("arrowleft.png","icon"),alt:"導航提示",class:"nav-toggle-image",onClick:t[0]||(t[0]=(...e)=>l.toggleNav&&l.toggleNav(...e))},null,8,k),t[4]||(t[4]=(0,r.Lk)("span",{class:"nav-toggle-text ms-1"},"請點選此處開啟導航欄",-1))]))]),(0,r.Lk)("div",f,[(0,r.Lk)("div",b,[(0,r.bF)(p,{id:"nav-collapse",modelValue:n.isNavOpen,"onUpdate:modelValue":t[1]||(t[1]=e=>n.isNavOpen=e),"is-nav":""},{default:(0,r.k6)((()=>[(0,r.bF)(u,{class:"nav-links"},{default:(0,r.k6)((()=>[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(n.navItems,(e=>((0,r.uX)(),(0,r.CE)("div",{key:e.path,to:e.path,class:"nav-item-container"},[(0,r.bF)(d,{to:e.path,class:"nav-link-text",onClick:l.closeNav},{default:(0,r.k6)((()=>[(0,r.eW)((0,i.v_)(e.text),1)])),_:2},1032,["to","onClick"])],8,v)))),128))])),_:1})])),_:1},8,["modelValue"])]),(0,r.Lk)("div",L,[(0,r.Lk)("div",y,[(0,r.Lk)("div",w,[(0,r.bF)(F,{type:"text",modelValue:n.searchQuery,"onUpdate:modelValue":t[2]||(t[2]=e=>n.searchQuery=e),class:"search-box",placeholder:l.currentPlaceholder,onKeyup:(0,s.jR)(l.handleSearch,["enter"])},null,8,["modelValue","placeholder","onKeyup"]),(0,r.bF)(x,{class:"search-button btn btn-primary ms-2",onClick:l.handleSearch},{default:(0,r.k6)((()=>t[5]||(t[5]=[(0,r.Lk)("span",{class:"search-button-text"},"搜尋 ",-1),(0,r.Lk)("i",{class:"fas fa-search search-icon"},null,-1)]))),_:1},8,["onClick"])])])]),(0,r.Lk)("div",C,[(0,r.Lk)("div",I,[(0,r.bF)(d,{class:"cart-item me-3",to:"/ShopCart",onClick:l.closeNav},{default:(0,r.k6)((()=>[(0,r.Lk)("img",{src:e.$getImageUrl("shopping_cart.png","icon"),alt:"",class:"icon-img"},null,8,P),t[6]||(t[6]=(0,r.Lk)("span",{class:"cart-text"},"購物車",-1))])),_:1},8,["onClick"]),l.isLoggedIn?((0,r.uX)(),(0,r.CE)("div",A,[(0,r.Lk)("span",_,"歡迎 "+(0,i.v_)(l.userName),1),(0,r.Lk)("button",{class:"btn btn-link logout-btn",onClick:t[3]||(t[3]=(...e)=>l.logout&&l.logout(...e))},"會員登出")])):((0,r.uX)(),(0,r.Wv)(d,{key:1,class:"member-item d-flex align-items-center",to:"/UserLogin",onClick:l.closeNav},{default:(0,r.k6)((()=>[(0,r.Lk)("img",{src:e.$getImageUrl("member_login.png","icon"),alt:"",class:"icon-img"},null,8,E),t[7]||(t[7]=(0,r.Lk)("span",{class:"cart-text"},"會員登入",-1))])),_:1},8,["onClick"]))])])])])),_:1})])),_:1})])}a(4114);var x={name:"MainHeader",data(){return{searchQuery:"",isNavOpen:!1,windowWidth:window.innerWidth,navItems:[{path:"/",text:"首頁"},{path:"/MembersPage",text:"會員中心"},{path:"/ProductsList",text:"產品列表"},{path:"/AboutUsPage",text:"關於我們"},{path:"/ContactUs",text:"聯絡我們"},{path:"/admin",text:"後台"}]}},computed:{isLoggedIn(){return this.$store.state.auth.isLoggedIn},userName(){return this.$store.state.auth.user?this.$store.state.auth.user.name:""},currentPlaceholder(){return this.windowWidth<576?"搜尋商品":"請輸入想找的商品"}},methods:{handleSearch(){""!==this.searchQuery.trim()&&(this.$router.push({path:"/ProductsList",query:{search:this.searchQuery.trim()}}),this.closeNav())},toggleNav(){this.isNavOpen=!this.isNavOpen},closeNav(){window.innerWidth<992&&(this.isNavOpen=!1)},checkScreenSize(){window.innerWidth>=992?this.isNavOpen=!0:this.isNavOpen=!1},handleResize(){this.windowWidth=window.innerWidth},logout(){this.$store.dispatch("auth/logout"),this.$router.push({path:"/"})}},mounted(){this.checkScreenSize(),window.addEventListener("resize",this.handleResize)},beforeUnmount(){window.removeEventListener("resize",this.handleResize)},watch:{$route(){this.closeNav()}}},S=a(1241);const O=(0,S.A)(x,[["render",F],["__scopeId","data-v-5973f6ce"]]);var U=O;const R={class:"footer d-flex flex-column"};function D(e,t,a,s,i,o){return(0,r.uX)(),(0,r.CE)("div",R,t[0]||(t[0]=[(0,r.Lk)("div",{class:"flex-grow-1"},[(0,r.Lk)("p",null,[(0,r.eW)("台灣ECshop.com有限公司"),(0,r.Lk)("br"),(0,r.eW)(" 統編 99999999"),(0,r.Lk)("br"),(0,r.eW)(" Copyright 2024, ECSHOP Group.")])],-1)]))}var T={name:"MainFooter"};const $=(0,S.A)(T,[["render",D],["__scopeId","data-v-7588858f"]]);var M=$;const N={class:"notifications-container"},X=["onClick"],q={class:"message"},W=["onClick"];function V(e,t,a,o,n,l){return(0,r.uX)(),(0,r.CE)("div",N,[(0,r.bF)(s.F,{name:"notification"},{default:(0,r.k6)((()=>[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(o.notifications,(e=>((0,r.uX)(),(0,r.CE)("div",{key:e.id,class:(0,i.C4)(["notification",`notification-${e.type}`]),onClick:t=>o.closeNotification(e.id)},[(0,r.Lk)("span",q,(0,i.v_)(e.message),1),(0,r.Lk)("button",{class:"close-btn",onClick:(0,s.D$)((t=>o.closeNotification(e.id)),["stop"])},"×",8,W)],10,X)))),128))])),_:1})])}var B={name:"NotificationComponent",setup(){const e=(0,p.Pj)(),t=(0,r.EW)((()=>e.state.notifications.notifications));(0,r.sV)((()=>{e.dispatch("notifications/showNotification",{type:"warning",message:"歡迎來到小高的網站！👋\n                感謝您的蒞臨與支持 🙌\n\n                提醒您：由於本網站採用免費版的雲端架構，部分圖片可能需要稍微多一點時間加載 \n                (閒置一段時間後可能會需要先[喚醒]一下)⏳\n                我們正在努力優化體驗，感謝您的耐心等候與理解！🙏\n                希望您在這裡度過愉快的時光，祝您瀏覽愉快！😊",timeout:0})}));const a=t=>{e.dispatch("notifications/removeNotification",t)};return{notifications:t,closeNotification:a}}};const K=(0,S.A)(B,[["render",V],["__scopeId","data-v-3c79d31b"]]);var J=K,Q={name:"App",components:{MainHeader:U,MainFooter:M,NotificationComponent:J},setup(){const e=(0,p.Pj)(),t=(0,r.EW)((()=>e.getters["auth/isLoggedIn"])),a=(0,u.KR)(!1),s=()=>{a.value=!a.value};return{isLoggedIn:t,modalVisible:a,toggleModal:s}}};const j=(0,S.A)(Q,[["render",d],["__scopeId","data-v-040f0953"]]);var z=j,H=a(4233),G=(a(4188),a(323),a(3664)),Z=a(8047),Y=a(3061),ee=a(8029),te=a(5720),ae=(a(4300),a(5019));const se=(0,s.Ef)(z);se.config.globalProperties.$axios=te.A,se.config.globalProperties.$getImageUrl=ae.V,se.use(Y.A),se.use(ee.A),se.use(H.A),se.use(Z.Ay),se.directive("tooltip",{mounted(e){new G.m_(e)},unmounted(e){const t=G.m_.getInstance(e);t&&t.dispose()}}),ee.A.dispatch("auth/checkAuthStatus").then((()=>{se.mount("#app")})).catch((e=>{se.mount("#app")}))},8029:function(e,t,a){a.d(t,{A:function(){return f}});var s=a(782),r=(a(4114),a(8992),a(2577),a(8872),{namespaced:!0,state:{items:[]},getters:{cartItems:e=>e.items,cartTotal:e=>e.items.reduce(((e,t)=>e+t.price*t.quantity),0),cartItemCount:e=>e.items.reduce(((e,t)=>e+t.quantity),0)},mutations:{addToCart(e,t){const a=Number(t.price);if(isNaN(a)||!t.id||!t.name)return;const s=e.items.find((e=>e.id===t.id));s?s.quantity++:e.items.push({id:t.id,name:t.name,price:a,image:t.image||"/backend/public/img/wrong.png",quantity:1})},removeFromCart(e,t){e.items.splice(t,1)},updateCartItemQuantity(e,{index:t,quantity:a}){e.items[t].quantity=a<1?1:a},clearCart(e){e.items=[]}},actions:{addProductToCart({commit:e},t){t&&t.id&&e("addToCart",t)},removeItemFromCart({commit:e},t){e("removeFromCart",t)},updateItemQuantity({commit:e},t){e("updateCartItemQuantity",t)},clearShoppingCart({commit:e}){e("clearCart")}}}),i=a(4300),o={namespaced:!0,state:{isLoggedIn:!1,user:{role:""},showLoginModal:!1},mutations:{login(e,t){e.isLoggedIn=!0,e.user=t},logout(e){e.isLoggedIn=!1,e.user=null,localStorage.removeItem("user"),localStorage.removeItem("authToken")},setShowLoginModal(e,t){e.showLoginModal=t}},actions:{async login({commit:e,dispatch:t},a){e("logout");try{i.A.setHeader("Authorization","");const t=await i.A.userAPI.login(a);if(!t||!t.data)throw new Error("伺服器回應格式錯誤");if(!t.data.token)throw new Error("未收到認證令牌");if(!t||!t.data||!t.success)throw new Error("登入失敗");const{data:s}=t;if(!s.token)throw new Error("無法取得用戶資料或 token");const{token:r,id:o,name:n,email:l,role:c,phone:d,address:u}=s,p={id:o,name:n,email:l,role:c,phone:d,address:u};return localStorage.setItem("authToken",r),localStorage.setItem("user",JSON.stringify(p)),e("login",p),i.A.setHeader("Authorization",`Bearer ${r}`),t}catch(s){throw s}},async checkAuthStatus({commit:e}){const t=localStorage.getItem("authToken"),a=JSON.parse(localStorage.getItem("user"));if(!t||!a)return e("logout"),!1;try{i.A.setHeader("Authorization",`Bearer ${t}`);const s=await i.A.userAPI.getUserInfo(a.id);if(s.success)return e("login",a),!0;throw new Error("Token 驗證失敗")}catch(s){return e("logout"),!1}},logout({commit:e}){e("logout"),localStorage.removeItem("authToken"),localStorage.removeItem("user")},showLoginModal({commit:e},t){e("setShowLoginModal",t)}},getters:{isLoggedIn:e=>e.isLoggedIn,user:e=>e.user,showLoginModal:e=>e.showLoginModal}};a(7550);const n={notifications:[]},l=3,c=2e3,d={ADD_NOTIFICATION(e,t){if(!t.message||!t.type)return;e.notifications.length>=l&&e.notifications.shift();const a=e.notifications.some((e=>e.message===t.message&&e.type===t.type));a||(e.notifications.length>=l&&e.notifications.shift(),e.notifications.push(t))},REMOVE_NOTIFICATION(e,t){const a=e.notifications.findIndex((e=>e.id===t));-1!==a&&e.notifications.splice(a,1)}},u={showNotification({commit:e},{message:t,type:a,timeout:s=c}){if(!t||!a)return;const r=Date.now(),i={id:r,message:t,type:a};e("ADD_NOTIFICATION",i),s>0&&setTimeout((()=>{e("REMOVE_NOTIFICATION",r)}),s)},removeNotification({commit:e},t){e("REMOVE_NOTIFICATION",t)}};var p={namespaced:!0,state:n,mutations:d,actions:u},m=a(5131);const h=(0,s.y$)({modules:{cart:r,auth:o,notifications:p},plugins:[(0,m.A)()]}),g=localStorage.getItem("authToken"),k=localStorage.getItem("user");g&&k&&h.commit("auth/login",JSON.parse(k));var f=h}},t={};function a(s){var r=t[s];if(void 0!==r)return r.exports;var i=t[s]={exports:{}};return e[s].call(i.exports,i,i.exports,a),i.exports}a.m=e,function(){var e=[];a.O=function(t,s,r,i){if(!s){var o=1/0;for(d=0;d<e.length;d++){s=e[d][0],r=e[d][1],i=e[d][2];for(var n=!0,l=0;l<s.length;l++)(!1&i||o>=i)&&Object.keys(a.O).every((function(e){return a.O[e](s[l])}))?s.splice(l--,1):(n=!1,i<o&&(o=i));if(n){e.splice(d--,1);var c=r();void 0!==c&&(t=c)}}return t}i=i||0;for(var d=e.length;d>0&&e[d-1][2]>i;d--)e[d]=e[d-1];e[d]=[s,r,i]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){a.p="/ECshop/"}(),function(){var e={524:0};a.O.j=function(t){return 0===e[t]};var t=function(t,s){var r,i,o=s[0],n=s[1],l=s[2],c=0;if(o.some((function(t){return 0!==e[t]}))){for(r in n)a.o(n,r)&&(a.m[r]=n[r]);if(l)var d=l(a)}for(t&&t(s);c<o.length;c++)i=o[c],a.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return a.O(d)},s=self["webpackChunkeshop_site"]=self["webpackChunkeshop_site"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=a.O(void 0,[504],(function(){return a(7335)}));s=a.O(s)})();