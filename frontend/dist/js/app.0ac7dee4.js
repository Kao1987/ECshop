(function(){"use strict";var e={8559:function(e,t,a){var s=a(5130),r=a(6768);const o={id:"app"},l={class:"main-content"};function n(e,t,a,s,n,i){const d=(0,r.g2)("MainHeader"),c=(0,r.g2)("router-view"),u=(0,r.g2)("MainFooter");return(0,r.uX)(),(0,r.CE)(r.FK,null,[t[0]||(t[0]=(0,r.Lk)("div",{class:"marquee"},[(0,r.Lk)("span",null,"注意！本公司不會主動通知帳務問題，若有相關疑問請洽客服！小心詐騙！")],-1)),(0,r.Lk)("div",o,[(0,r.bF)(d),(0,r.Lk)("div",l,[(0,r.bF)(c)]),(0,r.bF)(u)])],64)}var i=a(4232);const d={class:"header-container"},c={class:"headerbar d-flex align-items-center"},u={key:0,class:"nav-toggle-wrapper d-flex align-items-center ms-2"},p={class:"nav-content d-flex w-100 align-items-center justify-content-between"},m=["to"],h={class:"search-container d-flex mx-lg-3"},b={class:"search-input-wrapper"},k={class:"cartmember d-flex"},g={key:0,class:"cart-item"},v={class:"text-link"};function f(e,t,a,o,l,n){const f=(0,r.g2)("BNavbarToggle"),L=(0,r.g2)("router-link"),y=(0,r.g2)("BNavbarNav"),C=(0,r.g2)("BFormInput"),w=(0,r.g2)("BButton"),_=(0,r.g2)("BCollapse"),I=(0,r.g2)("BContainer"),F=(0,r.g2)("BNavbar");return(0,r.uX)(),(0,r.CE)("div",d,[(0,r.bF)(F,{toggleable:"lg",type:"light",variant:"light",class:"navbar-overlay px-0"},{default:(0,r.k6)((()=>[(0,r.bF)(I,{fluid:""},{default:(0,r.k6)((()=>[(0,r.Lk)("div",c,[(0,r.bF)(f,{onClick:n.toggleNav},null,8,["onClick"]),l.isNavOpen?(0,r.Q3)("",!0):((0,r.uX)(),(0,r.CE)("div",u,[(0,r.Lk)("img",{src:"img/arrowleft.png",alt:"導航提示",class:"nav-toggle-image",onClick:t[0]||(t[0]=(...e)=>n.toggleNav&&n.toggleNav(...e))}),t[4]||(t[4]=(0,r.Lk)("span",{class:"nav-toggle-text ms-1"},"請點選此處開啟導航欄",-1))]))]),(0,r.bF)(_,{id:"nav-collapse",modelValue:l.isNavOpen,"onUpdate:modelValue":t[3]||(t[3]=e=>l.isNavOpen=e),"is-nav":""},{default:(0,r.k6)((()=>[(0,r.Lk)("div",p,[(0,r.bF)(y,{class:"nav-links me-lg-3"},{default:(0,r.k6)((()=>[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(l.navItems,(e=>((0,r.uX)(),(0,r.CE)("div",{key:e.path,to:e.path,class:"nav-item-container"},[(0,r.bF)(L,{to:e.path,class:"nav-link-text",onClick:n.closeNav},{default:(0,r.k6)((()=>[(0,r.eW)((0,i.v_)(e.text),1)])),_:2},1032,["to","onClick"])],8,m)))),128))])),_:1}),(0,r.Lk)("div",h,[(0,r.Lk)("div",b,[(0,r.bF)(C,{type:"text",modelValue:l.searchQuery,"onUpdate:modelValue":t[1]||(t[1]=e=>l.searchQuery=e),class:"search-box",placeholder:"請輸入想找的商品搜尋",onKeyup:(0,s.jR)(n.handleSearch,["enter"])},null,8,["modelValue","onKeyup"]),(0,r.bF)(w,{class:"search-button btn btn-primary ms-2",onClick:n.handleSearch},{default:(0,r.k6)((()=>t[5]||(t[5]=[(0,r.eW)("搜尋")]))),_:1},8,["onClick"])])]),(0,r.Lk)("div",k,[(0,r.bF)(L,{class:"cart-item me-3",to:"/ShopCart",onClick:n.closeNav},{default:(0,r.k6)((()=>t[6]||(t[6]=[(0,r.Lk)("img",{src:"/img/shopping_cart.png",alt:"購物車",class:"icon-img"},null,-1),(0,r.Lk)("span",{class:"text-link"},"購物車",-1)]))),_:1},8,["onClick"]),n.isLoggedIn?((0,r.uX)(),(0,r.CE)("div",g,[(0,r.Lk)("span",v,"歡迎 "+(0,i.v_)(n.userName),1),(0,r.Lk)("button",{class:"btn btn-link",onClick:t[2]||(t[2]=(...e)=>n.logout&&n.logout(...e))},"會員登出")])):((0,r.uX)(),(0,r.Wv)(L,{key:1,class:"cart-item",to:"/UserLogin",onClick:n.closeNav},{default:(0,r.k6)((()=>t[7]||(t[7]=[(0,r.Lk)("img",{src:"/img/member_login.png",alt:"會員登入",class:"icon-img"},null,-1),(0,r.Lk)("span",{class:"text-link"},"會員登入",-1)]))),_:1},8,["onClick"]))])])])),_:1},8,["modelValue"])])),_:1})])),_:1})])}a(4114);var L={name:"MainHeader",data(){return{searchQuery:"",isNavOpen:window.innerWidth<992,navItems:[{path:"/",text:"首頁"},{path:"/MembersPage",text:"會員中心"},{path:"/ProductsList",text:"產品列表"},{path:"/AboutUsPage",text:"關於我們"},{path:"/ContactUs",text:"聯絡我們"},{path:"/admin",text:"後台"}]}},computed:{isLoggedIn(){return this.$store.state.auth.isLoggedIn},userName(){return this.$store.state.auth.user?this.$store.state.auth.user.name:""}},methods:{handleSearch(){""!==this.searchQuery.trim()&&(this.$router.push({path:"/ProductsList",query:{search:this.searchQuery.trim()}}),this.closeNav())},toggleNav(){this.isNavOpen=!this.isNavOpen},closeNav(){window.innerWidth<992&&(this.isNavOpen=!1)},checkScreenSize(){window.innerWidth>=992?this.isNavOpen=!0:this.isNavOpen=!1},handleResize(){this.checkScreenSize()},logout(){this.$store.dispatch("auth/logout"),this.$router.push({path:"/"})}},mounted(){this.checkScreenSize(),window.addEventListener("resize",this.handleResize)},beforeUnmount(){window.removeEventListener("resize",this.handleResize)},watch:{$route(){this.closeNav()}}},y=a(1241);const C=(0,y.A)(L,[["render",f],["__scopeId","data-v-67589a17"]]);var w=C;const _={class:"footer d-flex flex-column"};function I(e,t,a,s,o,l){return(0,r.uX)(),(0,r.CE)("div",_,t[0]||(t[0]=[(0,r.Lk)("div",{class:"flex-grow-1"},[(0,r.Lk)("p",null,[(0,r.eW)("台灣ECshop.com有限公司"),(0,r.Lk)("br"),(0,r.eW)(" 統編 99999999"),(0,r.Lk)("br"),(0,r.eW)(" Copyright 2024, ECSHOP Group.")])],-1)]))}var F={name:"MainFooter"};const E=(0,y.A)(F,[["render",I],["__scopeId","data-v-499e5536"]]);var P=E,S={name:"App",components:{MainHeader:w,MainFooter:P}};const O=(0,y.A)(S,[["render",n],["__scopeId","data-v-60d0685a"]]);var x=O,A=a(6452),U=(a(4188),a(323),a(4578)),T=a(8047),D=a(1387);const X={class:"homepage container mt-5"},M={class:"carousel-section"},R={key:0,class:"loading-spinner"},$={key:1,class:"alert alert-warning"},q={key:2,id:"carouselExampleIndicators",class:"carousel slide position-relative","data-bs-ride":"carousel"},N={class:"carousel-indicators"},V=["data-bs-slide-to","aria-current","aria-labe"],B={class:"carousel-inner"},W=["src","alt"],K={class:"sales-ranking mt-5"},Q={class:"product-list"},J={key:0,class:"loading-spinner"},j={key:1,class:"alert alert-warning"},H={key:2,class:"product-list"},z={class:"sales-ranking mt-5"},G={class:"product-list"},Z={key:0,class:"loading-spinner"},Y={key:1,class:"alert alert-warning"},ee={key:2,class:"product-list"},te={class:"countdown-special-offers mt-4"},ae={class:"product-list"},se={key:0,class:"loading-spinner"},re={key:1,class:"alert alert-warning"},oe={key:2,class:"product-list"},le={class:"countdown-timer"};function ne(e,t,a,s,o,l){return(0,r.uX)(),(0,r.CE)(r.FK,null,[(0,r.Lk)("div",X,[(0,r.Lk)("div",M,[o.isLoading.carousel?((0,r.uX)(),(0,r.CE)("div",R,t[0]||(t[0]=[(0,r.Lk)("div",{class:"spinner-border",role:"status"},[(0,r.Lk)("span",{class:"visually-hidden"},"加載中...")],-1)]))):o.errors.carousel?((0,r.uX)(),(0,r.CE)("div",$,(0,i.v_)(o.errors.carousel),1)):o.carouselImages&&o.carouselImages.length?((0,r.uX)(),(0,r.CE)("div",q,[(0,r.Lk)("div",N,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(o.carouselImages,((e,t)=>((0,r.uX)(),(0,r.CE)("button",{key:"indicator-"+t,type:"button","data-bs-target":"#carouselExampleIndicators","data-bs-slide-to":t,class:(0,i.C4)({active:0===t}),"aria-current":0===t,"aria-labe":"Slide"+(t+1)},null,10,V)))),128))]),(0,r.Lk)("div",B,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(o.carouselImages,((e,t)=>((0,r.uX)(),(0,r.CE)("div",{key:t,class:(0,i.C4)(["carousel-item",{active:0===t}])},[(0,r.Lk)("img",{src:e.url,class:"d-block w-100",alt:"圖片"+(t+1)},null,8,W)],2)))),128))]),t[1]||(t[1]=(0,r.Fv)('<button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="prev" data-v-4b67e945><span class="carousel-control-prev-icon" aria-hidden="true" data-v-4b67e945></span><span class="visually-hidden" data-v-4b67e945>Previous</span></button><button class="carousel-control-next" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="next" data-v-4b67e945><span class="carousel-control-next-icon" aria-hidden="true" data-v-4b67e945></span><span class="visually-hidden" data-v-4b67e945>Next</span></button>',2))])):(0,r.Q3)("",!0)])]),(0,r.Lk)("div",K,[t[3]||(t[3]=(0,r.Lk)("h3",null,"過去7日銷售排行",-1)),(0,r.Lk)("div",Q,[o.isLoading.sales?((0,r.uX)(),(0,r.CE)("div",J,t[2]||(t[2]=[(0,r.Lk)("div",{class:"spinner-border",role:"status"},[(0,r.Lk)("span",{class:"visually-hidden"},"加載中...")],-1)]))):o.errors.sales?((0,r.uX)(),(0,r.CE)("div",j,(0,i.v_)(o.errors.sales),1)):((0,r.uX)(),(0,r.CE)("div",H,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(l.processedSevenDaySalesRanking,((e,t)=>((0,r.uX)(),(0,r.CE)("div",{key:t,class:"product-item"},[(0,r.Lk)("div",null,(0,i.v_)(t+1)+"."+(0,i.v_)(e.name),1),(0,r.Lk)("div",null,"賣出 "+(0,i.v_)(e.quantity_sold)+"件",1)])))),128))]))])]),(0,r.Lk)("div",z,[t[5]||(t[5]=(0,r.Lk)("h3",null,"過去30日銷售排行",-1)),(0,r.Lk)("div",G,[o.isLoading.sales?((0,r.uX)(),(0,r.CE)("div",Z,t[4]||(t[4]=[(0,r.Lk)("div",{class:"spinner-border",role:"status"},[(0,r.Lk)("span",{class:"visually-hidden"},"加載中...")],-1)]))):o.errors.sales?((0,r.uX)(),(0,r.CE)("div",Y,(0,i.v_)(o.errors.sales),1)):((0,r.uX)(),(0,r.CE)("div",ee,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(l.processedMonthSalesRanking,((e,t)=>((0,r.uX)(),(0,r.CE)("div",{key:t,class:"product-item"},[(0,r.Lk)("div",null,(0,i.v_)(t+1)+"."+(0,i.v_)(e.name),1),(0,r.Lk)("div",null,"賣出"+(0,i.v_)(e.quantity_sold)+"件",1)])))),128))]))])]),(0,r.Lk)("div",te,[t[7]||(t[7]=(0,r.Lk)("h3",null,"特價倒數計時商品",-1)),(0,r.Lk)("div",ae,[o.isLoading.offers?((0,r.uX)(),(0,r.CE)("div",se,t[6]||(t[6]=[(0,r.Lk)("span",{class:"visually-hidden"},"加載中...",-1)]))):o.errors.offers?((0,r.uX)(),(0,r.CE)("div",re,(0,i.v_)(o.errors.offers),1)):((0,r.uX)(),(0,r.CE)("div",oe,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(l.processedSpecialOffers,((e,t)=>((0,r.uX)(),(0,r.CE)("div",{key:t,class:"product-item"},[(0,r.Lk)("div",null,(0,i.v_)(e.name),1),(0,r.Lk)("div",null,"特價 "+(0,i.v_)(e.price)+"元",1),(0,r.Lk)("div",le," 倒數"+(0,i.v_)(l.formatTime(e.countdown))+"秒 ",1)])))),128))]))])])],64)}var ie=a(4373);const de={carouselImages:[{url:"/img/customer.webp"},{url:"/img/customer.webp"}]};var ce={name:"HomePage",beforeUnmount(){this.clearCountdownIntervals()},data(){return{isPageLoading:!0,sevenDaySalesRanking:[],monthSalesRanking:[],specialOffers:[],carouselImages:de.carouselImages,products:[],countdownIntervals:[],isLoading:{sales:!1,offers:!1,carousel:!1,products:!1},errors:{sales:null,offers:null,carousel:null,products:null}}},async mounted(){try{await this.loadHomePageData(),this.$nextTick((()=>{this.startCountdown()}))}catch(e){console.error("Failed to load home page data",e)}},methods:{handleError(e,t){console.error(`Error in ${e}:`,t),this.errors[e]=`無法加載${e}數據`},async loadHomePageData(){Object.keys(this.errors).forEach((e=>{this.errors[e]=null})),await Promise.all([this.loadSalesData(),this.loadOffersData(),this.loadCarouselData(),this.loadProductsData()])},async loadSalesData(){this.isLoading.sales=!0;try{const e=await ie.A.get("/api/sales"),t=e.data||[];this.processAndSetSalesRanking(t)}catch(e){console.error("加載銷售數據失敗",e),this.errors.sales="無法加載銷售排行數據",this.sevenDaySalesRanking=[],this.monthSalesRanking=[]}finally{this.isLoading.sales=!1}},async loadOffersData(){this.isLoading.offers=!0;try{const e=await ie.A.get("/api/special_offers");this.specialOffers=e.data||[]}catch(e){console.error("加載特價商品失敗",e),this.errors.offers="無法加載特價商品數據",this.specialOffers=[]}finally{this.isLoading.offers=!1}},async loadCarouselData(){this.isLoading.carousel=!0;try{const e=await ie.A.get("/api/carousel_images");this.carouselImages=e.data||[]}catch(e){console.error("加載輪播圖片失敗",e),this.errors.carousel="無法加載輪播圖片",this.carouselImages=de.carouselImages}finally{this.isLoading.carousel=!1}},async loadProductsData(){this.isLoading.products=!0;try{const e=await ie.A.get("/api/products");this.products=e.data||[]}catch(e){console.error("加載商品數據失敗",e),this.errors.products="無法加載商品列表",this.products=[]}finally{this.isLoading.products=!1}},processAndSetSalesRanking(e){const t=new Date,a=new Date(t-6048e5),s=new Date(t-2592e6),r={},o={};e.forEach((e=>{const t=new Date(e.sale_date);t>=a&&(r[e.product_id]=(r[e.product_id]||0)+e.quantity_sold),t>=s&&(o[e.product_id]=(o[e.product_id]||0)+e.quantity_sold)})),this.sevenDaySalesRanking=this.convertToSortedArray(r),this.monthSalesRanking=this.convertToSortedArray(o)},convertToSortedArray(e){return Object.entries(e).map((([e,t])=>({product_id:e,quantity_sold:t}))).sort(((e,t)=>t.quantity_sold-e.quantity_sold)).slice(0,5)},startCountdown(){this.clearCountdownIntervals(),this.specialOffers&&0!==this.specialOffers.length&&this.specialOffers.forEach(((e,t)=>{if(!e.countdown)return;const a=setInterval((()=>{this.specialOffers[t].countdown&&this.specialOffers[t].countdown>0?this.specialOffers[t].countdown--:clearInterval(a)}),1e3);this.countdownIntervals.push(a)}))},clearCountdownIntervals(){this.countdownIntervals.forEach((e=>clearInterval(e))),this.countdownIntervals=[]},formatTime(e){const t=Math.floor(e/3600),a=Math.floor(e%3600/60),s=e%60;return`${t}時${a}分${s}秒`}},computed:{processedSevenDaySalesRanking(){return this.sevenDaySalesRanking&&this.products?this.sevenDaySalesRanking.map((e=>{const t=this.products.find((t=>t.id===e.product_id));return{...e,name:t?t.name:"未知商品"}})):[]},processedMonthSalesRanking(){return this.monthSalesRanking&&this.products?this.monthSalesRanking.map((e=>{const t=this.products.find((t=>t.id===e.product_id));return{...e,name:t?t.name:"未知商品"}})):[]},processedSpecialOffers(){return this.specialOffers&&this.products?this.specialOffers.map((e=>{const t=this.products.find((t=>t.id===e.product_id));return{...e,name:t?t.name:"未知商品"}})):[]}}};const ue=(0,y.A)(ce,[["render",ne],["__scopeId","data-v-4b67e945"]]);var pe=ue;function me(e,t,a,s,o,l){return t[0]||(t[0]=(0,r.Fv)('<h1 style="color:coral;" data-v-b5050256>關於我們</h1><br data-v-b5050256><br data-v-b5050256><div data-v-b5050256><div class="title" data-v-b5050256>公司願景</div><div class="content" data-v-b5050256> ECSHOP 電商平台致力於打造一個以消費者需求為核心的全球購物平台，通過先進的技術、優質的產品及卓越的服務，提供每一位顧客最便捷、愉快的購物體驗。 我們相信，透過創新和精確的市場洞察，能為消費者和合作夥伴創造更多的價值，並推動電商產業的進步。 我們的願景是成為全球消費者心目中的首選購物平台，無論是日常所需還是高端商品，ECSHOP 都能夠滿足不同客戶的需求，並且實現跨境無縫銷售的全球電商體驗。 </div><div class="title" data-v-b5050256>未來展望</div><div class="content" data-v-b5050256> ECSHOP 將持續不斷地創造優質的產品和優秀的服務，並持續推動消費者需求的解決方案，讓消費者能更輕鬆地在全球購物。 我們也將不斷地學習和進步，以提供給消&quot;&gt;未來，ECSHOP 將持續拓展產品品類，並加強與世界各地的品牌商及供應商的合作，為消費者提供更豐富的選擇。同時，我們將致力於智能化技術的應用，利用大數據分析、人工智慧和物聯網等前沿技術，提升用戶體驗，優化物流配送效率，並實現個性化推薦和精準行銷。 我們也將積極推動環保和可持續發展，通過綠色物流、減少包裝浪費等措施，承擔企業社會責任，為地球的未來做出貢獻。 展望未來，ECSHOP 將不斷創新，推動整個行業的數位化轉型，並且努力實現「消費者、合作夥伴與企業共贏」的目標。我們期待與您攜手，共創電商新時代的輝煌！</div></div>',4))}var he={name:"AboutUsPage"};const be=(0,y.A)(he,[["render",me],["__scopeId","data-v-b5050256"]]);var ke=be;const ge={class:"cart-container container mt-5"},ve={key:0,class:"text-center"},fe={class:"table table-hover"},Le=["src"],ye=["onUpdate:modelValue","onInput"],Ce=["onClick"],we={class:"d-flex justify-content-between align-items-center mt-4"};function _e(e,t,a,o,l,n){const d=(0,r.g2)("router-link");return(0,r.uX)(),(0,r.CE)("div",ge,[t[5]||(t[5]=(0,r.Lk)("h2",{class:"text-center mb-4"},"我的購物車",-1)),0===o.cartItems.length?((0,r.uX)(),(0,r.CE)("div",ve,[t[3]||(t[3]=(0,r.Lk)("p",null,"購物車是空的。",-1)),(0,r.bF)(d,{to:"/",class:"btn btn-primary"},{default:(0,r.k6)((()=>t[2]||(t[2]=[(0,r.eW)("去購物")]))),_:1})])):((0,r.uX)(),(0,r.CE)(r.FK,{key:1},[(0,r.Lk)("table",fe,[t[4]||(t[4]=(0,r.Lk)("thead",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("th",{scope:"col"},"商品圖片"),(0,r.Lk)("th",{scope:"col"},"商品名稱"),(0,r.Lk)("th",{scope:"col"},"單價"),(0,r.Lk)("th",{scope:"col"},"數量"),(0,r.Lk)("th",{scope:"col"},"小計"),(0,r.Lk)("th",{scope:"col"},"操作")])],-1)),(0,r.Lk)("tbody",null,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(o.cartItems,((e,a)=>((0,r.uX)(),(0,r.CE)("tr",{key:e.id},[(0,r.Lk)("td",null,[(0,r.Lk)("img",{src:e.image,alt:"item.name",class:"product-image",onError:t[0]||(t[0]=(...e)=>o.imageError&&o.imageError(...e))},null,40,Le)]),(0,r.Lk)("td",null,(0,i.v_)(e.name),1),(0,r.Lk)("td",null,(0,i.v_)(e.price)+"元",1),(0,r.Lk)("td",null,[(0,r.bo)((0,r.Lk)("input",{type:"number",class:"form-control quantity-input","onUpdate:modelValue":t=>e.quantity=t,onInput:t=>o.updateQuantity(a,e.quantity),min:"1"},null,40,ye),[[s.Jo,e.quantity,void 0,{number:!0}]])]),(0,r.Lk)("td",null,(0,i.v_)(e.quantity*e.price)+"元",1),(0,r.Lk)("td",null,[(0,r.Lk)("button",{class:"btn btn-danger",onClick:e=>o.removeItem(a)},"刪除",8,Ce)])])))),128))])]),(0,r.Lk)("div",we,[(0,r.Lk)("h4",null,"總計："+(0,i.v_)(o.cartTotal)+"元",1),(0,r.Lk)("button",{class:"btn btn-success",onClick:t[1]||(t[1]=(...e)=>o.checkout&&o.checkout(...e))},"結帳")])],64))])}var Ie=a(782),Fe={name:"ShoppingCart",setup(){const e=(0,Ie.Pj)(),t=(0,D.rd)(),a=(0,r.EW)((()=>e.state.cart.items)),s=(0,r.EW)((()=>e.getters["cart/cartTotal"])),o=(0,r.EW)((()=>e.state.auth&&e.state.auth.isLoggedIn)),l=(t,a)=>{a<1&&(a=1),e.dispatch("cart/updateItemQuantity",{index:t,quantity:a})},n=e=>{e.target.src="img/wrong.png"},i=t=>{e.dispatch("cart/removeItemFromCart",t)},d=async()=>{if(o.value)if(0!==a.value.length)try{const r=await ie.A.post("/api/orders",{items:a.value,total:s.value});e.dispatch("cart/clearShoppingCart"),e.dispatch("showNotification",{type:"success",message:"訂單已成功提交！"}),t.push({name:"OrderConfirmation",params:{orderId:r.data.orderId}})}catch(r){console.error("提交訂單時出錯",r),e.dispatch("showNotification",{type:"error",message:"提交訂單失敗，請稍後再試！"})}else e.dispatch("showNotification",{type:"warning",message:"購物車是空的，無法結帳！"});else t.push({name:"Login",query:{redirect:"/cart"}})};return{cartItems:a,cartTotal:s,updateQuantity:l,removeItem:i,checkout:d,imageError:n}}};const Ee=(0,y.A)(Fe,[["render",_e],["__scopeId","data-v-54a6b962"]]);var Pe=Ee;const Se={class:"container mt-5"},Oe={class:"row"},xe={class:"tag-filter mb-4"},Ae=["onClick"],Ue={class:"search-bar mb-4"},Te={class:"col-md-3"},De={class:"container mt-5"},Xe={class:"row"};function Me(e,t,a,o,l,n){const d=(0,r.g2)("ProductCard");return(0,r.uX)(),(0,r.CE)(r.FK,null,[(0,r.Lk)("div",Se,[(0,r.Lk)("div",Oe,[(0,r.Lk)("div",xe,[t[3]||(t[3]=(0,r.Lk)("h4",null,"選擇標籤",-1)),(0,r.Lk)("div",null,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(o.availableTags,(e=>((0,r.uX)(),(0,r.CE)("button",{key:e,onClick:t=>o.toggleTag(e),class:(0,i.C4)([{btn:!0,"btn-primary":o.selectedTags.includes(e),"btn-outline-primary":!o.selectedTags.includes(e)},"me-2 mb-2"])},(0,i.v_)(e),11,Ae)))),128))])]),(0,r.Lk)("div",Ue,[(0,r.bo)((0,r.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>o.searchQuery=e),class:"form-control",placeholder:"搜尋產品..."},null,512),[[s.Jo,o.searchQuery]])]),(0,r.Lk)("div",Te,[t[5]||(t[5]=(0,r.Lk)("h4",null,"篩選條件",-1)),(0,r.Lk)("div",null,[t[4]||(t[4]=(0,r.Lk)("label",null,"價格區間",-1)),(0,r.bo)((0,r.Lk)("input",{type:"range","onUpdate:modelValue":t[1]||(t[1]=e=>o.priceRange=e),min:"0",max:"50000",step:"500",onInput:t[2]||(t[2]=(...t)=>e.filterProducts&&e.filterProducts(...t))},null,544),[[s.Jo,o.priceRange]]),(0,r.Lk)("p",null,"價格："+(0,i.v_)(o.priceRange)+"元",1)])])])]),(0,r.Lk)("div",De,[t[6]||(t[6]=(0,r.Lk)("h2",{class:"mb-4"},"商品列表",-1)),(0,r.Lk)("div",Xe,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(o.filteredProducts,(e=>((0,r.uX)(),(0,r.CE)("div",{class:"col-md-3 mb-4",key:e.id},[(0,r.bF)(d,{product:e},null,8,["product"])])))),128))])])],64)}a(7642),a(8004),a(3853),a(5876),a(2475),a(5024),a(1698);var Re=a(144);const $e={class:"product-card"},qe=["src"],Ne={class:"card-title"},Ve={class:"card-text"};function Be(e,t,a,s,o,l){const n=(0,r.g2)("router-link");return(0,r.uX)(),(0,r.CE)("div",$e,[(0,r.bF)(n,{to:{name:"ProductDetail",params:{id:s.productId}}},{default:(0,r.k6)((()=>[(0,r.Lk)("img",{src:s.productImagerUrl,class:"product-image",alt:"Product Image",onError:t[0]||(t[0]=(...e)=>s.imageError&&s.imageError(...e))},null,40,qe),(0,r.Lk)("h5",Ne,(0,i.v_)(a.product.name),1),(0,r.Lk)("p",Ve,(0,i.v_)(a.product.price)+" 元",1)])),_:1},8,["to"]),(0,r.Lk)("button",{class:"btn btn-primary",onClick:t[1]||(t[1]=(...t)=>e.AddToCart&&e.AddToCart(...t))},"加入購物車")])}var We={name:"ProductCard",props:{product:{type:Object,required:!0,validator:function(e){return e.id&&e.name&&e.price}}},setup(e){const t=(0,Ie.Pj)(),a=(0,r.EW)((()=>String(e.product.id).trim())),s=(0,r.EW)((()=>`/img/product/${e.product.image}`)),o=()=>{const a=t.state.auth.isLoggedIn;a?(t.dispatch("cart/addToCart",e.product),t.dispatch("showNotification",{type:"success",message:`已將 ${e.product.name} 加入購物車`})):t.dispatch("showLoginModal",!0)},l=e=>{e.target.src="/img/wrong.png"};return{productId:a,productImagerUrl:s,addToCart:o,imageError:l}}};const Ke=(0,y.A)(We,[["render",Be],["__scopeId","data-v-ebeac206"]]);var Qe=Ke,Je={name:"ProductsList",components:{ProductCard:Qe},setup(){const e=(0,Re.KR)([]),t=(0,Re.KR)(5e4),a=(0,Re.KR)(!1),s=(0,Re.KR)(null),o=(0,Re.KR)([]),l=(0,Re.KR)([]),n=(0,Ie.Pj)(),i=(0,D.rd)(),d=(0,D.lq)(),c=(0,r.EW)((()=>n.state.auth.isLoggedIn)),u=(0,Re.KR)(""),p=(0,r.EW)((()=>e.value.filter((e=>{const a=Number(e.price),s=e.name.toLowerCase().includes(u.value.toLowerCase()),r=a<=t.value,o=0===l.value.length||l.value.some((t=>e.tags.includes(t)));return s&&r&&o})))),m=async()=>{a.value=!0,s.value=null;try{const t=await ie.A.get("/api/products");console.log("商品數據:",t.data),e.value=t.data.map((e=>({...e,id:String(e.id).trim()})));const a=new Set;e.value.forEach((e=>{e.tags.forEach((e=>a.add(e)))})),o.value=Array.from(a)}catch(t){console.error("加載商品時出錯",t),s.value="加載產品時出錯，請稍後再試！"}finally{a.value=!1}},h=e=>{l.value.includes(e)?l.value=l.value.filter((t=>t!==e)):l.value.push(e)},b=e=>{if(c.value)n.dispatch("cart/addToCart",e),n.dispatch("showNotification",{type:"success",message:`已將 ${e.name} 加入購物車`});else{n.dispatch("showNotification",{type:"warning",message:"請先登入會員再加入購物車！"});const e=d.fullPath;i.push({name:"UserLogin",query:{redirect:e}})}};return(0,r.sV)((()=>{u.value=d.query.search||"",m()})),(0,r.wB)((()=>d.query.search),(e=>{u.value=e||""})),{products:e,priceRange:t,loading:a,error:s,isLoggedIn:c,filteredProducts:p,availableTags:o,selectedTags:l,searchQuery:u,toggleTag:h,addToCart:b}}};const je=(0,y.A)(Je,[["render",Me],["__scopeId","data-v-0c768c14"]]);var He=je;const ze={class:"container mt-5"},Ge={key:0},Ze={class:"product-detail"},Ye=["src"],et={key:1};function tt(e,t,a,s,o,l){return(0,r.uX)(),(0,r.CE)("div",ze,[s.product&&s.product.id?((0,r.uX)(),(0,r.CE)("div",Ge,[(0,r.Lk)("div",Ze,[(0,r.Lk)("img",{src:s.productImageUrl,alt:"Product Image",class:"product-image-large"},null,8,Ye),(0,r.Lk)("h2",null,(0,i.v_)(s.product.name),1),(0,r.Lk)("p",null,(0,i.v_)(s.product.description),1),(0,r.Lk)("p",null,"價格："+(0,i.v_)(s.product.price)+" 元",1),(0,r.Lk)("button",{class:"btn btn-primary",onClick:t[0]||(t[0]=(...e)=>s.addToCart&&s.addToCart(...e))},"加入購物車")])])):((0,r.uX)(),(0,r.CE)("div",et,t[1]||(t[1]=[(0,r.Lk)("p",null,"正在加載商品中...",-1)])))])}var at={name:"ProductDetail",setup(){const e=(0,Ie.Pj)(),t=(0,D.lq)(),a=(0,D.rd)(),s=(0,Re.KR)(null),o=(0,r.EW)((()=>t.params.id)),l=(0,r.EW)((()=>s.value?`/api/product/${s.value.image}`:"/img/wrong.png")),n=(0,r.EW)((()=>e.getters.isLoggedIn)),i=async()=>{try{const e=await ie.A.get(`/api/products/${o.value}`);console.log("API 返回的產品資料：",e.data),s.value=e.data}catch(e){console.error("加載商品詳情時出錯",e),alert("加載商品詳情時出錯，請稍後再試！")}},d=()=>{if(n.value)e.dispatch("cart/addProductToCart",s.value),alert(`已將${s.value.name}加入購物車`);else{alert("請先登入再加入購物車！");const e=t.fullPath;a.push({name:"UserLogin",query:{redirect:e}})}};return i(),{addToCart:d,product:s,productId:o,productImageUrl:l}}};const st=(0,y.A)(at,[["render",tt],["__scopeId","data-v-1506dfd7"]]);var rt=st;const ot={class:"container mt-5"},lt={class:"card mb-3"},nt={class:"card-body"},it={class:"card-text"},dt={class:"card-text"},ct={class:"card-text"},ut={class:"card-text"},pt={class:"card mb-3"},mt={class:"card-body"},ht={key:0},bt={class:"table"},kt=["onClick"],gt=["onClick"],vt={class:"mb-3"},ft={class:"card-body"},Lt={class:"table"},yt=["onClick"],Ct={key:0},wt={colspan:"4"},_t={class:"table"},It={colspan:"4"},Ft={class:"text-end"},Et={class:"modal fade",id:"recipientModal",tabindex:"-1","aria-labelledby":"recipientModalLabel","aria-hidden":"true"},Pt={class:"mmodal-dialog"},St={class:"modal-content"},Ot={class:"modal-header"},xt={class:"modal-title",id:"recipientModalLabel"},At={class:"modal-body"},Ut={class:"mb-3"},Tt={class:"mb-3"},Dt={class:"mb-3"},Xt={class:"modal-footer"};function Mt(e,t,a,o,l,n){return(0,r.uX)(),(0,r.CE)("div",ot,[t[20]||(t[20]=(0,r.Lk)("h2",{class:"mb-4"},"會員資料",-1)),(0,r.Lk)("div",lt,[(0,r.Lk)("div",nt,[t[7]||(t[7]=(0,r.Lk)("h5",{class:"card-title"},"會員基本資料",-1)),(0,r.Lk)("p",it,"使用者名稱："+(0,i.v_)(l.userInfo.name),1),(0,r.Lk)("p",dt,"電子郵件："+(0,i.v_)(l.userInfo.email),1),(0,r.Lk)("p",ct,"電話："+(0,i.v_)(l.userInfo.phone),1),(0,r.Lk)("p",ut,"住址: "+(0,i.v_)(l.userInfo.address),1)])]),(0,r.Lk)("div",pt,[(0,r.Lk)("div",mt,[t[9]||(t[9]=(0,r.Lk)("h5",null,"收件人資料",-1)),(0,r.Lk)("button",{class:"btn btn-link",onClick:t[0]||(t[0]=(...e)=>n.toggleRecipient&&n.toggleRecipient(...e))},"展開/收起"),l.showRecipient?((0,r.uX)(),(0,r.CE)("div",ht,[(0,r.Lk)("table",bt,[t[8]||(t[8]=(0,r.Lk)("thead",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("th",null,"收件人名稱"),(0,r.Lk)("th",null,"聯絡電話"),(0,r.Lk)("th",null,"地址")])],-1)),(0,r.Lk)("tbody",null,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(l.userInfo.recipients,((t,a)=>((0,r.uX)(),(0,r.CE)("tr",{key:a},[(0,r.Lk)("td",null,(0,i.v_)(t.name),1),(0,r.Lk)("td",null,(0,i.v_)(t.phone),1),(0,r.Lk)("td",null,(0,i.v_)(t.address),1),(0,r.Lk)("td",null,[(0,r.Lk)("button",{class:"btn btn-primary btn-sm",onClick:e=>l.editRecipient(a)},"編輯",8,kt),(0,r.Lk)("button",{class:"btn btn-danger btn-sm",onClick:t=>e.deleteRecipient(a)},"刪除",8,gt)])])))),128))])]),(0,r.Lk)("button",{class:"btn btn-primary",onClick:t[1]||(t[1]=(...e)=>n.addRecipient&&n.addRecipient(...e))},"新增收件人")])):(0,r.Q3)("",!0)]),(0,r.Lk)("div",vt,[(0,r.Lk)("div",ft,[t[14]||(t[14]=(0,r.Lk)("h5",{class:"card-title"},"訂單查詢",-1)),(0,r.Lk)("table",Lt,[t[13]||(t[13]=(0,r.Lk)("thead",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("th",null,"訂單編號"),(0,r.Lk)("th",null,"訂單金額"),(0,r.Lk)("th",null,"訂購時間"),(0,r.Lk)("th",null,"操作")])],-1)),(0,r.Lk)("tbody",null,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(l.orders,((e,t)=>((0,r.uX)(),(0,r.CE)("tr",{key:t},[(0,r.Lk)("td",null,(0,i.v_)(e.id),1),(0,r.Lk)("td",null,(0,i.v_)(e.total),1),(0,r.Lk)("td",null,(0,i.v_)(e.date),1),(0,r.Lk)("td",null,[(0,r.Lk)("button",{class:"btn btn-link",onClick:e=>n.toggleOrderDetails(t)},"展開/收起",8,yt)])])))),128)),l.expandedOrder===e.index?((0,r.uX)(),(0,r.CE)("tr",Ct,[(0,r.Lk)("td",wt,[(0,r.Lk)("table",_t,[(0,r.Lk)("tbody",null,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(e.order.items,((e,a)=>((0,r.uX)(),(0,r.CE)("tr",{key:a},[(0,r.Lk)("td",It,[t[10]||(t[10]=(0,r.Lk)("strong",null,"商品名稱:",-1)),(0,r.eW)((0,i.v_)(e.name)+" ",1),t[11]||(t[11]=(0,r.Lk)("strong",null,"數量:",-1)),(0,r.eW)(" "+(0,i.v_)(e.quantity)+" ",1),t[12]||(t[12]=(0,r.Lk)("strong",null,"價格:",-1)),(0,r.eW)(" "+(0,i.v_)(e.price),1)])])))),128))])])])])):(0,r.Q3)("",!0)])])])]),(0,r.Lk)("div",Ft,[(0,r.Lk)("button",{class:"btn btn-danger",onClick:t[2]||(t[2]=(...e)=>n.logout&&n.logout(...e))},"登出")])]),(0,r.Lk)("div",Et,[(0,r.Lk)("div",Pt,[(0,r.Lk)("div",St,[(0,r.Lk)("div",Ot,[(0,r.Lk)("h5",xt,(0,i.v_)(l.isEditing?"編輯收件人":"新增收件人"),1),t[15]||(t[15]=(0,r.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),(0,r.Lk)("div",At,[(0,r.Lk)("div",Ut,[t[16]||(t[16]=(0,r.Lk)("label",{for:"recipientName",class:"form-label"},"收件人名稱",-1)),(0,r.bo)((0,r.Lk)("input",{type:"text",class:"form-control","onUpdate:modelValue":t[3]||(t[3]=e=>l.editRecipient.name=e)},null,512),[[s.Jo,l.editRecipient.name]])]),(0,r.Lk)("div",Tt,[t[17]||(t[17]=(0,r.Lk)("label",{for:"recipientPhone",class:"form-label"},"收件人電話",-1)),(0,r.bo)((0,r.Lk)("input",{type:"text",class:"form-control","onUpdate:modelValue":t[4]||(t[4]=e=>l.editRecipient.phone=e)},null,512),[[s.Jo,l.editRecipient.phone]])]),(0,r.Lk)("div",Dt,[t[18]||(t[18]=(0,r.Lk)("label",{for:"recipientAddress",class:"form-label"},"收件人地址",-1)),(0,r.bo)((0,r.Lk)("input",{type:"text",class:"form-control","onUpdate:modelValue":t[5]||(t[5]=e=>l.editRecipient.address=e)},null,512),[[s.Jo,l.editRecipient.address]])])]),(0,r.Lk)("div",Xt,[t[19]||(t[19]=(0,r.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"取消",-1)),(0,r.Lk)("button",{type:"button",class:"btn btn-primary",onClick:t[6]||(t[6]=(...e)=>n.saveRecipient&&n.saveRecipient(...e))},(0,i.v_)(l.isEditing?"儲存變更":"新增"),1)])])])])])}var Rt={name:"MemberPage",data(){return{showRecipient:!1,expandedOrder:null,isEditing:!1,editRecipient:{name:" ",phone:" ",address:" "},editingIndex:-1,userInfo:{name:" ",email:" ",phone:"",address:"",recipients:[]},orders:[]}},computed:{...(0,Ie.aH)({isLoggedIn:e=>e.auth.isLoggedIn,user:e=>e.auth.user})},mounted(){if(!this.isLoggedIn)return alert("請先登入會員！"),void this.$router.push("/UserLogin");this.loadUserInfo(),this.loadOrders()},methods:{async loadUserInfo(){try{const e=this.user.id;if(console.log("用戶 ID:",e),!e)return void console.error("用戶ID無效");const t=await ie.A.get(`/api/users/${e}`);this.userInfo=t.data,console.log("用戶資料",this.userInfo)}catch(e){console.error("加載用戶信息時出錯:",e),console.error("錯誤回應:",e.response),console.error("請求細節:",e.config),alert("加載用戶信息失敗，請重試。")}},async loadOrders(){try{const e=this.userID;if(console.log("用戶訂單ID：",e),!e)return void console.error("用戶ID無效");const t=await ie.A.get("/api/orders",{params:{userId:e}});this.orders=t.data}catch(e){console.error("加載訂單時出錯：",e),alert("加載訂單失敗，請稍候再試")}},toggleRecipient(){this.showRecipient=!this.showRecipient},addRecipient(){this.isEditing=!1,this.editRecipient={name:"",phone:"",address:""},this.showModal()},editRecipientInfo(e){this.isEditing=!0,this.editingIndex=e,this.editRecipient={...this.userInfo.recipients[e]},this.showModal()},async saveRecipient(){this.isEditing?this.userInfo.recipients[this.editingIndex]={...this.editRecipient}:this.userInfo.recipients.push({...this.editRecipient});const e=this.user.id;await ie.A.put(`/api/users/${e}`,this.userInfo),this.hideModal()},toggleOrderDetails(e){this.expandedOrder=this.expandedOrder===e?null:e},showModal(){const e=new U.aF(document.getElementById("recipientModal"));e.show()},hideModal(){const e=U.aF.getInstance(document.getElementById("recipientModal"));e.hide()},...(0,Ie.i0)("auth",["logout"]),async logout(){await this.logout(),alert("已成功登出!"),this.$router.push("/UserLogin")}}};const $t=(0,y.A)(Rt,[["render",Mt],["__scopeId","data-v-1fe0f707"]]);var qt=$t;function Nt(e,t,a,s,o,l){return t[0]||(t[0]=(0,r.Fv)('<div class="faq-search" data-v-7a8228db><input type="text" class="form-control" id="faqSearch" placeholder="搜尋問題..." data-v-7a8228db></div><div class="accordion" id="faqAccordion" data-v-7a8228db><div class="accordion-item faq-item" data-v-7a8228db><h2 class="accordion-header" id="headingOne" data-v-7a8228db><button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne" data-v-7a8228db> 問題一：如何註冊？ </button></h2><div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne" data-bs-parent="#faqAccordion" data-v-7a8228db><div class="accordion-body" data-v-7a8228db> 您可以點擊右上角的「註冊」按鈕，並按照提示填寫相關資訊來完成註冊。 </div></div></div><div class="accordion-item faq-item" data-v-7a8228db><h2 class="accordion-header" id="headingTwo" data-v-7a8228db><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo" data-v-7a8228db> 問題二：忘記密碼怎麼辦？ </button></h2><div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#faqAccordion" data-v-7a8228db><div class="accordion-body" data-v-7a8228db> 您可以點擊「忘記密碼」連結，輸入您的電子郵件，系統將發送密碼重置的指引給您。 </div></div></div></div><div class="contact-container contact" data-v-7a8228db><div class="contact-info" data-v-7a8228db><h4 data-v-7a8228db>或者透過以下表格聯絡</h4></div><div class="contact-form" data-v-7a8228db><form data-v-7a8228db><div class="mb-3" data-v-7a8228db><label for="name" class="form-label" data-v-7a8228db>姓名</label><input type="text" class="form-control" id="name" placeholder="請輸入您的姓名" data-v-7a8228db></div><div class="mb-3" data-v-7a8228db><label for="email" class="form-label" data-v-7a8228db>電子郵件</label><input type="email" class="form-control" id="email" placeholder="請輸入您的電子郵件" data-v-7a8228db></div><div class="mb-3" data-v-7a8228db><label for="message" class="form-label" data-v-7a8228db>留言</label><textarea class="form-control" id="message" rows="4" placeholder="請輸入您的訊息" data-v-7a8228db></textarea></div><button type="submit" class="btn btn-primary" data-v-7a8228db>送出</button></form></div></div>',3))}var Vt={name:"ContactUs",mounted(){const e=document.getElementById("faqSearch");e&&e.addEventListener("input",(function(){const e=this.ariaValueMax.toLowerCase();document.querySelectorAll(".faq-item").forEach((function(t){const a=t.querySelector("according-button").innerText.toLowerCase(),s=t.querySelector(".according-body").innerText.toLowerCase();a.includes(e)||s.includes(e)?t.style.display="block":t.style.display="none"}))}))}};const Bt=(0,y.A)(Vt,[["render",Nt],["__scopeId","data-v-7a8228db"]]);var Wt=Bt;function Kt(e,t,a,s,o,l){return(0,r.uX)(),(0,r.CE)("div",null,[t[0]||(t[0]=(0,r.Lk)("h1",null,"搜尋結果",-1)),(0,r.Lk)("p",null,"搜尋關鍵字："+(0,i.v_)(l.searchQuery),1)])}var Qt={name:"SearchResults",computed:{searchQuery(){return this.$route.query.q}}};const Jt=(0,y.A)(Qt,[["render",Kt]]);var jt=Jt;const Ht={class:"container register-container mt-5 whitespace:nowrap"},zt={class:"mb-3 d-flex align-items-center"},Gt={class:"mb-3 d-flex align-items-center"},Zt={class:"mb-3 d-flex align-items-center"},Yt={class:"mb-3 d-flex align-items-center"},ea={class:"mb-3 d-flex align-items-center"},ta={class:"mb-3 d-flex align-items-center"},aa={key:0,class:"text-danger"};function sa(e,t,a,o,l,n){return(0,r.uX)(),(0,r.CE)("div",Ht,[t[14]||(t[14]=(0,r.Lk)("h2",{class:"mb-4"},"會員註冊",-1)),(0,r.Lk)("form",{onSubmit:t[6]||(t[6]=(0,s.D$)(((...e)=>n.handleRegister&&n.handleRegister(...e)),["prevent"]))},[(0,r.Lk)("div",zt,[t[7]||(t[7]=(0,r.Lk)("label",{for:"username",class:"form-label me-2"},"會員姓名",-1)),(0,r.bo)((0,r.Lk)("input",{type:"text",class:"form-control",id:"username","onUpdate:modelValue":t[0]||(t[0]=e=>l.username=e),placeholder:"請輸入姓名",required:""},null,512),[[s.Jo,l.username]])]),(0,r.Lk)("div",Gt,[t[8]||(t[8]=(0,r.Lk)("label",{for:"email",class:"form-label me-2"},"電子郵件",-1)),(0,r.bo)((0,r.Lk)("input",{type:"email",class:"form-control",id:"email","onUpdate:modelValue":t[1]||(t[1]=e=>l.email=e),placeholder:"請輸入電子信箱",required:""},null,512),[[s.Jo,l.email]])]),(0,r.Lk)("div",Zt,[t[9]||(t[9]=(0,r.Lk)("label",{for:"phone",class:"form-label me-2"},"會員電話號碼",-1)),(0,r.bo)((0,r.Lk)("input",{type:"tel",class:"form-control",id:"phone","onUpdate:modelValue":t[2]||(t[2]=e=>l.phone=e),placeholder:"請輸入手機號碼",required:""},null,512),[[s.Jo,l.phone]])]),(0,r.Lk)("div",Yt,[t[10]||(t[10]=(0,r.Lk)("label",{for:"address",class:"form-label me-2"},"收件人地址",-1)),(0,r.bo)((0,r.Lk)("input",{type:"text",class:"form-control",id:"address","onUpdate:modelValue":t[3]||(t[3]=e=>l.address=e),placeholder:"請輸入收件人地址",required:""},null,512),[[s.Jo,l.address]])]),(0,r.Lk)("div",ea,[t[11]||(t[11]=(0,r.Lk)("label",{for:"password",class:"form-label me-2"},"會員密碼",-1)),(0,r.bo)((0,r.Lk)("input",{type:"password",class:"form-control",id:"password","onUpdate:modelValue":t[4]||(t[4]=e=>l.password=e),placeholder:"請設定密碼"},null,512),[[s.Jo,l.password]])]),(0,r.Lk)("div",ta,[t[12]||(t[12]=(0,r.Lk)("label",{for:"confirmpassword",class:"form-label me-2"},"請再次輸入密碼",-1)),(0,r.bo)((0,r.Lk)("input",{type:"password",class:"form-control",id:"confirmpassword","onUpdate:modelValue":t[5]||(t[5]=e=>l.confirmpassword=e),placeholder:"請再次輸入密碼",required:""},null,512),[[s.Jo,l.confirmpassword]]),l.password!==l.confirmpassword?((0,r.uX)(),(0,r.CE)("div",aa,"兩次密碼不相符，請重新輸入。")):(0,r.Q3)("",!0)]),t[13]||(t[13]=(0,r.Lk)("button",{type:"submit",class:"btn btn-primary"},"註冊",-1))],32)])}var ra={name:"UserRegister",data(){return{username:"",phone:"",address:"",email:"",password:"",confirmpassword:""}},methods:{handleRegister(){this.validatePhoneNumber()?this.password===this.confirmpassword?ie.A.post("/api/users",{name:this.username,phone:this.phone,address:this.address,email:this.email,password:this.password,role:"user"}).then((()=>{alert("註冊成功"),this.$router.push("/UserLogin")})).catch((e=>{e.response?(console.error("伺服器錯誤:",e.response.data),alert("伺服器錯誤，請稍候再試。")):e.request?(console.error("未收到伺服器響應:",e.request),alert("無法連接到伺服器，請檢查網絡。")):(console.error("註冊失敗:",e.message),alert("註冊失敗，請稍候再試。"))})):alert("兩次密碼不相符，請重新輸入。"):alert("請輸入正確的手機號碼格式")},validatePhoneNumber(){const e=/^[0-9]{10}$/;return e.test(this.phone)}}};const oa=(0,y.A)(ra,[["render",sa],["__scopeId","data-v-66346fec"]]);var la=oa;const na={class:"login-container container mt-5"},ia={class:"mb-3"},da={class:"mb-3"},ca={class:"d-flex justify-content-between mb-3"};function ua(e,t,a,o,l,n){const i=(0,r.g2)("router-link");return(0,r.uX)(),(0,r.CE)("div",na,[t[8]||(t[8]=(0,r.Lk)("h2",{class:"text-center mb-4"},"會員登入",-1)),(0,r.Lk)("form",{onSubmit:t[2]||(t[2]=(0,s.D$)(((...e)=>n.handleLogin&&n.handleLogin(...e)),["prevent"]))},[(0,r.Lk)("div",ia,[t[3]||(t[3]=(0,r.Lk)("label",{for:"email",class:"form-label"},"帳號/電子郵件",-1)),(0,r.bo)((0,r.Lk)("input",{type:"email",id:"email","onUpdate:modelValue":t[0]||(t[0]=e=>l.email=e),name:"email",class:"form-control",placeholder:"請輸入你的EMAIL",required:""},null,512),[[s.Jo,l.email]])]),(0,r.Lk)("div",da,[t[4]||(t[4]=(0,r.Lk)("label",{for:"password",class:"form-label"},"密碼",-1)),(0,r.bo)((0,r.Lk)("input",{type:"password",id:"password","onUpdate:modelValue":t[1]||(t[1]=e=>l.password=e),name:"password",class:"form-control",placeholder:"請輸入密碼",required:""},null,512),[[s.Jo,l.password]])]),(0,r.Lk)("div",ca,[(0,r.bF)(i,{class:"text-decoration-none",to:"/ForgotPwd"},{default:(0,r.k6)((()=>t[5]||(t[5]=[(0,r.eW)("忘記密碼？")]))),_:1}),(0,r.bF)(i,{class:"text-decoration-none",to:"/UserRegister"},{default:(0,r.k6)((()=>t[6]||(t[6]=[(0,r.eW)("註冊新帳號")]))),_:1})]),t[7]||(t[7]=(0,r.Lk)("button",{type:"submit",class:"btn btn-primary w-100"},"登入",-1))],32)])}var pa={name:"UserLogin",data(){return{email:"",password:""}},methods:{async handleLogin(){try{const e=await ie.A.get("api/users",{params:{email:this.email,password:this.password}}),t=e.data;if(console.log("用戶資料:",t),t.length>0){const e=t[0];console.log("找到的用戶",e),alert("登入成功!歡迎"+e.name),"admin"===e.role?(localStorage.setItem("authToken","adminToken"),localStorage.setItem("role","admin"),localStorage.setItem("userID",e.id),alert("登入成功，即將跳轉到管理頁面"),this.$nextTick((()=>{this.$router.push("/admin")}))):"user"===e.role?(localStorage.setItem("authToken","userToken"),localStorage.setItem("role","user"),localStorage.setItem("userID",e.id),alert("登入成功，即將跳轉到會員頁面"),this.$nextTick((()=>{this.$router.push("/MembersPage")}))):alert("帳號或密碼錯誤")}}catch(e){console.error("登入失敗",e),alert("登入失敗，請稍候再試")}}}};const ma=(0,y.A)(pa,[["render",ua],["__scopeId","data-v-20494eec"]]);var ha=ma;const ba={class:"container"},ka={class:"mb-3"};function ga(e,t,a,o,l,n){return(0,r.uX)(),(0,r.CE)("div",ba,[t[4]||(t[4]=(0,r.Lk)("h5",null,"忘記密碼",-1)),(0,r.Lk)("form",{onSubmit:t[1]||(t[1]=(0,s.D$)(((...e)=>n.handleForgotPassword&&n.handleForgotPassword(...e)),["prevent"]))},[(0,r.Lk)("div",ka,[t[2]||(t[2]=(0,r.Lk)("label",{for:"email",class:"form-label"},"電子郵件",-1)),(0,r.bo)((0,r.Lk)("input",{type:"email","onUpdate:modelValue":t[0]||(t[0]=e=>l.email=e),class:"form-control",id:"email",required:""},null,512),[[s.Jo,l.email]])]),t[3]||(t[3]=(0,r.Lk)("button",{type:"submit",class:"btn btn-primary"},"發送重設密碼連結信",-1))],32)])}var va={name:"ForgotPwd",data(){return{email:""}},methods:{async handleForgotPassword(){try{const e=this.$route.params.token;await ie.A.post(`/api/reset-password/${e}`,{newPassword:this.newPassword}),alert("密碼已成功重新設置！"),this.$router.push("/login")}catch(e){console.error("重設密碼錯誤,error"),alert("重設密碼失敗")}}}};const fa=(0,y.A)(va,[["render",ga]]);var La=fa;const ya={class:"admin-dashboard container mt-5"},Ca={class:"button-container"},wa={class:"button-item"},_a={class:"button-item"},Ia={class:"button-item"},Fa={class:"button-item"},Ea={class:"row text-center mt-4"},Pa={class:"col-md-3"},Sa={class:"col-md-3"},Oa={class:"col-md-3"},xa={class:"col-md-3"},Aa={class:"row mt-5"},Ua={class:"col-12"},Ta={class:"row mt-5"},Da={class:"col-md-6"},Xa={class:"col-md-6"};function Ma(e,t,a,s,o,l){const n=(0,r.g2)("router-link"),d=(0,r.g2)("P");return(0,r.uX)(),(0,r.CE)("div",ya,[t[11]||(t[11]=(0,r.Lk)("h2",{class:"text-center"},"管理後台儀表板",-1)),(0,r.Lk)("div",Ca,[(0,r.Lk)("div",wa,[(0,r.bF)(n,{to:"/admin/CarouselImages",class:"btn btn-primary btn-block"},{default:(0,r.k6)((()=>t[0]||(t[0]=[(0,r.eW)("輪播圖片管理")]))),_:1})]),(0,r.Lk)("div",_a,[(0,r.bF)(n,{to:"/admin/products",class:"btn btn-primary btn-block"},{default:(0,r.k6)((()=>t[1]||(t[1]=[(0,r.eW)("商品管理")]))),_:1})]),(0,r.Lk)("div",Ia,[(0,r.bF)(n,{to:"/admin/orders",class:"btn btn-primary btn-block"},{default:(0,r.k6)((()=>t[2]||(t[2]=[(0,r.eW)("訂單管理")]))),_:1})]),(0,r.Lk)("div",Fa,[(0,r.bF)(n,{to:"/admin/users",class:"btn btn-primary btn-block"},{default:(0,r.k6)((()=>t[3]||(t[3]=[(0,r.eW)("使用者管理")]))),_:1})])]),(0,r.Lk)("div",Ea,[(0,r.Lk)("div",Pa,[t[4]||(t[4]=(0,r.Lk)("h4",null,"今日訂單數量",-1)),(0,r.bF)(d,null,{default:(0,r.k6)((()=>[(0,r.eW)((0,i.v_)(o.todayOrders),1)])),_:1})]),(0,r.Lk)("div",Sa,[t[5]||(t[5]=(0,r.Lk)("h4",null,"今日銷售金額",-1)),(0,r.bF)(d,null,{default:(0,r.k6)((()=>[(0,r.eW)((0,i.v_)(o.todaySales),1)])),_:1})]),(0,r.Lk)("div",Oa,[t[6]||(t[6]=(0,r.Lk)("h4",null,"昨日銷售金額",-1)),(0,r.bF)(d,null,{default:(0,r.k6)((()=>[(0,r.eW)((0,i.v_)(o.yesterdaySales),1)])),_:1})]),(0,r.Lk)("div",xa,[t[7]||(t[7]=(0,r.Lk)("h4",null,"過去七日銷售金額",-1)),(0,r.bF)(d,null,{default:(0,r.k6)((()=>[(0,r.eW)((0,i.v_)(o.last7DaySales),1)])),_:1})])]),t[12]||(t[12]=(0,r.Lk)("div",{class:"row mt-5"},[(0,r.Lk)("div",{class:"col-12"},[(0,r.Lk)("h4",null,"每日銷售趨勢圖"),(0,r.Lk)("canvas",{id:"salesChart"})])],-1)),(0,r.Lk)("div",Aa,[(0,r.Lk)("div",Ua,[t[8]||(t[8]=(0,r.Lk)("h4",null,"低庫存商品提醒",-1)),(0,r.Lk)("ul",null,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(o.lowStockProducts,((e,t)=>((0,r.uX)(),(0,r.CE)("li",{key:t},(0,i.v_)(e.name)+" - 銷售數量:"+(0,i.v_)(e.sales)+" ，庫存:"+(0,i.v_)(e.stock),1)))),128))])])]),(0,r.Lk)("div",Ta,[(0,r.Lk)("div",Da,[t[9]||(t[9]=(0,r.Lk)("h4",null,"今日註冊會員",-1)),(0,r.Lk)("p",null,(0,i.v_)(o.todayNewMembers),1)]),(0,r.Lk)("div",Xa,[t[10]||(t[10]=(0,r.Lk)("h4",null,"累積會員數",-1)),(0,r.Lk)("p",null,(0,i.v_)(o.totalMembers),1)])])])}var Ra=a(3456),$a={name:"AdminDashboard",data(){return{todayOrders:0,todaySales:0,yesterdaySales:0,last7DaySales:0,salesData:[],lowStockProducts:[],todayNewMembers:0,totalMembers:0,carouselImages:[],products:[],sevenDaySalesRanking:[],monthSalesRanking:[]}},async mounted(){await this.loadDashboardData(),this.renderSalesChart()},methods:{async loadDashboardData(){try{const e=await ie.A.get("/api/carousel_images");this.carouselImages=e.data||[];const[t,a,s,r]=await Promise.all([ie.A.get("/api/sales"),ie.A.get("/api/orders"),ie.A.get("/api/users"),ie.A.get("/api/products")]),o=t.data,l=a.data,n=s.data,i=r.data;this.products=i;const d=new Date,c=d.toISOString().split("T")[0],u=new Date;u.setDate(u.getDate()-1);const p=u.toISOString().split("T")[0],m=new Date;m.setDate(m.getDate()-7);const h=m.toISOString().split("T")[0];this.todaySales=o.filter((e=>e.sale_date.split("T")[0]===c)).reduce(((e,t)=>e+t.total_amount),0),this.yesterdaySales=o.filter((e=>e.sale_date.split("T")[0]===p)).reduce(((e,t)=>e+t.total_amount),0),this.last7DaySales=o.filter((e=>e.sale_date.split("T")[0]>=h&&e.sale_date.split("T")[0]<=c)).reduce(((e,t)=>e+t.total_amount),0);const b={};o.forEach((e=>{const t=e.sale_date.split("T")[0];b[t]?b[t]+=e.total_amount:b[t]=e.total_amount})),this.salesData=Object.keys(b).map((e=>({date:e,amount:b[e]}))).sort(((e,t)=>new Date(e.date)-new Date(t.date)));const k=l.filter((e=>e.orderDate>=h&&e.orderDate<=d)),g={};k.forEach((e=>{e.items.forEach((e=>{g[e.productId]?g[e.productId].sales+=e.quantity:g[e.productId]={name:e.productName,sales:e.quantity}}))})),this.sevenDaySalesRanking=Object.values(g).sort(((e,t)=>t.sales-e.sales)).slice(0,10);const v=new Date;v.setDate(v.getDate()-30);const f=v.toISOString().split("T")[0],L=l.filter((e=>e.orderDate>=f&&e.orderDate<=d)),y={};L.forEach((e=>{e.items.forEach((e=>{y[e.productId]?y[e.productId].sales+=e.quantity:y[e.productId]={name:e.productName,sales:e.quantity}}))})),this.monthSalesRanking=Object.values(y).sort(((e,t)=>t.sales-e.sales)).slice(0,10);const C=n.filter((e=>{const t=new Date(e.created_at).toISOString().split("T")[0];return t===d})).length;this.todayNewMembers=C,this.totalMembers=n.length,this.lowStockProducts=this.products.filter((e=>e.stock<=10)).map((e=>{const t=o.filter((t=>t.product_Id===e.id)).reduce(((e,t)=>e+t.quantity_sold),0);return{name:e.name,sales:t,stock:e.stock}}))}catch(e){console.error(e)}},getProductStock(e){const t=this.products.find((t=>t.id===e));return t?t.stock:0},prepareSalesData(e){const t={};e.forEach((e=>{t[e.orderDate]?t[e.orderDate]+=e.total:t[e.orderDate]=e.total}));const a=Object.keys(t).map((e=>({date:e,amount:t[e]}))).sort(((e,t)=>new Date(e.date)-new Date(t.date)));return a},async uploadCarouselImage(e){const t=e.target.files[0];if(!t)return;const a=new FormData;a.append("image",t);try{const e=await ie.A.post("/api/carousel-images",a,{headers:{"Content-Type":"multipart/form-data"}});this.carouselImages.push(e.data),alert("圖片上傳成功")}catch(s){console.error("圖片上傳失敗",s),alert("圖片上傳失敗!")}},renderSalesChart(){if(!this.salesData||0===this.salesData.length)return void console.error("銷售數據未加載！");const e=document.getElementById("salesChart").getContext("2d");new Ra.Ay(e,{type:"line",data:{labels:this.salesData.map((e=>e.date)),datasets:[{label:"銷售金額",data:this.salesData.map((e=>e.amount)),borderColor:"rgba(75,192,192,1)",borderWidth:2,fill:!1}]},options:{scales:{x:{title:{display:!0,text:"日期"}},y:{title:{display:!0,text:"銷售金額(元)"},beginAtZero:!0}}}})},deleteCarouselImage(e){confirm("確定要刪除這張圖片嗎？")&&ie.A.delete(`/api/carousel-image/${e}`).then((()=>{this.carouselImages=this.carouselImages.filter((t=>t.id!==e)),alert("圖片已刪除。")})).catch((e=>{console.error("圖片刪除失敗",e),alert("圖片刪除失敗！請稍後再試。")}))}}};const qa=(0,y.A)($a,[["render",Ma],["__scopeId","data-v-0a07dbcc"]]);var Na=qa;const Va={class:"admin-dashboard container mt-5"},Ba={class:"d-flex justify-content-end mb-3"},Wa={key:0,class:"accordion",id:"productAccordion"},Ka={class:"accordion-item"},Qa={class:"accordion-header",id:"headingProducts"},Ja={class:"accordion-body"},ja={class:"d-flex justify-content-between align-items-center mb-3"},Ha=["value"],za=["disabled"],Ga=["disabled"],Za={class:"table"},Ya=["onClick"],es={class:"row mt-5"},ts={class:"col-md-6"},as={class:"accordion",id:"tagAccordion"},ss={class:"accordion-item"},rs={class:"accordion-header",id:"headingTags"},os={class:"accordion-body"},ls={class:"d-flex justify-content-end mb-3"},ns={class:"table"},is=["onClick"],ds=["onClick"],cs={class:"col-md-6"},us={class:"accordion",id:"brandAccordion"},ps={class:"accordion-item"},ms={class:"accordion-header",id:"headingBrands"},hs={class:"accordion-body"},bs={class:"d-flex justify-content-end mb-3"},ks={class:"table"},gs=["onClick"],vs=["onClick"],fs={class:"modal fade",tabindex:"-1",ref:"tagModal"},Ls={class:"modal-dialog"},ys={class:"modal-content"},Cs={class:"modal-header"},ws={class:"modal-body"},_s={class:"modal-footer"},Is={class:"modal fade",tabindex:"-1",ref:"brandModal"},Fs={class:"modal-dialog"},Es={class:"modal-content"},Ps={class:"modal-header"},Ss={class:"modal-body"},Os={class:"modal-footer"};function xs(e,t,a,o,l,n){const d=(0,r.g2)("router-link");return(0,r.uX)(),(0,r.CE)(r.FK,null,[(0,r.Lk)("div",Va,[t[23]||(t[23]=(0,r.Lk)("h2",{class:"text-center"},"商品管理",-1)),(0,r.Lk)("div",Ba,[(0,r.bF)(d,{to:"/admin/CreateProduct",class:"btn btn-success"},{default:(0,r.k6)((()=>t[16]||(t[16]=[(0,r.eW)("新增商品")]))),_:1}),(0,r.bF)(d,{to:"/admin/SpecialOffers",class:"btn btn-primary"},{default:(0,r.k6)((()=>t[17]||(t[17]=[(0,r.eW)("特價商品管理")]))),_:1})]),l.isSectionOpen.products?((0,r.uX)(),(0,r.CE)("div",Wa,[(0,r.Lk)("div",Ka,[(0,r.Lk)("h2",Qa,[(0,r.Lk)("button",{class:"accordion-button",type:"button",onClick:t[0]||(t[0]=e=>n.toggleSection("products"))}," 商品管理 ")]),(0,r.Lk)("div",{class:(0,i.C4)(["accordion-collapse collapse show",{show:l.isSectionOpen.products}]),"aria-labelledby":"headingProducts","data-bs-parent":"#productAccordion"},[(0,r.Lk)("div",Ja,[(0,r.Lk)("div",ja,[(0,r.Lk)("div",null,[t[18]||(t[18]=(0,r.Lk)("label",{for:"itemsPerPage"},"每頁顯示：",-1)),(0,r.bo)((0,r.Lk)("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>l.itemsPerPage=e),id:"itemsPerPage"},[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(l.itemsPerPageOptions,(e=>((0,r.uX)(),(0,r.CE)("option",{key:e,value:e},(0,i.v_)(e),9,Ha)))),128))],512),[[s.u1,l.itemsPerPage,void 0,{number:!0}]])]),(0,r.Lk)("div",null,[(0,r.Lk)("button",{class:"btn btn-primary btn-sm me-2",disabled:1===l.currentPage,onClick:t[2]||(t[2]=e=>l.currentPage--)},"上一頁 ",8,za),(0,r.Lk)("span",null,"第 "+(0,i.v_)(l.currentPage)+" 頁，共 "+(0,i.v_)(n.totalPages)+" 頁",1),(0,r.Lk)("button",{class:"btn btn-primary btn-sm ms-2",disabled:l.currentPage===n.totalPages,onClick:t[3]||(t[3]=e=>l.currentPage++)},"下一頁 ",8,Ga)])]),(0,r.Lk)("table",Za,[t[20]||(t[20]=(0,r.Lk)("thead",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("th",null,"商品名稱"),(0,r.Lk)("th",null,"價格"),(0,r.Lk)("th",null,"庫存"),(0,r.Lk)("th",null,"描述"),(0,r.Lk)("th",null,"操作")])],-1)),(0,r.Lk)("tbody",null,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(n.paginatedProducts,((e,a)=>((0,r.uX)(),(0,r.CE)("tr",{key:e.id},[(0,r.Lk)("td",null,(0,i.v_)(e.name),1),(0,r.Lk)("td",null,(0,i.v_)(e.price),1),(0,r.Lk)("td",null,(0,i.v_)(e.stock),1),(0,r.Lk)("td",null,(0,i.v_)(e.description),1),(0,r.Lk)("td",null,[(0,r.bF)(d,{to:{name:"EditProduct",params:{id:e.id}},class:"btn btn-warning btn-sm"},{default:(0,r.k6)((()=>t[19]||(t[19]=[(0,r.eW)("編輯")]))),_:2},1032,["to"]),(0,r.Lk)("button",{class:"btn btn-danger btn-sm ms-2",onClick:t=>n.deleteProduct(e.id,a)},"刪除",8,Ya)])])))),128))])])])],2)])])):(0,r.Q3)("",!0),(0,r.Lk)("div",es,[(0,r.Lk)("div",ts,[(0,r.Lk)("div",as,[(0,r.Lk)("div",ss,[(0,r.Lk)("h2",rs,[(0,r.Lk)("button",{class:"accordion-button",type:"button",onClick:t[4]||(t[4]=e=>n.toggleSection("tags"))}," 標籤管理 ")]),(0,r.Lk)("div",{class:(0,i.C4)(["accordion-collapse collapse",{show:l.isSectionOpen.tags}]),"aria-labelledby":"headingTags","data-bs-parent":"#tagAccordion"},[(0,r.Lk)("div",os,[(0,r.Lk)("div",ls,[(0,r.Lk)("button",{class:"btn btn-success",onClick:t[5]||(t[5]=(...e)=>n.openCreateTagModal&&n.openCreateTagModal(...e))},"新增標籤")]),(0,r.Lk)("table",ns,[t[21]||(t[21]=(0,r.Lk)("thead",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("th",null,"標籤名稱"),(0,r.Lk)("th",null,"操作")])],-1)),(0,r.Lk)("tbody",null,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(l.tags,((e,t)=>((0,r.uX)(),(0,r.CE)("tr",{key:e.id},[(0,r.Lk)("td",null,(0,i.v_)(e.name),1),(0,r.Lk)("td",null,[(0,r.Lk)("button",{class:"btn btn-warning btn-sm",onClick:e=>n.openEditTagModal(t)},"編輯",8,is),(0,r.Lk)("button",{class:"btn btn-danger btn-sm ml-2",onClick:a=>n.deleteTag(e.id,t)},"刪除",8,ds)])])))),128))])])])],2)])])]),(0,r.Lk)("div",cs,[(0,r.Lk)("div",us,[(0,r.Lk)("div",ps,[(0,r.Lk)("h2",ms,[(0,r.Lk)("button",{class:"accordion-button",type:"button",onClick:t[6]||(t[6]=e=>n.toggleSection("brands"))}," 廠牌管理 ")]),(0,r.Lk)("div",{class:(0,i.C4)(["accordion-collapse collapse",{show:l.isSectionOpen.brands}]),"aria-labelledby":"headingBrands","data-bs-parent":"#brandAccordion"},[(0,r.Lk)("div",hs,[(0,r.Lk)("div",bs,[(0,r.Lk)("button",{class:"btn btn-success",onClick:t[7]||(t[7]=(...e)=>n.openCreateBrandModal&&n.openCreateBrandModal(...e))}," 新增廠牌 ")]),(0,r.Lk)("table",ks,[t[22]||(t[22]=(0,r.Lk)("thead",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("th",null,"廠牌名稱"),(0,r.Lk)("th",null,"操作")])],-1)),(0,r.Lk)("tbody",null,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(l.brands,((e,t)=>((0,r.uX)(),(0,r.CE)("tr",{key:e.id},[(0,r.Lk)("td",null,(0,i.v_)(e.name),1),(0,r.Lk)("td",null,[(0,r.Lk)("button",{class:"btn btn-warning btn-sm",onClick:e=>n.openEditBrandModal(t)},"編輯",8,gs),(0,r.Lk)("button",{class:"btn btn-danger btn-sm ml-2",onClick:a=>n.deleteBrand(e.id,t)},"刪除",8,vs)])])))),128))])])])],2)])])])])]),(0,r.Lk)("div",fs,[(0,r.Lk)("div",Ls,[(0,r.Lk)("div",ys,[(0,r.Lk)("div",Cs,[t[24]||(t[24]=(0,r.Lk)("h5",{class:"modal-title"},"編輯標籤",-1)),(0,r.Lk)("button",{type:"button",class:"btn-close",onClick:t[8]||(t[8]=(...e)=>n.closeTagModal&&n.closeTagModal(...e))})]),(0,r.Lk)("div",ws,[(0,r.bo)((0,r.Lk)("input",{type:"text","onUpdate:modelValue":t[9]||(t[9]=e=>l.tagForm.name=e),class:"form-control",placeholder:"標籤名稱"},null,512),[[s.Jo,l.tagForm.name]])]),(0,r.Lk)("div",_s,[(0,r.Lk)("button",{type:"button",class:"btn btn-secondary",onClick:t[10]||(t[10]=(...e)=>n.closeTagModal&&n.closeTagModal(...e))},"取消"),(0,r.Lk)("button",{type:"submit",class:"btn btn-primary",onClick:t[11]||(t[11]=(...e)=>n.saveTag&&n.saveTag(...e))},(0,i.v_)(l.isEditingTag?"保存變更":"新增標籤"),1)])])])],512),(0,r.Lk)("div",Is,[(0,r.Lk)("div",Fs,[(0,r.Lk)("div",Es,[(0,r.Lk)("div",Ps,[t[25]||(t[25]=(0,r.Lk)("h5",{class:"modal-title"},"編輯廠牌",-1)),(0,r.Lk)("button",{type:"button",class:"btn-close",onClick:t[12]||(t[12]=(...e)=>n.closeBrandModal&&n.closeBrandModal(...e))})]),(0,r.Lk)("div",Ss,[(0,r.bo)((0,r.Lk)("input",{type:"text","onUpdate:modelValue":t[13]||(t[13]=e=>l.brandForm.name=e),class:"form-control",placeholder:"廠牌名稱"},null,512),[[s.Jo,l.brandForm.name]])]),(0,r.Lk)("div",Os,[(0,r.Lk)("button",{class:"btn btn-secondary",onClick:t[14]||(t[14]=(...e)=>n.closeBrandModal&&n.closeBrandModal(...e))},"取消"),(0,r.Lk)("button",{class:"btn btn-primary",onClick:t[15]||(t[15]=(...e)=>n.saveBrand&&n.saveBrand(...e))},"保存")])])])],512)],64)}var As={name:"AdminProducts",data(){return{products:[],tags:[],brands:[],productForm:{name:"",price:0,stock:0,description:"",brand_id:"",tag_ids:[]},tagForm:{name:""},brandForm:{name:""},isEditing:!1,currentIndex:null,isEditingTag:!1,isEditingBrand:!1,currentPage:1,itemsPerPage:10,itemsPerPageOptions:[10,20,50],isSectionOpen:{products:!0,tags:!1,brands:!1}}},mounted(){this.loadProducts(),this.loadTags(),this.loadBrands()},computed:{paginatedProducts(){const e=(this.currentPage-1)*this.itemsPerPage,t=e+this.itemsPerPage;return this.products.slice(e,t)},totalPages(){return Math.ceil(this.products.length/this.itemsPerPage)}},methods:{toggleSection(e){this.isSectionOpen[e]=!this.isSectionOpen[e]},async loadProducts(){try{const e=await ie.A.get("/api/products");this.products=e.data,this.currentPage>this.totalPages&&(this.currentPage=this.totalPages||1)}catch(e){console.error("加載產品時出錯",e),alert("加載產品時出錯，請稍候再試！")}},async loadTags(){try{const e=await ie.A.get("/api/tags");this.tags=e.data}catch(e){console.error("加載標籤時錯誤",e),alert("加載標籤時錯誤，請稍候再試！")}},async loadBrands(){try{const e=await ie.A.get("/api/brands");this.brands=e.data}catch(e){console.error("加載廠牌時出錯",e),alert("加載廠牌時出錯，請稍候再試！")}},async saveTag(){try{if(this.isEditingTag)await ie.A.put(`/api/tags/${this.tagForm.id}`,this.tagForm),this.tags[this.currentIndex]={...this.tagForm};else{const e=await ie.A.post("/api/tags",this.tagForm);this.tags.push(e.data)}}catch(e){console.error("保存標籤時出錯！",e),alert("保存標籤時出錯，請稍候再試")}this.closeTagModal()},async saveBrand(){try{if(this.isEditingBrand)await ie.A.put(`/api/brands/${this.brandForm.id}`,this.brandForm),this.brands[this.currentIndex]={...this.brandForm};else{const e=await ie.A.post("/api/brands",this.brandForm);this.brands.push(e.data)}}catch(e){console.error("保存廠牌時出錯！",e),alert("保存廠牌時出錯，請稍候再試")}this.closeBrandModal()},async deleteProduct(e,t){if(confirm("確定要刪除此商品？"))try{await ie.A.delete(`/api/products/${e}`),this.products.splice(t,1)}catch(a){console.error("刪除產品時出錯",a),alert("刪除產品時出錯，請稍候再試！")}},async deleteTag(e,t){if(confirm("確定要刪除此標籤？"))try{await ie.A.delete(`/api/tags/${e}`),this.tags.splice(t,1)}catch(a){console.error("刪除標籤時出錯",a),alert("刪除標籤時出錯，請稍候再試！")}},async deleteBrand(e,t){if(confirm("確定要刪除此廠牌？"))try{await ie.A.delete(`/api/brands/${e}`),this.brands.splice(t,1)}catch(a){console.error("刪除廠牌時出錯",a),alert("刪除廠牌時出錯，請稍候再試！")}},openCreateTagModal(){this.isEditingTag=!1,this.tagForm={name:""},this.$nextTick((()=>{const e=new U.aF(this.$refs.tagModal);e.show()}))},openCreateBrandModal(){this.isEditingBrand=!1,this.brandForm={name:""},this.$nextTick((()=>{const e=new U.aF(this.$refs.brandModal);e.show()}))},openEditTagModal(e){this.isEditingTag=!0,this.currentIndex=e,this.tagForm={...this.tags[e]};const t=new U.aF(this.$refs.tagModal);t.show()},openEditBrandModal(e){this.isEditingBrand=!0,this.currentIndex=e,this.brandForm={...this.brands[e]};const t=new U.aF(this.$refs.brandModal);t.show()},closeTagModal(){const e=U.aF.getInstance(this.$refs.tagModal);e&&e.hide()},closeBrandModal(){const e=U.aF.getInstance(this.$refs.brandModal);e&&e.hide()}},watch:{itemsPerPage(){this.currentPage=1}}};const Us=(0,y.A)(As,[["render",xs],["__scopeId","data-v-a8492868"]]);var Ts=Us;const Ds={class:"admin-dashboard container mt-5"},Xs={class:"admin-users container mt-5"},Ms={class:"table table-hover"},Rs=["onClick"],$s=["onClick"],qs={key:0},Ns={colspan:"4"},Vs={class:"recipient-card"},Bs=["onClick"],Ws=["onClick"],Ks={class:"modal fade",tabindex:"-1",ref:"userModal"},Qs={class:"modal-dialog"},Js={class:"modal-content"},js={class:"modal-header"},Hs={class:"modal-title"},zs={class:"modal-body"},Gs={class:"mb-3"},Zs={class:"mb-3"},Ys={class:"mb-3"},er={key:0},tr={class:"mb-3"},ar=["required"],sr=["required"],rr={class:"modal-footer"};function or(e,t,a,o,l,n){return(0,r.uX)(),(0,r.CE)("div",Ds,[t[21]||(t[21]=(0,r.Lk)("h2",{class:"text-center"},"用戶管理",-1)),(0,r.Lk)("div",Xs,[(0,r.Lk)("button",{class:"btn btn-success",onClick:t[0]||(t[0]=(...e)=>n.openCreateUserModal&&n.openCreateUserModal(...e))},"新增用戶")]),(0,r.Lk)("table",Ms,[t[14]||(t[14]=(0,r.Lk)("thead",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("th",null,"用戶名"),(0,r.Lk)("th",null,"電子信箱"),(0,r.Lk)("th",null,"權限"),(0,r.Lk)("th",null,"操作")])],-1)),(0,r.Lk)("tbody",null,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(l.users,((a,s)=>((0,r.uX)(),(0,r.CE)(r.FK,{key:s},[(0,r.Lk)("tr",null,[(0,r.Lk)("td",null,(0,i.v_)(a.name),1),(0,r.Lk)("td",null,(0,i.v_)(a.email),1),(0,r.Lk)("td",null,(0,i.v_)(a.role),1),(0,r.Lk)("td",null,[(0,r.Lk)("button",{class:"btn btn-warning btn-sm",onClick:e=>n.openEditUserModal(s)},"編輯",8,Rs),(0,r.Lk)("button",{class:"btn btn-danger btn-sm ml-2",onClick:e=>n.deleteUser(s)},"刪除",8,$s)])]),a.recipients&&Array.isArray(a.recipients)?((0,r.uX)(),(0,r.CE)("tr",qs,[(0,r.Lk)("td",Ns,[(0,r.Lk)("div",Vs,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(a.recipients,((a,o)=>((0,r.uX)(),(0,r.CE)("div",{key:o},[t[10]||(t[10]=(0,r.Lk)("strong",null,"收件人名稱:",-1)),(0,r.eW)(" "+(0,i.v_)(a.name)+" ",1),t[11]||(t[11]=(0,r.Lk)("strong",null,"電話:",-1)),(0,r.eW)(" "+(0,i.v_)(a.phone)+" ",1),t[12]||(t[12]=(0,r.Lk)("strong",null,"地址:",-1)),(0,r.eW)(" "+(0,i.v_)(a.address)+" ",1),(0,r.Lk)("button",{class:"btn btn-sm btn-warning",onClick:t=>e.editRecipient(s,o)},"編輯收件人",8,Bs),(0,r.Lk)("button",{class:"btn btn-sm btn-danger",onClick:t=>e.deleteRecipient(s,o)},"刪除",8,Ws),t[13]||(t[13]=(0,r.Lk)("br",null,null,-1))])))),128))])])])):(0,r.Q3)("",!0)],64)))),128))])]),(0,r.Lk)("div",Ks,[(0,r.Lk)("div",Qs,[(0,r.Lk)("div",Js,[(0,r.Lk)("div",js,[(0,r.Lk)("h5",Hs,(0,i.v_)(l.isEditing?"編輯用戶":"新增用戶"),1),(0,r.Lk)("button",{type:"button",class:"btn-close",onClick:t[1]||(t[1]=(...e)=>n.closeModal&&n.closeModal(...e))})]),(0,r.Lk)("div",zs,[(0,r.Lk)("form",{onSubmit:t[7]||(t[7]=(0,s.D$)(((...e)=>n.saveUser&&n.saveUser(...e)),["prevent"]))},[(0,r.Lk)("div",Gs,[t[15]||(t[15]=(0,r.Lk)("label",{for:"userName",class:"form-label"},"用戶名",-1)),(0,r.bo)((0,r.Lk)("input",{type:"text",class:"form-control",id:"userName","onUpdate:modelValue":t[2]||(t[2]=e=>l.userForm.name=e),required:""},null,512),[[s.Jo,l.userForm.name]])]),(0,r.Lk)("div",Zs,[t[16]||(t[16]=(0,r.Lk)("label",{for:"userEmail",class:"form-label"},"電子郵件",-1)),(0,r.bo)((0,r.Lk)("input",{type:"email",class:"form-control",id:"userEmail","onUpdate:modelValue":t[3]||(t[3]=e=>l.userForm.email=e),required:""},null,512),[[s.Jo,l.userForm.email]])]),(0,r.Lk)("div",Ys,[t[18]||(t[18]=(0,r.Lk)("label",{for:"userName",class:"form-label"},"權限",-1)),(0,r.bo)((0,r.Lk)("select",{id:"userRole",class:"form-select","onUpdate:modelValue":t[4]||(t[4]=e=>l.userForm.role=e)},t[17]||(t[17]=[(0,r.Lk)("option",{value:"user"},"用戶",-1),(0,r.Lk)("option",{value:"admin"},"管理者",-1)]),512),[[s.u1,l.userForm.role]])]),"user"===l.userForm.role?((0,r.uX)(),(0,r.CE)("div",er,[(0,r.Lk)("div",tr,[t[19]||(t[19]=(0,r.Lk)("label",{for:"userPhone",class:"form-label"},"電話",-1)),(0,r.bo)((0,r.Lk)("input",{type:"text",class:"form-control",id:"userPhone","onUpdate:modelValue":t[5]||(t[5]=e=>l.userForm.phone=e),required:"user"===l.userForm.role},null,8,ar),[[s.Jo,l.userForm.phone]])]),(0,r.Lk)("div",null,[t[20]||(t[20]=(0,r.Lk)("label",{for:"userAddress",class:"form-label"},"地址",-1)),(0,r.bo)((0,r.Lk)("input",{type:"text",class:"form-control",id:"userAddress","onUpdate:modelValue":t[6]||(t[6]=e=>l.userForm.address=e),required:"user"===l.userForm.role},null,8,sr),[[s.Jo,l.userForm.address]])])])):(0,r.Q3)("",!0)],32),(0,r.Lk)("div",rr,[(0,r.Lk)("button",{type:"button",class:"btn btn-secondary",onClick:t[8]||(t[8]=(...e)=>n.closeModal&&n.closeModal(...e))},"取消"),(0,r.Lk)("button",{type:"submit",class:"btn btn-primary",onClick:t[9]||(t[9]=(...e)=>n.saveUser&&n.saveUser(...e))},(0,i.v_)(l.isEditing?"保存變更":"新增用戶"),1)])])])])],512)])}var lr={name:"AdminUsers",data(){return{users:[],userForm:{name:"",email:"",role:"user"},isEditing:!1,currentIndex:null}},mounted(){this.loadUsers()},methods:{async loadUsers(){try{const e=await ie.A.get("/api/users");this.users=e.data}catch(e){console.error("加載用戶資料失敗",e),alert("無法家載用戶資料")}},openCreateUserModal(){this.isEditing=!1,this.userForm={name:"",email:"",role:"user",phone:"",address:""},this.$nextTick((()=>{const e=new U.aF(this.$refs.userModal);e.show()}))},openEditUserModal(e){this.isEditing=!0,this.currentIndex=e,this.userForm={...this.users[e]};const t=new U.aF(this.$refs.userModal);t.show()},async saveUser(){try{if(this.isEditing)await ie.A.put(`/api/users/${this.userForm.id}`,this.userForm),this.users[this.currentIndex]={...this.userForm};else{const e=await ie.A.post("/api/users",this.userForm);this.users.push(e.data)}this.closeModal()}catch(e){console.error("更新用戶資料時錯誤！",e),alert("更新用戶資料失敗！")}},async deleteUser(e){if(confirm("確定要刪除此用戶嗎？"))try{await ie.A.delete(`/api/users/${this.users[e].id}`),this.users.splice(e,1)}catch(t){alert("無法刪除用戶")}},closeModal(){this.$nextTick((()=>{const e=U.aF.getInstance(this.$refs.userModal);e&&e.hide()}))}}};const nr=(0,y.A)(lr,[["render",or]]);var ir=nr;const dr={class:"admin-dashboard container mt-5"},cr={class:"filters d-flex justify-content-between mb-3"},ur={class:"table table-hover"},pr=["onClick"],mr=["onClick","disabled","title"],hr={key:0},br={class:"d-flex justify-content-center align-items-center"},kr=["disabled"],gr=["disabled"];function vr(e,t,a,o,l,n){return(0,r.uX)(),(0,r.CE)("div",dr,[t[8]||(t[8]=(0,r.Lk)("h2",{class:"text-center"},"訂單管理",-1)),(0,r.Lk)("div",cr,[(0,r.bo)((0,r.Lk)("input",{type:"text",class:"form-control me-2",placeholder:"搜尋訂單號或用戶名","onUpdate:modelValue":t[0]||(t[0]=e=>l.searchQuery=e)},null,512),[[s.Jo,l.searchQuery]]),(0,r.bo)((0,r.Lk)("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>l.selectedStatus=e),class:"form-select me-2","aria-label":"訂單狀態篩選"},t[5]||(t[5]=[(0,r.Fv)('<option value="" data-v-534511c0>全部狀態</option><option value="pending" data-v-534511c0>待確認</option><option value="shipped" data-v-534511c0>已發貨</option><option value="completed" data-v-534511c0>已完成</option><option value="cancelled" data-v-534511c0>已取消</option>',5)]),512),[[s.u1,l.selectedStatus]]),(0,r.Lk)("button",{class:"btn btn-primary",onClick:t[2]||(t[2]=(...e)=>n.filterOrders&&n.filterOrders(...e))},"篩選")]),(0,r.Lk)("table",ur,[t[7]||(t[7]=(0,r.Lk)("thead",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("th",null,"訂單號"),(0,r.Lk)("th",null,"用戶編號"),(0,r.Lk)("th",null,"總金額"),(0,r.Lk)("th",null,"訂單狀態"),(0,r.Lk)("th",null,"建立日期"),(0,r.Lk)("th",null,"操作")])],-1)),(0,r.Lk)("tbody",null,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(n.paginatedOrders,(e=>((0,r.uX)(),(0,r.CE)("tr",{key:e.id},[(0,r.Lk)("td",null,(0,i.v_)(e.id),1),(0,r.Lk)("td",null,(0,i.v_)(e.userId),1),(0,r.Lk)("td",null,(0,i.v_)(n.formatCurrency(e.total)),1),(0,r.Lk)("td",null,(0,i.v_)(n.formatStatus(e.status)),1),(0,r.Lk)("td",null,(0,i.v_)(n.formatDate(e.orderDate)),1),(0,r.Lk)("td",null,[(0,r.Lk)("button",{class:"btn btn-info btn-sm me-2",onClick:t=>n.viewOrderDetails(e)},"查看",8,pr),(0,r.Lk)("button",{class:"btn btn-danger btn-sm",onClick:t=>n.cancelOrder(e),disabled:"cancelled"===e.status||"completed"===e.status,title:"cancelled"===e.status||"completed"===e.status?"無法取消或已取消的訂單":"取消訂單"}," 取消訂單 ",8,mr)])])))),128)),0===n.paginatedOrders.length?((0,r.uX)(),(0,r.CE)("tr",hr,t[6]||(t[6]=[(0,r.Lk)("td",{colspan:"6",class:"text-center"},"沒有符合條件的訂單。",-1)]))):(0,r.Q3)("",!0)])]),(0,r.Lk)("div",br,[(0,r.Lk)("button",{class:"btn btn-outline-primary me-2",onClick:t[3]||(t[3]=(...e)=>n.prevPage&&n.prevPage(...e)),disabled:1===l.currentPage},"上一頁",8,kr),(0,r.Lk)("span",null,(0,i.v_)(l.currentPage)+" / "+(0,i.v_)(n.totalPages)+"頁",1),(0,r.Lk)("button",{class:"btn btn-outline-primary ms-2",onClick:t[4]||(t[4]=(...e)=>n.nextPage&&n.nextPage(...e)),disabled:l.currentPage===n.totalPages},"下一頁",8,gr)])])}var fr=a(2952),Lr=a.n(fr),yr={name:"AdminOrders",data(){return{orders:[],users:[],searchQuery:"",selectedStatus:"",currentPage:1,itemsPerPage:10,debouncedFilter:null}},computed:{filteredOrders(){return this.orders.filter((e=>{const t=e.userId&&e.userId.toString().toLowerCase().includes(this.searchQuery.toLowerCase())||e.id&&e.id.toString().toLowerCase().includes(this.searchQuery.toLowerCase()),a=!this.selectedStatus||e.status===this.selectedStatus;return t&&a}))},totalPages(){return Math.ceil(this.filteredOrders.length/this.itemsPerPage)||1},paginatedOrders(){const e=(this.currentPage-1)*this.itemsPerPage,t=this.currentPage*this.itemsPerPage;return this.filteredOrders.slice(e,t)}},methods:{async fetchOrders(){try{const e=await ie.A.get("/api/orders");console.log("API回傳的訂單資料",e.data);const t=e.data.orders||e.data;this.orders=t.map((e=>({...e,status:e.status||"pending"})))||[]}catch(e){console.error("加載訂單時出錯",e),alert("加載訂單時出錯"),this.orders=[]}},async fetchUsers(){try{const e=await ie.A.get("/api/users");this.users=e.data.users||[]}catch(e){console.error("加載用戶時出錯",e),alert("加載用戶時出錯，請稍候再試！"),this.users=[]}},viewOrderDetails(e){console.log("查看訂單",e),this.$router.push({name:"OrderDetail",params:{id:e.id}})},async cancelOrder(e){if(confirm("確定要取消這個訂單？"))try{await ie.A.put(`/api/orders/${e.id}/cancel`),e.status="cancelled",alert("訂單已成功取消。")}catch(t){console.error("取消訂單時出錯",t),alert("取消訂單時出錯")}},prevPage(){this.currentPage>1&&this.currentPage--},nextPage(){this.currentPage<this.totalPages&&this.currentPage++},formatCurrency(e){return new Intl.NumberFormat("zh-TW",{style:"currency",currency:"TWD"}).format(e)},formatStatus(e){const t={pending:"待確認",shipped:"已發貨",completed:"已完成",cancelled:"已取消"};return t[e]||"未知狀態"},formatDate(e){const t={year:"numeric",month:"2-digit",day:"2-digit"};return new Date(e).toLocaleDateString("zh-TW",t)},filterOrders(){this.currentPage=1},getUserName(e){const t=this.users.find((t=>t.id==e));return t?t.name:"未知用戶"}},mounted(){this.fetchOrders(),this.fetchUsers(),this.debouncedFilter=Lr()(this.filterOrders,300)},watch:{searchQuery(){this.debouncedFilter()},selectedStatus(){this.debouncedFilter()}}};const Cr=(0,y.A)(yr,[["render",vr],["__scopeId","data-v-534511c0"]]);var wr=Cr;const _r={class:"container mt-5"},Ir={class:"mb-3"},Fr={class:"mb-3"},Er={class:"mb-3"},Pr={class:"mb-3"},Sr={class:"mb-3"},Or={key:0,class:"text-danger"},xr={class:"mb-3"},Ar={key:0,class:"text-danger"},Ur={class:"mb-3"},Tr={key:0},Dr=["src"];function Xr(e,t,a,o,l,n){const i=(0,r.g2)("multiselect");return(0,r.uX)(),(0,r.CE)("div",_r,[t[17]||(t[17]=(0,r.Lk)("h2",{class:"text-center mb-4"},"新增商品",-1)),(0,r.Lk)("form",{onSubmit:t[7]||(t[7]=(0,s.D$)(((...e)=>n.createProduct&&n.createProduct(...e)),["prevent"]))},[(0,r.Lk)("div",Ir,[t[8]||(t[8]=(0,r.Lk)("label",{for:"productName",class:"form-label"},"商品名稱",-1)),(0,r.bo)((0,r.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>l.productForm.name=e),class:"form-control",required:""},null,512),[[s.Jo,l.productForm.name]])]),(0,r.Lk)("div",Fr,[t[9]||(t[9]=(0,r.Lk)("label",{for:"description",class:"form-label"},"商品描述",-1)),(0,r.bo)((0,r.Lk)("textarea",{"onUpdate:modelValue":t[1]||(t[1]=e=>l.productForm.description=e),class:"form-control",required:""},null,512),[[s.Jo,l.productForm.description]])]),(0,r.Lk)("div",Er,[t[10]||(t[10]=(0,r.Lk)("label",{for:"price",class:"form-label"},"價格",-1)),(0,r.bo)((0,r.Lk)("input",{type:"number","onUpdate:modelValue":t[2]||(t[2]=e=>l.productForm.price=e),class:"form-control",required:""},null,512),[[s.Jo,l.productForm.price]])]),(0,r.Lk)("div",Pr,[t[11]||(t[11]=(0,r.Lk)("label",{for:"stock",class:"form-label"},"庫存",-1)),(0,r.bo)((0,r.Lk)("input",{type:"number","onUpdate:modelValue":t[3]||(t[3]=e=>l.productForm.stock=e),class:"form-control",required:""},null,512),[[s.Jo,l.productForm.stock]])]),(0,r.Lk)("div",Sr,[t[12]||(t[12]=(0,r.Lk)("label",{for:"brand_id",class:"form-label"},"選擇品牌",-1)),(0,r.bF)(i,{modelValue:l.productForm.brand_id,"onUpdate:modelValue":t[4]||(t[4]=e=>l.productForm.brand_id=e),options:l.brands,label:"name",placeholder:"搜尋或選擇品牌"},null,8,["modelValue","options"]),!l.productForm.brand_id&&l.formSubmitted?((0,r.uX)(),(0,r.CE)("span",Or,"請選擇品牌")):(0,r.Q3)("",!0)]),(0,r.Lk)("div",xr,[t[13]||(t[13]=(0,r.Lk)("label",{for:"tag_ids",class:"form-label"},"選擇標籤",-1)),(0,r.bF)(i,{modelValue:l.productForm.tag_ids,"onUpdate:modelValue":t[5]||(t[5]=e=>l.productForm.tag_ids=e),options:l.tags,label:"name",multiple:!0,placeholder:"搜尋或選擇標籤"},null,8,["modelValue","options"]),!l.productForm.tag_ids.length&&l.formSubmitted?((0,r.uX)(),(0,r.CE)("span",Ar,"請選擇至少一個標籤")):(0,r.Q3)("",!0)]),(0,r.Lk)("div",Ur,[t[14]||(t[14]=(0,r.Lk)("label",{for:"productImage",class:"form-label"},null,-1)),(0,r.Lk)("input",{type:"file",class:"form-control",id:"productImage",onChange:t[6]||(t[6]=(...e)=>n.selectImage&&n.selectImage(...e)),accept:"image/*"},null,32)]),l.productForm.imagePreview?((0,r.uX)(),(0,r.CE)("div",Tr,[t[15]||(t[15]=(0,r.Lk)("h5",null,"圖片預覽",-1)),(0,r.Lk)("img",{src:l.productForm.imagePreview,alt:"商品圖片",style:{"max-width":"200px"}},null,8,Dr)])):(0,r.Q3)("",!0),t[16]||(t[16]=(0,r.Lk)("button",{type:"submit",class:"btn btn-primary"},"新增商品",-1))],32)])}a(4603),a(7566),a(8721);var Mr=a(8074),Rr={name:"CreateProduct",components:{Multiselect:Mr.Ay},data(){return{productForm:{name:"",description:"",price:0,stock:0,brand_id:null,tag_ids:[],created_at:"",imageFile:null,imagePreview:""},brands:[],tags:[],formSubmitted:!1}},mounted(){this.loadBrands(),this.loadTags()},methods:{async loadBrands(){try{const e=await ie.A.get("/api/brands");this.brands=e.data}catch(e){console.error("讀取品牌資料時出錯:",e)}},async loadTags(){try{const e=await ie.A.get("/api/tags");this.tags=e.data}catch(e){console.error("讀取標籤資料時出錯:",e)}},async createProduct(){if(this.formSubmitted=!0,this.productForm.brand_id&&this.productForm.tag_ids.length)try{const e=(new Date).toISOString().split("T")[0];this.productForm.created_at=e;const t=new FormData;t.append("name",this.productForm.name),t.append("description",this.productForm.description),t.append("price",this.productForm.price),t.append("stock",this.productForm.stock),t.append("brand_id",this.productForm.brand_id),t.append("tag_ids",JSON.stringify(this.productForm.tag_ids.map((e=>e.id||e)))),t.append("created_at",this.productForm.created_at),this.productForm.imageFile&&t.append("image",this.productForm.imageFile);const a=await ie.A.post("/api/products",t,{headers:{"Content-Type":"multipart/form-data"}});console.log("伺服器回應：",a.data),alert("商品新增成功"),this.$router.push("/admin/products")}catch(e){console.error("新增商品時出錯:",e),alert("新增商品失敗，請稍後再試")}else alert("請選擇品牌和標籤")},selectImage(e){const t=e.target.files[0];t&&(this.productForm.imageFile=t,this.productForm.image=URL.createObjectURL(t))}}};const $r=(0,y.A)(Rr,[["render",Xr],["__scopeId","data-v-1ac9c35a"]]);var qr=$r;const Nr={class:"container mt-5"},Vr={class:"mb-3"},Br={class:"mb-3"},Wr={class:"mb-3"},Kr={class:"mb-3"},Qr={class:"mb-3"},Jr={class:"mb-3"};function jr(e,t,a,o,l,n){const i=(0,r.g2)("v-select");return(0,r.uX)(),(0,r.CE)("div",Nr,[t[13]||(t[13]=(0,r.Lk)("h2",{class:"text-center"},"編輯產品資訊",-1)),(0,r.Lk)("form",{onSubmit:t[5]||(t[5]=(0,s.D$)(((...e)=>n.updateProduct&&n.updateProduct(...e)),["prevent"]))},[(0,r.Lk)("div",Vr,[t[6]||(t[6]=(0,r.Lk)("label",{for:"productName",class:"form-label"},"商品名稱",-1)),(0,r.bo)((0,r.Lk)("input",{type:"text",id:"productName",class:"form-control","onUpdate:modelValue":t[0]||(t[0]=e=>l.product.name=e),required:""},null,512),[[s.Jo,l.product.name]])]),(0,r.Lk)("div",Br,[t[7]||(t[7]=(0,r.Lk)("label",{for:"productPrice",class:"form-label"},"價格",-1)),(0,r.bo)((0,r.Lk)("input",{type:"number",id:"productPrice",class:"form-control","onUpdate:modelValue":t[1]||(t[1]=e=>l.product.price=e),required:""},null,512),[[s.Jo,l.product.price]])]),(0,r.Lk)("div",Wr,[t[8]||(t[8]=(0,r.Lk)("label",{for:"productStock",class:"form-label"},"庫存",-1)),(0,r.bo)((0,r.Lk)("input",{type:"number",id:"productStock",class:"form-control","onUpdate:modelValue":t[2]||(t[2]=e=>l.product.stock=e),required:""},null,512),[[s.Jo,l.product.stock]])]),(0,r.Lk)("div",Kr,[t[9]||(t[9]=(0,r.Lk)("label",{for:"productDescription",class:"form-label"},"描述",-1)),(0,r.bo)((0,r.Lk)("textarea",{id:"productDescription",class:"form-control","onUpdate:modelValue":t[3]||(t[3]=e=>l.product.description=e),required:""},null,512),[[s.Jo,l.product.description]])]),(0,r.Lk)("div",Qr,[t[10]||(t[10]=(0,r.Lk)("label",{for:"productBrand",class:"form-label"},"廠牌",-1)),(0,r.bF)(i,{options:l.brands,label:"name",placeholder:"請選擇廠牌",reduce:e=>e.id,onInput:n.updateBrandId,required:""},null,8,["options","reduce","onInput"])]),(0,r.Lk)("div",Jr,[t[11]||(t[11]=(0,r.Lk)("label",{for:"productTags",class:"form-label"},"標籤",-1)),(0,r.bF)(i,{options:l.tags,label:"name",modelValue:l.selectedTags,"onUpdate:modelValue":t[4]||(t[4]=e=>l.selectedTags=e),placeholder:"請選擇標籤",multiple:"",reduce:e=>e.id,onInput:n.updateTagIds},null,8,["options","modelValue","reduce","onInput"])]),t[12]||(t[12]=(0,r.Lk)("button",{type:"submit",class:"btn btn-primary"},"更新產品",-1))],32)])}var Hr=a(961),zr={name:"EditProduct",components:{vSelect:Hr.A},data(){return{product:{id:null,name:"",price:0,stock:0,description:"",brand_id:"",tag_ids:[]},brands:[],tags:[],selectedBrand:null,selectedTags:[]}},async mounted(){await Promise.all([this.loadProduct(),this.loadBrands(),this.loadTags()])},methods:{async loadProduct(){const e=this.$route.params.id;try{const t=await ie.A.get(`/api/products/${e}`);this.product={...t.data,tag_ids:Array.isArray(t.data.tag_ids)?t.data.tag_ids:[]},this.$nextTick((()=>{this.selectedBrand=this.brands.find((e=>e.id===this.product.brand_id))||null})),this.selectedTags=this.tags.filter((e=>this.product.tag_ids&&this.product.tag_ids.includes(e.id)))}catch(t){console.error("加載產品時出錯",t),alert("加載產品時出錯，請稍候再試！")}},async loadBrands(){try{const e=await ie.A.get("/api/brands");this.brands=e.data,this.product.brand_id&&(this.selectedBrand=this.brands.find((e=>e.id===this.product.brand_id))||null)}catch(e){console.error("加載廠牌時出錯",e)}},async loadTags(){try{const e=await ie.A.get("/api/tags");this.tags=e.data,this.product.tag_ids.length>0&&(this.selectedTags=this.tags.filter((e=>this.product.tag_ids.includes(e.id))))}catch(e){console.error("加載標籤時錯誤",e),alert("加載標籤時出錯，請稍候再試！")}},async updateProduct(){try{await ie.A.put(`/api/products/${this.product.id}`,this.product),alert("產品更新成功！"),this.$router.push({name:"AdminProducts"})}catch(e){console.error("更新商品時出錯",e),alert("商品更新失敗！")}},updateBrandId(e){this.product.brand_id=e},updateTagIds(e){this.product.tag_ids=e}},watch:{brand(e){this.product.brand_id&&(this.selectedBrand=e.find((e=>e.id===this.product.brand_id))||null)},tags(e){Array.isArray(this.product.tag_ids)&&this.product.tag_ids.length>0&&(this.selectedTags=e.filter((e=>this.product.tag_ids.includes(e.id))))}}};const Gr=(0,y.A)(zr,[["render",jr]]);var Zr=Gr;function Yr(e,t,a,s,o,l){return(0,r.uX)(),(0,r.CE)("h5",null,"AdminContact")}var eo={name:"AdminContact"};const to=(0,y.A)(eo,[["render",Yr]]);var ao=to;const so={class:"order-detail container mt-5"},ro={key:0},oo={class:"order-info mb-4"},lo={class:"mb-3"},no={class:"table table-bordered"},io={key:1};function co(e,t,a,o,l,n){return(0,r.uX)(),(0,r.CE)("div",so,[t[12]||(t[12]=(0,r.Lk)("h2",{class:"text-center"},"訂單詳情",-1)),l.order?((0,r.uX)(),(0,r.CE)("div",ro,[(0,r.Lk)("div",oo,[(0,r.Lk)("p",null,[t[3]||(t[3]=(0,r.Lk)("strong",null,"訂單號：",-1)),(0,r.eW)((0,i.v_)(l.order.id),1)]),(0,r.Lk)("p",null,[t[4]||(t[4]=(0,r.Lk)("strong",null,"用戶名：",-1)),(0,r.eW)((0,i.v_)(l.userName),1)]),(0,r.Lk)("p",null,[t[5]||(t[5]=(0,r.Lk)("strong",null,"建立日期：",-1)),(0,r.eW)((0,i.v_)(n.formatDate(l.order.orderDate)),1)]),(0,r.Lk)("p",null,[t[6]||(t[6]=(0,r.Lk)("strong",null,"總金額：",-1)),(0,r.eW)((0,i.v_)(n.formatCurrency(l.order.total)),1)]),(0,r.Lk)("div",lo,[t[8]||(t[8]=(0,r.Lk)("label",{for:"orderStatus",class:"form-label"},[(0,r.Lk)("strong",null,"訂單狀態：")],-1)),(0,r.bo)((0,r.Lk)("select",{id:"orderStatus","onUpdate:modelValue":t[0]||(t[0]=e=>l.order.status=e),class:"form-select",onChange:t[1]||(t[1]=(...e)=>n.updateOrderStatus&&n.updateOrderStatus(...e))},t[7]||(t[7]=[(0,r.Lk)("option",{value:"pending"},"待確認",-1),(0,r.Lk)("option",{value:"shipped"},"已發貨",-1),(0,r.Lk)("option",{value:"completed"},"已完成",-1),(0,r.Lk)("option",{value:"cancelled"},"已取消",-1)]),544),[[s.u1,l.order.status]])])]),t[10]||(t[10]=(0,r.Lk)("h4",null,"商品列表",-1)),(0,r.Lk)("table",no,[t[9]||(t[9]=(0,r.Lk)("thead",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("th",null,"商品名稱"),(0,r.Lk)("th",null,"數量"),(0,r.Lk)("th",null,"單價"),(0,r.Lk)("th",null,"小計")])],-1)),(0,r.Lk)("tbody",null,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(l.order.items,(e=>((0,r.uX)(),(0,r.CE)("tr",{key:e.productId},[(0,r.Lk)("td",null,(0,i.v_)(e.productName),1),(0,r.Lk)("td",null,(0,i.v_)(e.quantity),1),(0,r.Lk)("td",null,(0,i.v_)(n.formatCurrency(e.price)),1),(0,r.Lk)("td",null,(0,i.v_)(n.formatCurrency(e.price*e.quantity)),1)])))),128))])]),(0,r.Lk)("button",{class:"btn btn-secondary mt-3",onClick:t[2]||(t[2]=(...e)=>n.goBack&&n.goBack(...e))},"返回")])):((0,r.uX)(),(0,r.CE)("div",io,t[11]||(t[11]=[(0,r.Lk)("p",null,"正在加載訂單詳情...",-1)])))])}var uo={name:"OrderDetail",props:["id"],data(){return{order:null,userName:""}},methods:{async fetchOrderDetails(e){try{const t=await ie.A.get(`/api/orders/${e}`);this.order=t.data.order||t.data,this.fetchUserName(this.order.userId)}catch(t){console.error("加載訂單詳情時出錯",t),alert("加載訂單詳情時出錯，請稍候再試！"),this.order=null}},async fetchUserName(e){try{const t=await ie.A.get(`/api/users/${e}`),a=t.data.user||t.data;this.userName=a.name||"未知用戶"}catch(t){console.error("加載用戶資訊時出錯",t),this.userName="未知用戶"}},formatCurrency(e){return new Intl.NumberFormat("zh-TW",{style:"currency",currency:"TWD"}).format(e)},formatDate(e){const t={year:"numeric",month:"2-digit",day:"2-digit"};return new Date(e).toLocaleDateString("zh-TW",t)},async updateOrderStatus(){if(this.order)try{await ie.A.put(`/api/orders/${this.order.id}`,this.order),alert("訂單狀態已更新")}catch(e){console.error("更新訂單狀態時出錯",e),alert("更新訂單狀態時出錯，請稍候再試！")}},goBack(){this.$router.go(-1)}},mounted(){const e=this.id||this.$route.params.id;this.fetchOrderDetails(e)}};const po=(0,y.A)(uo,[["render",co],["__scopeId","data-v-0c8f286e"]]);var mo=po;const ho={class:"carousel-management container mt-5"},bo={class:"carousel-image-list d-flex flex-wrap"},ko=["src"],go=["onClick"],vo={class:"me-2"},fo=["onClick"],Lo={class:"upload-section mt-4"},yo={key:0,class:"preview-section mt-3"},Co=["src"],wo={class:"mt-2"};function _o(e,t,a,s,o,l){return(0,r.uX)(),(0,r.CE)("div",ho,[t[5]||(t[5]=(0,r.Lk)("h2",{class:"text-center"},"輪播圖片管理",-1)),(0,r.Lk)("div",bo,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(o.carouselImages,(e=>((0,r.uX)(),(0,r.CE)("div",{key:e.id,class:"carousel-image-item m-2"},[(0,r.Lk)("img",{src:e.url,alt:"輪播圖片",class:"img-thumbnail"},null,8,ko),(0,r.Lk)("button",{class:"btn btn-danger btn-sm mt-2",onClick:t=>l.deleteCarouselImage(e.id)},"刪除圖片",8,go),(0,r.Lk)("div",vo,[(0,r.Lk)("button",{class:"btn btn-secondary btn-sm",onClick:t=>l.toggleImageVisibility(e)},(0,i.v_)(e.visible?"隱藏":"顯示"),9,fo)])])))),128))]),(0,r.Lk)("div",Lo,[t[4]||(t[4]=(0,r.Lk)("h4",null," 上傳新圖片 ",-1)),(0,r.Lk)("input",{type:"file",onChange:t[0]||(t[0]=(...e)=>l.handleFileSelect&&l.handleFileSelect(...e)),accept:"image/*",ref:"fileInput"},null,544),o.previewUrl?((0,r.uX)(),(0,r.CE)("div",yo,[t[3]||(t[3]=(0,r.Lk)("h5",null,"預覽圖片",-1)),(0,r.Lk)("img",{src:o.previewUrl,alt:"上傳的圖片",class:"img-thumbnail",style:{"max-width":"300px"}},null,8,Co),(0,r.Lk)("div",wo,[(0,r.Lk)("button",{class:"btn btn-primary me-2",onClick:t[1]||(t[1]=(...e)=>l.confirmUpload&&l.confirmUpload(...e))},"確認上傳"),(0,r.Lk)("button",{class:"btn btn-secondary",onClick:t[2]||(t[2]=(...e)=>l.cancelUpload&&l.cancelUpload(...e))},"取消上傳")])])):(0,r.Q3)("",!0)])])}var Io={name:"AdminCarouselImages",data(){return{carouselImages:[],selectedFile:null,previewUrl:""}},async mounted(){await this.loadCarouselImages()},methods:{async loadCarouselImages(){try{const e=await ie.A.get("/api/carousel_images");this.carouselImages=e.data||[]}catch(e){console.error("加載輪播圖片失敗",e),alert("加載輪播圖片失敗！")}},handleFileSelect(e){const t=e.target.files[0];if(t){const e=["image/jpeg","image/png","image/gif"],a=5242880;if(!e.includes(t.type))return void alert("僅支援JPEG, PNG, GIF 格式的圖片！");if(t.size>a)return void alert("圖片超出5MB的上限！");this.selectedFile=t,this.previewUrl=URL.createObjectURL(t)}},async confirmUpload(){if(!this.selectedFile)return void alert("沒有選擇任何文件！");const e=new FormData;e.append("image",this.selectedFile);try{const t=await ie.A.post("/api/carousel-images",e,{headers:{"Content-Type":"multipart/form-data"}});this.carouselImages.push(t.data),alert("圖片上傳成功"),this.resetUpload()}catch(t){console.error("圖片上傳失敗",t),alert("圖片上傳失敗!")}},cancelUpload(){this.resetUpload()},resetUpload(){this.selectedFile=null,this.previewUrl="",this.$refs.fileInput.value=""},async deleteCarouselImage(e){if(confirm("確定要刪除這張圖片嗎？"))try{await ie.A.delete(`/api/carousel-image/${e}`),this.carouselImages=this.carouselImages.filter((t=>t.id!==e)),alert("圖片已刪除。")}catch(t){console.error("圖片刪除失敗",t),alert("圖片刪除失敗！請稍後再試。")}},async toggleImageVisibility(e){const t=!e.visible;try{await ie.A.patch(`/api/carousel-image/${e.id}`,{visible:t}),e.visible=t,alert("圖片已＄{updatedVisibility ? '顯示' : '隱藏'}。")}catch(a){console.error("更新圖片狀態失敗",a),alert("更新圖片狀態失敗！")}}}};const Fo=(0,y.A)(Io,[["render",_o],["__scopeId","data-v-0bd4411f"]]);var Eo=Fo;const Po={class:"special-offers-dashboard container mt-5"},So={class:"d-flex justify-content-end mb-3"},Oo={class:"accordion",id:"specialOffersAccordion"},xo={class:"accordion-item"},Ao={id:"collapseSpecialOffers",class:"accordion-collapse collapse show","aria-labelledby":"headingSpecialOffers","data-bs-parent":"#specialOffersAccordion"},Uo={class:"accordion-body"},To={class:"table"},Do=["onClick"],Xo=["onClick"],Mo={class:"modal fade",tabindex:"-1",ref:"specialOfferModal"},Ro={class:"modal-dialog"},$o={class:"modal-content"},qo={class:"modal-header"},No={class:"modal-title"},Vo={class:"modal-body"},Bo={class:"mb-3"},Wo={key:0,class:"list-group mt-2"},Ko=["onClick"],Qo={key:1,class:"mt-2"},Jo={class:"mb-3"},jo={class:"mb-3"},Ho={class:"mb-3"},zo={class:"modal-footer"};function Go(e,t,a,o,l,n){return(0,r.uX)(),(0,r.CE)("div",Po,[t[17]||(t[17]=(0,r.Lk)("h2",{class:"text-center"},"特價商品管理",-1)),(0,r.Lk)("div",So,[(0,r.Lk)("button",{class:"btn btn-success",onClick:t[0]||(t[0]=(...e)=>n.openCreateSpecialOfferModal&&n.openCreateSpecialOfferModal(...e))},"新增特價商品")]),(0,r.Lk)("div",Oo,[(0,r.Lk)("div",xo,[t[11]||(t[11]=(0,r.Lk)("h2",{class:"accordion-header",id:"headingSpecialOffers"},[(0,r.Lk)("button",{class:"accordion-button collapsed",type:"button","data-bs-toggle":"collapse","data-bs-target":"#collapseSpecialOffers","aria-expanded":"true","aria-controls":"collapseSpecialOffers"}," 特價商品管理 ")],-1)),(0,r.Lk)("div",Ao,[(0,r.Lk)("div",Uo,[(0,r.Lk)("table",To,[t[10]||(t[10]=(0,r.Lk)("thead",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("th",null,"商品名稱"),(0,r.Lk)("th",null,"特價價格"),(0,r.Lk)("th",null,"倒數時間 (秒)"),(0,r.Lk)("th",null,"創建日期"),(0,r.Lk)("th",null,"操作")])],-1)),(0,r.Lk)("tbody",null,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(l.specialOffers,((e,t)=>((0,r.uX)(),(0,r.CE)("tr",{key:e.id},[(0,r.Lk)("td",null,(0,i.v_)(n.getProductName(e.product_id)),1),(0,r.Lk)("td",null,(0,i.v_)(e.price),1),(0,r.Lk)("td",null,(0,i.v_)(e.countdown),1),(0,r.Lk)("td",null,(0,i.v_)(n.formatDate(e.created_at)),1),(0,r.Lk)("td",null,[(0,r.Lk)("button",{class:"btn btn-warning btn-sm me-2",onClick:e=>n.openEditSpecialOfferModal(t)},"編輯",8,Do),(0,r.Lk)("button",{class:"btn btn-danger btn-sm",onClick:a=>n.deleteSpecialOffer(e.id,t)},"刪除",8,Xo)])])))),128))])])])])])]),(0,r.Lk)("div",Mo,[(0,r.Lk)("div",Ro,[(0,r.Lk)("div",$o,[(0,r.Lk)("div",qo,[(0,r.Lk)("h5",No,(0,i.v_)(l.isEditing?"編輯特價商品":"新增特價商品"),1),(0,r.Lk)("button",{type:"button",class:"btn-close",onClick:t[1]||(t[1]=(...e)=>n.closeSpecialOfferModal&&n.closeSpecialOfferModal(...e))})]),(0,r.Lk)("div",Vo,[(0,r.Lk)("div",Bo,[t[13]||(t[13]=(0,r.Lk)("label",{for:"productSelect",class:"form-label"},"搜尋商品名稱",-1)),(0,r.bo)((0,r.Lk)("input",{type:"text",id:"productSearch",class:"form-control","onUpdate:modelValue":t[2]||(t[2]=e=>l.productSearchKeyword=e),onInput:t[3]||(t[3]=(...t)=>e.debouncedSearchProducts&&e.debouncedSearchProducts(...t)),required:""},null,544),[[s.Jo,l.productSearchKeyword]]),l.searchResults.length>0?((0,r.uX)(),(0,r.CE)("ul",Wo,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(l.searchResults,(e=>((0,r.uX)(),(0,r.CE)("li",{class:"list-group-item list-group-item-action",key:e.id,onClick:t=>n.selectProduct(e)},(0,i.v_)(e.name),9,Ko)))),128))])):(0,r.Q3)("",!0),l.selectedProduct?((0,r.uX)(),(0,r.CE)("div",Qo,[t[12]||(t[12]=(0,r.Lk)("strong",null,"已選擇商品：",-1)),(0,r.eW)((0,i.v_)(l.selectedProduct.name)+" ",1),(0,r.Lk)("button",{type:"button",class:"btn btn-sm btn-outline-danger ms-2",onClick:t[4]||(t[4]=(...e)=>n.clearSelectedProduct&&n.clearSelectedProduct(...e))},"移除")])):(0,r.Q3)("",!0)]),(0,r.Lk)("div",Jo,[t[14]||(t[14]=(0,r.Lk)("label",{for:"priceInput",class:"form-label"},"特價價格",-1)),(0,r.bo)((0,r.Lk)("input",{type:"number",id:"priceInput","onUpdate:modelValue":t[5]||(t[5]=e=>l.specialOfferForm.price=e),class:"form-control",placeholder:"請輸入特價價格",required:""},null,512),[[s.Jo,l.specialOfferForm.price]])]),(0,r.Lk)("div",jo,[t[15]||(t[15]=(0,r.Lk)("label",{for:"countdownInput",class:"form-label"},"倒數時間 (秒)",-1)),(0,r.bo)((0,r.Lk)("input",{type:"number",id:"countdownInput","onUpdate:modelValue":t[6]||(t[6]=e=>l.specialOfferForm.countdown=e),class:"form-control",placeholder:"請輸入倒數時間",required:""},null,512),[[s.Jo,l.specialOfferForm.countdown]])]),(0,r.Lk)("div",Ho,[t[16]||(t[16]=(0,r.Lk)("label",{for:"createdAtInput",class:"form-label"},"創建日期",-1)),(0,r.bo)((0,r.Lk)("input",{type:"date",id:"createdAtInput","onUpdate:modelValue":t[7]||(t[7]=e=>l.specialOfferForm.created_at=e),class:"form-control",required:""},null,512),[[s.Jo,l.specialOfferForm.created_at]])])]),(0,r.Lk)("div",zo,[(0,r.Lk)("button",{type:"button",class:"btn btn-secondary",onClick:t[8]||(t[8]=(...e)=>n.closeSpecialOfferModal&&n.closeSpecialOfferModal(...e))},"取消"),(0,r.Lk)("button",{type:"button",class:"btn btn-primary",onClick:t[9]||(t[9]=(...e)=>n.saveSpecialOffer&&n.saveSpecialOffer(...e))},(0,i.v_)(l.isEditing?"保存變更":"新增特價商品"),1)])])])],512)])}var Zo={name:"SpecialOffers",data(){return{specialOffers:[],specialOfferForm:{id:null,product_id:"",price:0,countdown:0,created_at:""},isEditing:!1,currentIndex:null,productSearchKeyword:"",searchResults:[],selectedProduct:null}},mounted(){this.loadSpecialOffers(),this.debouncedSearchProducts=Lr()(this.searchProducts,500)},methods:{async loadSpecialOffers(){try{const e=await ie.A.get("/api/special_offers");this.specialOffers=e.data}catch(e){console.error("加載特價商品時出錯",e),alert("加載特價商品時出錯，請稍後再試！")}},async searchProducts(){if(""!==this.productSearchKeyword.trim())try{const e=await ie.A.get("/api/products/search",{params:{keyword:this.productSearchKeyword}});this.searchResults=e.data}catch(e){console.error("搜尋商品時出錯",e),alert("搜尋商品時出錯，請稍後再試！")}else this.searchResults=[]},selectProduct(e){this.selectedProduct=e,this.specialOfferForm.product_id=e.id,this.searchResults=[],this.productSearchKeyword=""},clearSelectedProduct(){this.selectedProduct=null,this.specialOfferForm.product_id=""},async loadProducts(){try{const e=await ie.A.get("/api/products");this.products=e.data}catch(e){console.error("加載商品時出錯",e),alert("加載商品時出錯，請稍後再試！")}},formatDate(e){const t=new Date(e);return t.toLocaleDateString()},openCreateSpecialOfferModal(){this.isEditing=!1,this.specialOfferForm={id:null,product_id:"",price:0,countdown:0,created_at:""},this.selectedProduct=null,this.productSearchKeyword="",this.searchResults=[],this.$nextTick((()=>{const e=new U.aF(this.$refs.specialOfferModal);e.show()}))},async openEditSpecialOfferModal(e){this.isEditing=!0,this.currentIndex=e;const t={...this.specialOffers[e]};this.specialOfferForm=t;try{const e=await ie.A.get(`/api/products/${t.product_id}`);this.selectedProduct=e.data}catch{console.error("取得商品資訊時出錯！"),alert("取得商品資訊時出錯，請稍後再試！")}this.productSearchKeyword="",this.searchResults=[],this.$nextTick((()=>{const e=new U.aF(this.$refs.specialOfferModal);e.show()}))},async getProductName(e){if(this.selectedProduct&&this.selectedProduct.id===e)return this.selectedProduct.name;try{const t=await ie.A.get(`/api/products/${e}`);return t.data.name}catch(t){return console.error("取得商品名稱時出錯！"),alert("取得商品名稱時出錯，請稍候再試！"),"未知商品"}},closeSpecialOfferModal(){const e=U.aF.getInstance(this.$refs.specialOfferModal);e&&e.hide()},async saveSpecialOffer(){if(this.specialOfferForm.product_id&&this.specialOfferForm.price&&this.specialOfferForm.countdown&&this.specialOfferForm.created_at)try{if(this.isEditing)await ie.A.put(`/api/special_offers/${this.specialOfferForm.id}`,this.specialOfferForm),this.specialOffers[this.currentIndex]={...this.specialOfferForm},alert("特價商品已更新！");else{const e=await ie.A.post("/api/special_offers",this.specialOfferForm);this.specialOffers.push(e.data),alert("特價商品已新增！")}this.closeSpecialOfferModal()}catch(e){console.error("保存特價商品時出錯！",e),alert("保存特價商品時出錯，請稍後再試！")}else alert("請填寫所有必填欄位！")},async deleteSpecialOffer(e,t){if(confirm("確定要刪除此特價商品？"))try{await ie.A.delete(`/api/special_offers/${e}`),this.specialOffers.splice(t,1),alert("特價商品已刪除！")}catch(a){console.error("刪除特價商品時出錯",a),alert("刪除特價商品時出錯，請稍後再試！")}}}};const Yo=(0,y.A)(Zo,[["render",Go],["__scopeId","data-v-451a7134"]]);var el=Yo;const tl=[{path:"/",name:"HomePage",component:pe},{path:"/admin",name:"AdminDashboard",component:Na},{path:"/admin/Products",name:"AdminProducts",component:Ts},{path:"/admin/Users",name:"AdminUsers",component:ir},{path:"/admin/Orders",name:"AdminOrders",component:wr},{path:"/admin/Orders/:id(\\d+)",name:"OrderDetail",component:mo,props:!0},{path:"/admin/CreateProduct",name:"CreateProduct",component:qr},{path:"/admin/EditProduct/:id",name:"EditProduct",component:Zr},{path:"/admin/AdminContact",name:"AdminContact",component:ao},{path:"/admin/CarouselImages",name:"CarouselImages",component:Eo},{path:"/admin/SpecialOffers",name:"SpecialOffers",component:el},{path:"/ShopCart",name:"ShopCart",component:Pe,meta:{requiresAuth:!0}},{path:"/ProductsList",name:"ProductsList",component:He},{path:"/MembersPage",name:"MembersPage",component:qt,meta:{requiresAuth:!0}},{path:"/AboutUsPage",name:"AboutUsPage",component:ke},{path:"/ContactUs",name:"ContactUs",component:Wt},{path:"/SearchResults",name:"SearchResults",component:jt},{path:"/UserRegister",name:"UserRegister",component:la},{path:"/UserLogin",name:"UserLogin",component:ha},{path:"/ForgotPwd",name:"ForgotPwd",component:La},{path:"/ProductDetail/:id",name:"ProductDetail",component:rt}],al=(0,D.aE)({history:(0,D.LA)("/"),routes:tl});al.beforeEach(((e,t,a)=>{const s=!!localStorage.getItem("authToken"),r=localStorage.getItem("role");e.matched.some((e=>e.meta.requiresAuth))?s?e.meta.role&&e.meta.role!==r?(alert("你沒有權限進入此頁面"),a({path:"/"})):a():(alert("請先登入再使用！"),a({path:"/UserLogin"})):a()}));var sl=al,rl={namespaced:!0,state:{items:[]},getters:{cartItems:e=>e.items,cartTotal:e=>e.items.reduce(((e,t)=>e+t.price*t.quantity),0),cartItemCount:e=>e.items.reduce(((e,t)=>e+t.quantity),0)},mutations:{addToCart(e,t){const a=e.items.find((e=>e.id===t.id));a?a.quantity++:e.items.push({id:t.id,name:t.name,price:t.price,image:t.image,quantity:1})},removeFromCart(e,t){e.items.splice(t,1)},updateCartItemQuantity(e,{index:t,quantity:a}){e.items[t].quantity=a<1?1:a},clearCart(e){e.items=[]}},actions:{addProductToCart({commit:e},t){e("addToCart",t)},removeItemFromCart({commit:e},t){e("removeFromCart",t)},updateItemQuantity({commit:e},t){e("updateCartItemQuantity",t)},clearShoppingCart({commit:e}){e("clearCart")}}},ol=a(5131),ll={namespaced:!0,state:{isLoggedIn:!1,user:null},mutations:{login(e,t){e.isLoggedIn=!0,e.user=t},logout(e){e.isLoggedIn=!1,e.user=null}},actions:{login({commit:e},t){e("login",t)},logout({commit:e}){e("logout")}},getters:{isLoggedIn:e=>e.isLoggedIn,user:e=>e.user}},nl=(0,Ie.y$)({modules:{cart:rl,auth:ll},plugins:[(0,ol.A)()]});const il=(0,s.Ef)(x);il.use(nl),il.use(A.A),il.use(sl),il.use(T.Ay),il.mount("#app"),ie.A.defaults.baseURL=""}},t={};function a(s){var r=t[s];if(void 0!==r)return r.exports;var o=t[s]={exports:{}};return e[s].call(o.exports,o,o.exports,a),o.exports}a.m=e,function(){var e=[];a.O=function(t,s,r,o){if(!s){var l=1/0;for(c=0;c<e.length;c++){s=e[c][0],r=e[c][1],o=e[c][2];for(var n=!0,i=0;i<s.length;i++)(!1&o||l>=o)&&Object.keys(a.O).every((function(e){return a.O[e](s[i])}))?s.splice(i--,1):(n=!1,o<l&&(l=o));if(n){e.splice(c--,1);var d=r();void 0!==d&&(t=d)}}return t}o=o||0;for(var c=e.length;c>0&&e[c-1][2]>o;c--)e[c]=e[c-1];e[c]=[s,r,o]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};a.O.j=function(t){return 0===e[t]};var t=function(t,s){var r,o,l=s[0],n=s[1],i=s[2],d=0;if(l.some((function(t){return 0!==e[t]}))){for(r in n)a.o(n,r)&&(a.m[r]=n[r]);if(i)var c=i(a)}for(t&&t(s);d<l.length;d++)o=l[d],a.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return a.O(c)},s=self["webpackChunkeshop_site"]=self["webpackChunkeshop_site"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=a.O(void 0,[504],(function(){return a(8559)}));s=a.O(s)})();
//# sourceMappingURL=app.0ac7dee4.js.map