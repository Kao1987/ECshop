"use strict";(self["webpackChunkeshop_site"]=self["webpackChunkeshop_site"]||[]).push([[834],{62742:function(e,t,a){a.d(t,{A:function(){return ya}});a(98992),a(37550);var s=a(81387),r=a(56768),o=a(24232);const i={class:"homepage container mt-5"},n={class:"carousel-section"},c={key:0,class:"loading-spinner"},l={key:1,class:"alert alert-warning"},d={key:2,id:"mainCarousel",class:"carousel slide position-relative carousel-fade","data-bs-ride":"carousel"},u={class:"carousel-indicators custom-indicators"},p=["data-bs-slide-to","aria-current","aria-label"],m={class:"carousel-inner rounded-4 shadow-lg"},g={class:"carousel-image-container"},h=["src"],v={key:0,class:"product-section mt-5"},f={class:"product-grid"},k={class:"product-image-wrapper"},b=["src"],y={class:"product-overlay"},L=["onClick"],I={class:"product-info"},A={class:"product-name"},C={key:0,class:"product-tag"},w={key:1,class:"sales-ranking mt-5"},P={class:"product-list"},_=["src"],E={key:2,class:"sales-ranking mt-5"},R={class:"product-list"},S=["src"],O={key:3,class:"countdown-special-offers mt-4"},T={class:"product-list"},x=["src"],$={class:"countdown-timer"};function D(e,t,a,s,D,q){return(0,r.uX)(),(0,r.CE)(r.FK,null,[(0,r.Lk)("div",i,[(0,r.Lk)("div",n,[D.isLoading.carousel?((0,r.uX)(),(0,r.CE)("div",c,t[0]||(t[0]=[(0,r.Lk)("div",{class:"spinner-border",role:"status"},[(0,r.Lk)("span",{class:"visually-hidden"},"加載中...")],-1)]))):D.errors.carousel?((0,r.uX)(),(0,r.CE)("div",l,(0,o.v_)(D.errors.carousel),1)):D.carouselImages&&D.carouselImages.length?((0,r.uX)(),(0,r.CE)("div",d,[(0,r.Lk)("div",u,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(D.carouselImages,((e,t)=>((0,r.uX)(),(0,r.CE)("button",{key:"indicator-"+t,type:"button","data-bs-target":"#mainCarousel","data-bs-slide-to":t,class:(0,o.C4)([{active:0===t},"indicator-dot"]),"aria-current":0===t,"aria-label":"Slide"+(t+1)},null,10,p)))),128))]),(0,r.Lk)("div",m,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(D.carouselImages,((e,t)=>((0,r.uX)(),(0,r.CE)("div",{key:"slide-"+t,class:(0,o.C4)(["carousel-item",{active:0===t}])},[(0,r.Lk)("div",g,[(0,r.Lk)("img",{src:q.getImageUrl(e.url,"carousel"),class:"d-block w-100",alt:"商品圖片"},null,8,h)])],2)))),128))]),t[1]||(t[1]=(0,r.Fv)('<button class="carousel-control-prev custom-control" type="button" data-bs-target="#mainCarousel" data-bs-slide="prev" data-v-0c07d7cd><span class="carousel-control-prev-icon" aria-hidden="true" data-v-0c07d7cd></span><span class="visually-hidden" data-v-0c07d7cd>Previous</span></button><button class="carousel-control-next custom-control" type="button" data-bs-target="#mainCarousel" data-bs-slide="next" data-v-0c07d7cd><span class="carousel-control-next-icon" aria-hidden="true" data-v-0c07d7cd></span><span class="visually-hidden" data-v-0c07d7cd>Next</span></button>',2))])):(0,r.Q3)("",!0)])]),D.randomProducts&&D.randomProducts.length>0?((0,r.uX)(),(0,r.CE)("div",v,[t[2]||(t[2]=(0,r.Lk)("div",{class:"section-header"},[(0,r.Lk)("h2",{class:"section-title"},"為您推薦"),(0,r.Lk)("div",{class:"section-subtitle"},"精選優質商品，專屬於您")],-1)),(0,r.Lk)("div",f,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(D.randomProducts,((e,t)=>((0,r.uX)(),(0,r.CE)("div",{key:t,class:"product-card",style:(0,o.Tr)({animationDelay:.1*t+"s"})},[(0,r.Lk)("div",k,[(0,r.Lk)("img",{src:q.getProductImage(e.product_id),class:"product-image"},null,8,b),(0,r.Lk)("div",y,[(0,r.Lk)("button",{class:"view-details-btn",onClick:t=>q.viewDetails(e)}," 查看詳情 ",8,L)])]),(0,r.Lk)("div",I,[(0,r.Lk)("h3",A,(0,o.v_)(e.name),1),"-"===e.quantity_sold?((0,r.uX)(),(0,r.CE)("div",C,"熱門推薦")):(0,r.Q3)("",!0)])],4)))),128))])])):(0,r.Q3)("",!0),D.sevenDaySalesRanking&&D.sevenDaySalesRanking.length>0?((0,r.uX)(),(0,r.CE)("div",w,[t[3]||(t[3]=(0,r.Lk)("h2",null,"過去7日銷售排行",-1)),(0,r.Lk)("div",P,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(D.sevenDaySalesRanking,((e,t)=>((0,r.uX)(),(0,r.CE)("div",{key:t,class:"product-item"},[(0,r.Lk)("img",{src:q.getProductImage(e.product_id),class:"product-thumbnail"},null,8,_),(0,r.Lk)("div",null,(0,o.v_)(t+1)+"."+(0,o.v_)(e.name),1),(0,r.Lk)("div",null,"賣出 "+(0,o.v_)(e.quantity_sold)+"件",1)])))),128))])])):(0,r.Q3)("",!0),D.monthSalesRanking&&D.monthSalesRanking.length>0?((0,r.uX)(),(0,r.CE)("div",E,[t[4]||(t[4]=(0,r.Lk)("h2",null,"過去30日銷售排行",-1)),(0,r.Lk)("div",R,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(D.monthSalesRanking,((e,t)=>((0,r.uX)(),(0,r.CE)("div",{key:t,class:"product-item"},[(0,r.Lk)("img",{src:q.getProductImage(e.product_id),class:"product-thumbnail"},null,8,S),(0,r.Lk)("div",null,(0,o.v_)(t+1)+"."+(0,o.v_)(e.name),1),(0,r.Lk)("div",null,"賣出"+(0,o.v_)(e.quantity_sold)+"件",1)])))),128))])])):(0,r.Q3)("",!0),q.processedSpecialOffers.length>0?((0,r.uX)(),(0,r.CE)("div",O,[t[5]||(t[5]=(0,r.Lk)("h2",null,"特價倒數計時商品",-1)),(0,r.Lk)("div",T,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(q.processedSpecialOffers,((e,t)=>((0,r.uX)(),(0,r.CE)("div",{key:t,class:"product-item"},[(0,r.Lk)("img",{src:q.getProductImage(e.product_id),class:"product-thumbnail"},null,8,x),(0,r.Lk)("div",null,(0,o.v_)(e.name),1),(0,r.Lk)("div",null,"特價 "+(0,o.v_)(e.price)+"元",1),(0,r.Lk)("div",$," 倒數"+(0,o.v_)(q.formatTime(e.countdown)),1)])))),128))])])):(0,r.Q3)("",!0)],64)}a(44114),a(54520),a(72577),a(3949),a(81454);var q=a(74300),U=a(94578),N=a(55019);const X={carouselImages:[{url:"/static/img/welcome.jpg"},{url:"/static/img/welcome.jpg"}]};var F={name:"HomePage",beforeUnmount(){this.clearCountdownIntervals()},data(){return{isPageLoading:!0,sevenDaySalesRanking:[],monthSalesRanking:[],specialOffers:[],carouselImages:X.carouselImages,products:[],countdownIntervals:[],isLoading:{sales:!1,offers:!1,carousel:!1,products:!1},errors:{sales:null,offers:null,carousel:null,products:null},randomProducts:null}},async mounted(){try{console.log("開始載入首頁資料"),await this.loadHomePageData(),this.carouselImages.length&&this.carouselImages.length>0&&(await this.$nextTick(),this.initializeCarousel()),console.log("輪播圖片狀態:",{images:this.carouselImages,domElement:document.getElementById("mainCarousel")})}catch(e){console.error("讀取首頁資料失敗",e)}},methods:{getImageUrl:N.A,handleError(e,t){console.error(`Error in ${e}:`,t.message||t),this.errors[e]=`無法加載 ${e} 數據，請稍後再試。`,"carousel"===e&&(this.carouselImages=X.carouselImages)},async loadHomePageData(){try{await this.loadProductsData(),this.randomProducts=this.getRandomProducts(5),await Promise.allSettled([this.loadSalesData(),this.loadOffersData(),this.loadCarouselData()])}catch(e){console.error("讀取主頁資料失敗",e)}},async loadSalesData(){this.isLoading.sales=!0;try{console.log(this.$axios.defaults.baseURL);const[e,t]=await Promise.all([q.A.rankingAPI.getRanking(7),q.A.rankingAPI.getRanking(30)]);this.sevenDaySalesRanking=this.processSalesRanking(e||[]),this.monthSalesRanking=this.processSalesRanking(t||[]),console.log("Processed Seven Day Sales Ranking:",this.sevenDaySalesRanking),console.log("Processed Month Sales Ranking:",this.monthSalesRanking)}catch(e){console.error("加載銷售數據失敗",e),this.errors.sales="無法加載銷售排行數據",this.sevenDaySalesRanking=[],this.monthSalesRanking=[]}finally{this.isLoading.sales=!1}},processSalesRanking(e){return Array.isArray(e)?e.map((e=>{const t=Number(e.product_id),a=this.products.find((e=>e.id===t));return{product_id:t,name:a?a.name:`Product ID: ${t}`,quantity_sold:e.sale_count||0,image:a&&a.image?a.image:"/img/wrong.png"}})).filter((e=>e.quantity_sold>0)).slice(0,10):[]},async loadOffersData(){this.isLoading.offers=!0;try{const e=await q.A.specialOffersAPI.getAllSpecialOffers();e&&Array.isArray(e)&&(this.specialOffers=e.map((e=>({...e,countdown:e.countdown||36e3,product_id:Number(e.product_id)}))),console.log("讀取到的特價商品:",this.specialOffers))}catch(e){console.error("加載特價商品失敗",e),this.errors.offers="無法加載特價商品數據",this.specialOffers=[]}finally{this.isLoading.offers=!1}},async loadCarouselData(){this.isLoading.carousel=!0;try{const e=await q.A.carouselAPI.getAllCarouselImages();console.log("原始後端回傳:",e),Array.isArray(e)?(this.carouselImages=e.filter((e=>e.visible)),console.log("載入的輪播圖片:",this.carouselImages),await this.$nextTick(),this.carouselImages.length>0&&(this.initializeCarousel(),console.log(this.carouselImages))):(console.error("輪播圖的格式不正確",e),this.carouselImages=X.carouselImages,await this.$nextTick(),this.initializeCarousel(),console.log(this.carouselImages))}catch(e){console.error("加載輪播圖片失敗",e),this.errors.carousel="無法加載輪播圖片",this.carouselImages=X.carouselImages,await this.$nextTick(),this.initializeCarousel()}finally{this.isLoading.carousel=!1}},async loadProductsData(){this.isLoading.products=!0;try{const e=await q.A.productAPI.getAllProducts();this.products=e||[]}catch(e){console.error("加載商品數據失敗",e),this.errors.products="無法加載商品列表",this.products=[]}finally{this.isLoading.products=!1}},convertToSortedRankingWithProducts(e){return Object.entries(e).map((([e,t])=>{const a=Number(e),s=this.products.find((e=>e.id===a));return{product_id:e,quantity_sold:t,name:s?s.name:"未知商品",image:s?s.image:"/img/wrong.png"}})).sort(((e,t)=>t.quantity_sold-e.quantity_sold)).slice(0,5)},startCountdown(){this.clearCountdownIntervals(),this.specialOffers&&0!==this.specialOffers.length&&this.specialOffers.forEach(((e,t)=>{if(!e.countdown)return;const a=setInterval((()=>{e.countdown>0?this.specialOffers[t]={...e,countdown:e.countdown-1}:clearInterval(a)}),1e3);this.countdownIntervals.push(a)}))},clearCountdownIntervals(){this.countdownIntervals.forEach((e=>clearInterval(e))),this.countdownIntervals=[]},formatTime(e){const t=Math.floor(e/3600),a=Math.floor(e%3600/60),s=e%60;return`${t}時${a}分${s}秒`},getImageUrl(e,t){return(0,N.A)(e,t)},getProductImage(e){const t=Number(e),a=this.products.find((e=>e.id===t));return a&&a.image?`api/img/products/${a.image.split("/").pop()}`:"/img/wrong.png"},getRandomProducts(e=5){const t=[...this.products];for(let a=t.length-1;a>0;a--){const e=Math.floor(Math.random()*(a+1));[t[a],t[e]]=[t[e],t[a]]}return t.slice(0,e).map((e=>({product_id:e.id,name:e.name,image:this.getProductImage(e.id),quantity_sold:"-"})))},initializeCarousel(){this.$nextTick((()=>{const e=document.getElementById("mainCarousel");e&&new U.FN(e,{interval:5e3,touch:!0,pause:"hover",keyboard:!0})}))},viewDetails(e){this.$router.push(`/product/${e.product_id}`)}},computed:{processedSpecialOffers(){return this.specialOffers&&this.products?[...this.specialOffers].filter((e=>e.countdown>0)).map((e=>{const t=this.products.find((t=>t.id===e.product_id));return{...e,name:t?t.name:"未知商品",image:t?t.image:"/img/wrong.png"}})):[]}}},M=a(71241);const W=(0,M.A)(F,[["render",D],["__scopeId","data-v-0c07d7cd"]]);var K=W;function B(e,t,a,s,o,i){return t[0]||(t[0]=(0,r.Fv)('<h1 style="color:coral;" data-v-b5050256>關於我們</h1><br data-v-b5050256><br data-v-b5050256><div data-v-b5050256><div class="title" data-v-b5050256>公司願景</div><div class="content" data-v-b5050256> ECSHOP 電商平台致力於打造一個以消費者需求為核心的全球購物平台，通過先進的技術、優質的產品及卓越的服務，提供每一位顧客最便捷、愉快的購物體驗。 我們相信，透過創新和精確的市場洞察，能為消費者和合作夥伴創造更多的價值，並推動電商產業的進步。 我們的願景是成為全球消費者心目中的首選購物平台，無論是日常所需還是高端商品，ECSHOP 都能夠滿足不同客戶的需求，並且實現跨境無縫銷售的全球電商體驗。 </div><div class="title" data-v-b5050256>未來展望</div><div class="content" data-v-b5050256> ECSHOP 將持續不斷地創造優質的產品和優秀的服務，並持續推動消費者需求的解決方案，讓消費者能更輕鬆地在全球購物。 我們也將不斷地學習和進步，以提供給消&quot;&gt;未來，ECSHOP 將持續拓展產品品類，並加強與世界各地的品牌商及供應商的合作，為消費者提供更豐富的選擇。同時，我們將致力於智能化技術的應用，利用大數據分析、人工智慧和物聯網等前沿技術，提升用戶體驗，優化物流配送效率，並實現個性化推薦和精準行銷。 我們也將積極推動環保和可持續發展，通過綠色物流、減少包裝浪費等措施，承擔企業社會責任，為地球的未來做出貢獻。 展望未來，ECSHOP 將不斷創新，推動整個行業的數位化轉型，並且努力實現「消費者、合作夥伴與企業共贏」的目標。我們期待與您攜手，共創電商新時代的輝煌！</div></div>',4))}var j={name:"AboutUsPage"};const Q=(0,M.A)(j,[["render",B],["__scopeId","data-v-b5050256"]]);var H=Q,V=a(13154),z=a(45130);const J={class:"container mt-5"},G={key:0},Y={class:"row"},Z={class:"tag-filter mb-4"},ee=["onClick"],te={class:"search-bar mb-4"},ae={class:"col-md-3"},se=["max"],re={class:"container mt-5"},oe={class:"row"};function ie(e,t,a,s,i,n){const c=(0,r.g2)("ProductCard");return(0,r.uX)(),(0,r.CE)(r.FK,null,[(0,r.Lk)("div",J,[t[6]||(t[6]=(0,r.Lk)("h2",{class:"mb-4"},"商品列表",-1)),0===s.filteredProducts.length?((0,r.uX)(),(0,r.CE)("div",G,t[2]||(t[2]=[(0,r.Lk)("p",null,"暫無符合條件的商品，請修改查詢條件！",-1)]))):(0,r.Q3)("",!0),(0,r.Lk)("div",Y,[(0,r.Lk)("div",Z,[t[3]||(t[3]=(0,r.Lk)("h4",null,"選擇標籤",-1)),(0,r.Lk)("div",null,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(s.availableTags,(e=>((0,r.uX)(),(0,r.CE)("button",{key:e,onClick:t=>s.toggleTag(e),class:(0,o.C4)([{btn:!0,"btn-primary":s.selectedTags.includes(e),"btn-outline-primary":!s.selectedTags.includes(e)},"me-2 mb-2"])},(0,o.v_)(e),11,ee)))),128))])]),(0,r.Lk)("div",te,[(0,r.bo)((0,r.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>s.searchQuery=e),class:"form-control",placeholder:"搜尋產品..."},null,512),[[z.Jo,s.searchQuery]])]),(0,r.Lk)("div",ae,[t[5]||(t[5]=(0,r.Lk)("h4",null,"篩選條件",-1)),(0,r.Lk)("div",null,[t[4]||(t[4]=(0,r.Lk)("label",null,"價格區間",-1)),(0,r.bo)((0,r.Lk)("input",{type:"range","onUpdate:modelValue":t[1]||(t[1]=e=>s.priceRange=e),min:"0",max:s.maxPrice,step:"500"},null,8,se),[[z.Jo,s.priceRange]]),(0,r.Lk)("p",null,"價格："+(0,o.v_)(s.priceRange)+"元",1)])])])]),(0,r.Lk)("div",re,[(0,r.Lk)("div",oe,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(s.filteredProducts,(e=>((0,r.uX)(),(0,r.CE)("div",{class:"col-md-3 mb-4",key:e.id},[(0,r.bF)(c,{product:e,onAddToCart:s.addToCart},null,8,["product","onAddToCart"])])))),128))])])],64)}a(17642),a(58004),a(33853),a(45876),a(32475),a(15024),a(31698);var ne=a(90144),ce=a(4249);const le={class:"product-card"},de=["src"],ue={class:"card-title"},pe={class:"card-text"},me=["disabled"];function ge(e,t,a,s,i,n){const c=(0,r.g2)("router-link");return(0,r.uX)(),(0,r.CE)("div",le,[(0,r.bF)(c,{to:{name:"ProductDetail",params:{id:s.productId}}},{default:(0,r.k6)((()=>[(0,r.Lk)("img",{src:s.productImageUrl,class:"product-image",alt:"Product Image",onError:t[0]||(t[0]=(...e)=>s.imageError&&s.imageError(...e))},null,40,de),(0,r.Lk)("h5",ue,(0,o.v_)(a.product.name),1),(0,r.Lk)("p",pe,(0,o.v_)(s.formattedPrice)+" 元",1)])),_:1},8,["to"]),(0,r.Lk)("button",{class:"btn btn-primary",onClick:t[1]||(t[1]=(...e)=>s.handleAddToCart&&s.handleAddToCart(...e)),disabled:s.isAdding},(0,o.v_)(s.isAdding?"添加中...":"加入購物車"),9,me)])}var he={name:"ProductCard",props:{product:{type:Object,required:!0,validator:function(e){const t=["id","name","price","image"],a=t.every((t=>t in e));return!!a&&("string"===typeof e.id||"number"===typeof e.id&&"string"===typeof e.name&&""!==e.name.trim()&&"number"===typeof e.price&&e.price>=0&&"string"===typeof e.image&&""!==e.image.trim())}}},setup(e,{emit:t}){const a=(0,ne.KR)(!1),s=(0,r.EW)((()=>String(e.product.id).trim())),o=(0,r.EW)((()=>e.product.image?`/${e.product.image}`:"/backend/public/img/wrong.png")),i=(0,r.EW)((()=>{const t=parseFloat(e.product.price);return isNaN(t)?"0 元":new Intl.NumberFormat("zh-TW",{style:"currency",currency:"TWD",minimumFractionDigits:0,maximumFractionDigits:0}).format(t)})),n=()=>{a.value||(a.value=!0,t("add-to-cart",e.product),setTimeout((()=>{a.value=!1}),1e3))},c=e=>{e.target.src="/img/wrong.png"};return{isAdding:a,productId:s,productImageUrl:o,formattedPrice:i,handleAddToCart:n,imageError:c}}};const ve=(0,M.A)(he,[["render",ge],["__scopeId","data-v-7dcd285c"]]);var fe=ve,ke={name:"ProductsList",components:{ProductCard:fe},setup(){const e=(0,ne.KR)([]),t=(0,ne.KR)(!1),a=(0,ne.KR)(null),o=(0,r.EW)((()=>{if(!Array.isArray(e.value))return 1e6;const t=e.value.map((e=>Number(e.price)));return t.length?Math.max(...t):1e6})),i=(0,ne.KR)(o.value),n=(0,ne.KR)([]),c=(0,ne.KR)([]),l=(0,ce.Pj)(),d=(0,s.rd)(),u=(0,s.lq)(),p=(0,r.EW)((()=>l.state.auth.isLoggedIn)),m=(0,ne.KR)(""),g=(0,r.EW)((()=>Array.isArray(e.value)?e.value.filter((e=>{const t=Number(e.price),a=e.name.toLowerCase().includes(m.value.toLowerCase()),s=t<=i.value,r=e.tags||[],o=0===c.value.length||c.value.some((e=>r.includes(e)));return a&&s&&o})):[])),h=async()=>{t.value=!0,a.value=null;try{const t=await q.A.productAPI.getAllProducts();Array.isArray(t)?e.value=t.map((e=>({...e,id:String(e.id).trim(),price:Number(e.price),tags:Array.isArray(e.tags)?e.tags:[],image:e.image?`api/img/products/${e.image.split("/").pop()}`:"/img/default-product.jpg"}))):e.value=[],console.log("加載後的商品列表:",e.value),i.value=o.value;const a=new Set;e.value.forEach((e=>{e.tags&&Array.isArray(e.tags)&&e.tags.forEach((e=>a.add(e)))})),n.value=Array.from(a)}catch(s){console.error("加載商品時出錯",s),a.value="加載產品時出錯，請稍後再試！"}finally{t.value=!1}},v=e=>{c.value.includes(e)?c.value=c.value.filter((t=>t!==e)):c.value.push(e)},f=e=>{if(p.value)l.dispatch("cart/addProductToCart",e),l.dispatch("notifications/showNotification",{type:"success",message:`已將 ${e.name} 加入購物車`,timeout:2e3});else{l.dispatch("notifications/showNotification",{type:"warning",message:"請先登入會員再加入購物車！",timeout:2e3});const e=u.fullPath;d.push({name:"UserLogin",query:{redirect:e}})}};return(0,r.sV)((()=>{m.value=u.query.search||"",h().then((()=>{console.log("加載後的商品列表:",e.value)}))})),(0,r.wB)((()=>u.query.search),(e=>{m.value=e||""})),{products:e,maxPrice:o,priceRange:i,loading:t,error:a,isLoggedIn:p,filteredProducts:g,availableTags:n,selectedTags:c,searchQuery:m,toggleTag:v,addToCart:f}}};const be=(0,M.A)(ke,[["render",ie],["__scopeId","data-v-8777fc78"]]);var ye=be;const Le={class:"container mt-5"},Ie={key:0,class:"product-detail"},Ae={class:"row"},Ce={class:"col-md-6"},we={class:"image-container"},Pe=["src"],_e={class:"col-md-6"},Ee={class:"product-name"},Re={class:"product-description"},Se={class:"product-price"},Oe={class:"d-flex mt-4"},Te={key:1,class:"loading"};function xe(e,t,a,s,i,n){return(0,r.uX)(),(0,r.CE)("div",Le,[s.product&&s.product.id?((0,r.uX)(),(0,r.CE)("div",Ie,[(0,r.Lk)("div",Ae,[(0,r.Lk)("div",Ce,[(0,r.Lk)("div",we,[(0,r.Lk)("img",{src:s.productImageUrl,alt:"Product Image",class:"product-image"},null,8,Pe)])]),(0,r.Lk)("div",_e,[(0,r.Lk)("h2",Ee,(0,o.v_)(s.product.name),1),(0,r.Lk)("p",Re,(0,o.v_)(s.product.description),1),(0,r.Lk)("h4",Se,"價格："+(0,o.v_)(s.product.price)+" 元",1),(0,r.Lk)("div",Oe,[(0,r.Lk)("button",{class:"btn btn-primary",onClick:t[0]||(t[0]=(...e)=>s.addToCart&&s.addToCart(...e))},"加入購物車"),(0,r.Lk)("button",{class:"btn btn-secondary ms-2",onClick:t[1]||(t[1]=(...e)=>s.goBack&&s.goBack(...e))},"返回上一頁")])])])])):((0,r.uX)(),(0,r.CE)("div",Te,t[2]||(t[2]=[(0,r.Lk)("div",{class:"spinner-border text-primary",role:"status"},[(0,r.Lk)("span",{class:"visually-hidden"},"正在加載...")],-1),(0,r.Lk)("p",null,"正在加載商品中...",-1)])))])}var $e={name:"ProductDetail",setup(){const e=(0,ce.Pj)(),t=(0,s.lq)(),a=(0,s.rd)(),o=(0,ne.KR)(null),i=(0,r.EW)((()=>t.params.id)),n=(0,r.EW)((()=>o.value?o.value.image.startsWith("http")?o.value.image:`http://localhost:5002/api/${o.value.image}`:"/img/wrong.png")),c=(0,r.EW)((()=>e.state.auth.isLoggedIn)),l=async()=>{if(!u(i.value))return notificationTypes("error","商品格式不正確，無法加載商品詳情"),void a.go(-1);try{o.value=await q.A.productAPI.getProductById(i.value)}catch(e){console.error("加載商品詳情時出錯",e),notifiy("error","加載商品詳情失敗，請稍後再試！")}},d=()=>{c.value?(e.dispatch("cart/addProductToCart",o.value),p("success",`已將${o.value.name}加入購物車`)):m()},u=e=>/^[1-9]\d*$/.test(e),p=(t,a)=>{e.dispatch("notifications/showNotification",{type:t,message:a})},m=()=>{a.push({name:"UserLogin",query:{redirect:t.fullPath}})},g=()=>a.go(-1);return(0,r.sV)(l),{addToCart:d,goBack:g,product:o,productId:i,productImageUrl:n}}};const De=(0,M.A)($e,[["render",xe],["__scopeId","data-v-517040b6"]]);var qe=De;const Ue={class:"member-page bg-light"},Ne={class:"container py-4"},Xe={class:"member-profile mb-4"},Fe={class:"profile-header d-flex align-items-center"},Me={class:"avatar-circle me-3"},We={class:"initials"},Ke={class:"mb-1"},Be={class:"text-muted mb-0"},je={class:"content-tabs mb-4"},Qe={class:"tab-content"},He={class:"tab-pane fade show active",id:"profile"},Ve={class:"card"},ze={class:"card-body"},Je={class:"info-group mb-3"},Ge={class:"mb-0"},Ye={class:"info-group mb-3"},Ze={class:"mb-0"},et={class:"info-group mb-3"},tt={class:"mb-0"},at={class:"info-group"},st={class:"mb-0"},rt={class:"tab-pane fade",id:"addresses"},ot={class:"card"},it={class:"card-body"},nt={class:"d-flex justify-content-end mb-3"},ct={class:"address-list"},lt={class:"address-content"},dt={class:"mb-2"},ut={class:"mb-1"},pt={class:"mb-0"},mt={class:"address-actions"},gt=["onClick"],ht=["onClick"],vt={class:"tab-pane fade",id:"orders"},ft={class:"card"},kt={class:"card-body"},bt={class:"order-list"},yt=["onClick"],Lt={class:"order-id"},It={class:"order-date"},At={class:"order-amount"},Ct={key:0,class:"order-details"},wt=["src","alt"],Pt={class:"product-info"},_t={class:"mb-0"},Et={class:"product-total"},Rt={class:"text-center"};function St(e,t,a,s,i,n){return(0,r.uX)(),(0,r.CE)("div",Ue,[(0,r.Lk)("div",Ne,[(0,r.Lk)("div",Xe,[(0,r.Lk)("div",Fe,[(0,r.Lk)("div",Me,[(0,r.Lk)("span",We,(0,o.v_)(n.getUserInitials),1)]),(0,r.Lk)("div",null,[(0,r.Lk)("h2",Ke,(0,o.v_)(i.userInfo.name),1),(0,r.Lk)("p",Be,(0,o.v_)(i.userInfo.email),1)])])]),(0,r.Lk)("div",je,[t[11]||(t[11]=(0,r.Lk)("ul",{class:"nav nav-pills mb-3",role:"tablist"},[(0,r.Lk)("li",{class:"nav-item",role:"presentation"},[(0,r.Lk)("button",{class:"nav-link active","data-bs-toggle":"pill","data-bs-target":"#profile"},[(0,r.Lk)("i",{class:"fas fa-user me-2"}),(0,r.eW)("個人資料 ")])]),(0,r.Lk)("li",{class:"nav-item",role:"presentation"},[(0,r.Lk)("button",{class:"nav-link","data-bs-toggle":"pill","data-bs-target":"#addresses"},[(0,r.Lk)("i",{class:"fas fa-map-marker-alt me-2"}),(0,r.eW)("收件地址 ")])]),(0,r.Lk)("li",{class:"nav-item",role:"presentation"},[(0,r.Lk)("button",{class:"nav-link","data-bs-toggle":"pill","data-bs-target":"#orders"},[(0,r.Lk)("i",{class:"fas fa-shopping-bag me-2"}),(0,r.eW)("訂單記錄 ")])])],-1)),(0,r.Lk)("div",Qe,[(0,r.Lk)("div",He,[(0,r.Lk)("div",Ve,[(0,r.Lk)("div",ze,[(0,r.Lk)("div",Je,[t[2]||(t[2]=(0,r.Lk)("label",{class:"text-muted"},"會員姓名",-1)),(0,r.Lk)("p",Ge,(0,o.v_)(i.userInfo.name),1)]),(0,r.Lk)("div",Ye,[t[3]||(t[3]=(0,r.Lk)("label",{class:"text-muted"},"電子信箱",-1)),(0,r.Lk)("p",Ze,(0,o.v_)(i.userInfo.email),1)]),(0,r.Lk)("div",et,[t[4]||(t[4]=(0,r.Lk)("label",{class:"text-muted"},"聯絡電話",-1)),(0,r.Lk)("p",tt,(0,o.v_)(i.userInfo.phone),1)]),(0,r.Lk)("div",at,[t[5]||(t[5]=(0,r.Lk)("label",{class:"text-muted"},"聯絡地址",-1)),(0,r.Lk)("p",st,(0,o.v_)(i.userInfo.address),1)])])])]),(0,r.Lk)("div",rt,[(0,r.Lk)("div",ot,[(0,r.Lk)("div",it,[(0,r.Lk)("div",nt,[(0,r.Lk)("button",{class:"btn btn-primary",onClick:t[0]||(t[0]=(...e)=>n.addRecipient&&n.addRecipient(...e))},t[6]||(t[6]=[(0,r.Lk)("i",{class:"fas fa-plus me-2"},null,-1),(0,r.eW)("新增地址 ")]))]),(0,r.Lk)("div",ct,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(i.recipients,((e,a)=>((0,r.uX)(),(0,r.CE)("div",{key:e.id,class:"address-item"},[(0,r.Lk)("div",lt,[(0,r.Lk)("h6",dt,(0,o.v_)(e.name),1),(0,r.Lk)("p",ut,[t[7]||(t[7]=(0,r.Lk)("i",{class:"fas fa-phone me-2 text-muted"},null,-1)),(0,r.eW)(" "+(0,o.v_)(e.phone),1)]),(0,r.Lk)("p",pt,[t[8]||(t[8]=(0,r.Lk)("i",{class:"fas fa-map-marker-alt me-2 text-muted"},null,-1)),(0,r.eW)(" "+(0,o.v_)(e.address),1)])]),(0,r.Lk)("div",mt,[(0,r.Lk)("button",{class:"btn btn-link",onClick:e=>n.editRecipientInfo(a)},t[9]||(t[9]=[(0,r.Lk)("i",{class:"fas fa-edit"},null,-1)]),8,gt),(0,r.Lk)("button",{class:"btn btn-link text-danger",onClick:e=>n.deleteRecipient(a)},t[10]||(t[10]=[(0,r.Lk)("i",{class:"fas fa-trash"},null,-1)]),8,ht)])])))),128))])])])]),(0,r.Lk)("div",vt,[(0,r.Lk)("div",ft,[(0,r.Lk)("div",kt,[(0,r.Lk)("div",bt,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(i.orders,((e,t)=>((0,r.uX)(),(0,r.CE)("div",{key:e.id,class:"order-item"},[(0,r.Lk)("div",{class:"order-header",onClick:e=>n.toggleOrderDetails(t)},[(0,r.Lk)("div",null,[(0,r.Lk)("span",Lt,"#"+(0,o.v_)(e.id),1),(0,r.Lk)("span",It,(0,o.v_)(n.formateOrderDate(e.created_at)),1)]),(0,r.Lk)("div",null,[(0,r.Lk)("span",At,"NT$ "+(0,o.v_)(Math.round(e.total).toLocaleString()),1),(0,r.Lk)("i",{class:(0,o.C4)(["fas",i.expandedOrder===t?"fa-chevron-up":"fa-chevron-down","ms-2"])},null,2)])],8,yt),i.expandedOrder===t?((0,r.uX)(),(0,r.CE)("div",Ct,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(e.items,(e=>((0,r.uX)(),(0,r.CE)("div",{key:e.id,class:"order-product"},[(0,r.Lk)("img",{src:e.product_image?`/img/products/${e.product_image}`:"/img/welcome.jpg",alt:e.name,class:"product-img"},null,8,wt),(0,r.Lk)("div",Pt,[(0,r.Lk)("h6",null,(0,o.v_)(e.name),1),(0,r.Lk)("p",_t," 數量："+(0,o.v_)(e.quantity)+" × NT$ "+(0,o.v_)(e.price),1)]),(0,r.Lk)("div",Et," NT$ "+(0,o.v_)((e.quantity*e.price).toLocaleString()),1)])))),128))])):(0,r.Q3)("",!0)])))),128))])])])])])]),(0,r.Lk)("div",Rt,[(0,r.Lk)("button",{class:"btn btn-outline-danger",onClick:t[1]||(t[1]=(...e)=>n.handleLogout&&n.handleLogout(...e))},t[12]||(t[12]=[(0,r.Lk)("i",{class:"fas fa-sign-out-alt me-2"},null,-1),(0,r.eW)("登出 ")]))])])])}a(23215);var Ot=a(79539);const{userAPI:Tt,recipientAPI:xt}=q.A;var $t={name:"MemberPage",data(){return{showRecipient:!1,expandedOrder:null,isEditing:!1,isLoadingRecipients:!1,recipients:[],editRecipient:{name:" ",phone:" ",address:" "},editingIndex:-1,userInfo:{name:" ",email:" ",phone:"",address:""},orders:[]}},computed:{...(0,ce.aH)("auth",{isLoggedIn:e=>e.isLoggedIn,user:e=>e.user||{}}),filteredOrders(){return this.orders.map((e=>({...e,formattedDate:this.formatOrderDate(e.created_at)})))},getUserInitials(){return this.userInfo.name?this.userInfo.name.substring(0,2).toUpperCase():"??"}},async mounted(){try{if(!this.isLoggedIn)return alert("請先登入會員！"),void this.$router.push("/UserLogin");await Promise.all([this.loadUserInfo(),this.loadOrders(),this.loadRecipients()])}catch(e){(0,Ot.h)(e,"加載用戶信息失敗，請重試。")}},methods:{async loadUserInfo(){try{const e=this.user.id;if(console.log("用戶 ID:",e),!e)return void console.error("用戶ID無效");const t=await q.A.userAPI.getUserInfo(e);this.userInfo=t.data,console.log("用戶資料",this.userInfo)}catch(e){console.error("加載用戶信息時出錯:",e),(0,Ot.h)(e,"加載用戶信息失敗，請重試。")}},async loadOrders(){try{const e=await q.A.userAPI.getOrders();e.success&&(this.orders=e.data)}catch(e){console.error("載入訂單失敗:",e)}},async loadRecipients(){try{this.isLoadingRecipients=!0;const e=await q.A.recipientAPI.getRecipients(this.user.id);this.recipients=Array.isArray(e.data)?e.data:[]}catch(e){console.error("載入收件人資料失敗:",e),(0,Ot.h)(e,"載入收件人資料失敗")}finally{this.isLoadingRecipients=!1}},isRecipientValid(e){const t=/^[0-9]{10}$/;return e.name.trim()&&t.test(e.phone)&&e.address.trim()},async saveRecipient(){if(this.isRecipientValid(this.editRecipient))try{let e;this.isEditing?(e=await q.A.recipientAPI.updateRecipient(this.editRecipient.id,this.editRecipient),e.success&&(this.recipients[this.editingIndex]=e.data)):(e=await q.A.recipientAPI.addRecipient({...this.editRecipient,user_id:this.user.id}),e.success&&this.recipients.push(e.data)),this.hideModal(),alert(this.isEditing?"收件人資料已更新":"新增收件人成功")}catch(e){(0,Ot.h)(e,this.isEditing?"更新收件人失敗":"新增收件人失敗")}else alert("請檢查收件人資料是否完整且格式正確！")},async deleteRecipient(e){if(confirm("確定要刪除此收件人資料？"))try{const t=this.recipients[e].id,a=await q.A.recipientAPI.deleteRecipient(t);a.success&&(this.recipients.splice(e,1),alert("收件人資料已刪除"))}catch(t){(0,Ot.h)(t,"刪除收件人敗")}},toggleRecipient(){this.showRecipient=!this.showRecipient},addRecipient(){this.isEditing=!1,this.editRecipient={name:"",phone:"",address:""},this.showModal()},editRecipientInfo(e){this.isEditing=!0,this.editingIndex=e,this.editRecipient={...this.recipients[e]},this.showModal()},toggleOrderDetails(e){const t=this.orders[e];if(!t.items||!t.items.length)return void alert("該訂單無法顯示細節！");const a=e=>e.product_name&&e.quantity>0&&e.price>=0;t.items.every(a)?this.expandedOrder=this.expandedOrder===e?null:e:alert("該訂單數據不完整，無法展開！")},showModal(){if(this.$refs.recipientModal){const e=new U.aF(this.$refs.recipientModal);e.show()}},hideModal(){const e=U.aF.getInstance(this.$refs.recipientModal);e&&e.hide()},...(0,ce.i0)("auth",["logout"]),async handleLogout(){await this.logout(),alert("已成功登出!"),this.$router.push("/UserLogin")},formateOrderDate(e){if(!e)return"";const t=new Date(e);return t.toLocaleString("zh-TW",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"})},getOrderStatusClass(e){const t={pending:"badge bg-warning text-dark",processing:"badge bg-info text-white",shipped:"badge bg-primary text-white",completed:"badge bg-success text-white",cancelled:"badge bg-danger text-white"};return t[e]||"badge bg-secondary"},getOrderStatusText(e){const t={pending:"處理中",processing:"處理中",shipped:"已出貨",completed:"已完成",cancelled:"已取消"};return t[e]||"未知狀態"}}};const Dt=(0,M.A)($t,[["render",St],["__scopeId","data-v-96590a94"]]);var qt=Dt;function Ut(e,t,a,s,o,i){return t[0]||(t[0]=(0,r.Fv)('<div class="faq-search" data-v-7a8228db><input type="text" class="form-control" id="faqSearch" placeholder="搜尋問題..." data-v-7a8228db></div><div class="accordion" id="faqAccordion" data-v-7a8228db><div class="accordion-item faq-item" data-v-7a8228db><h2 class="accordion-header" id="headingOne" data-v-7a8228db><button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne" data-v-7a8228db> 問題一：如何註冊？ </button></h2><div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne" data-bs-parent="#faqAccordion" data-v-7a8228db><div class="accordion-body" data-v-7a8228db> 您可以點擊右上角的「註冊」按鈕，並按照提示填寫相關資訊來完成註冊。 </div></div></div><div class="accordion-item faq-item" data-v-7a8228db><h2 class="accordion-header" id="headingTwo" data-v-7a8228db><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo" data-v-7a8228db> 問題二：忘記密碼怎麼辦？ </button></h2><div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#faqAccordion" data-v-7a8228db><div class="accordion-body" data-v-7a8228db> 您可以點擊「忘記密碼」連結，輸入您的電子郵件，系統將發送密碼重置的指引給您。 </div></div></div></div><div class="contact-container contact" data-v-7a8228db><div class="contact-info" data-v-7a8228db><h4 data-v-7a8228db>或者透過以下表格聯絡</h4></div><div class="contact-form" data-v-7a8228db><form data-v-7a8228db><div class="mb-3" data-v-7a8228db><label for="name" class="form-label" data-v-7a8228db>姓名</label><input type="text" class="form-control" id="name" placeholder="請輸入您的姓名" data-v-7a8228db></div><div class="mb-3" data-v-7a8228db><label for="email" class="form-label" data-v-7a8228db>電子郵件</label><input type="email" class="form-control" id="email" placeholder="請輸入您的電子郵件" data-v-7a8228db></div><div class="mb-3" data-v-7a8228db><label for="message" class="form-label" data-v-7a8228db>留言</label><textarea class="form-control" id="message" rows="4" placeholder="請輸入您的訊息" data-v-7a8228db></textarea></div><button type="submit" class="btn btn-primary" data-v-7a8228db>送出</button></form></div></div>',3))}var Nt={name:"ContactUs",mounted(){const e=document.getElementById("faqSearch");e&&e.addEventListener("input",(function(){const e=this.ariaValueMax.toLowerCase();document.querySelectorAll(".faq-item").forEach((function(t){const a=t.querySelector("according-button").innerText.toLowerCase(),s=t.querySelector(".according-body").innerText.toLowerCase();a.includes(e)||s.includes(e)?t.style.display="block":t.style.display="none"}))}))}};const Xt=(0,M.A)(Nt,[["render",Ut],["__scopeId","data-v-7a8228db"]]);var Ft=Xt;function Mt(e,t,a,s,i,n){return(0,r.uX)(),(0,r.CE)("div",null,[t[0]||(t[0]=(0,r.Lk)("h1",null,"搜尋結果",-1)),(0,r.Lk)("p",null,"搜尋關鍵字："+(0,o.v_)(n.searchQuery),1)])}var Wt={name:"SearchResults",computed:{searchQuery(){return this.$route.query.q||"未指定"}}};const Kt=(0,M.A)(Wt,[["render",Mt]]);var Bt=Kt,jt=a(49659),Qt=a(29719);const Ht={class:"container"},Vt={class:"mb-3"};function zt(e,t,a,s,o,i){return(0,r.uX)(),(0,r.CE)("div",Ht,[t[4]||(t[4]=(0,r.Lk)("h5",null,"忘記密碼",-1)),(0,r.Lk)("form",{onSubmit:t[1]||(t[1]=(0,z.D$)(((...e)=>i.handleForgotPassword&&i.handleForgotPassword(...e)),["prevent"]))},[(0,r.Lk)("div",Vt,[t[2]||(t[2]=(0,r.Lk)("label",{for:"email",class:"form-label"},"電子郵件",-1)),(0,r.bo)((0,r.Lk)("input",{type:"email","onUpdate:modelValue":t[0]||(t[0]=e=>o.email=e),class:"form-control",id:"email",required:""},null,512),[[z.Jo,o.email]])]),t[3]||(t[3]=(0,r.Lk)("button",{type:"submit",class:"btn btn-primary"},"發送重設密碼連結信",-1))],32)])}var Jt=a(94373),Gt={name:"ForgotPwd",data(){return{email:""}},methods:{async handleForgotPassword(){try{const e=this.$route.params.token;await Jt.A.post(`/api/reset-password/${e}`,{newPassword:this.newPassword}),alert("密碼已成功重新設置！"),this.$router.push("/login")}catch(e){console.error("重設密碼錯誤,error"),alert("重設密碼失敗")}}}};const Yt=(0,M.A)(Gt,[["render",zt]]);var Zt=Yt;const ea={class:"order-confirmation container mt-5"},ta={key:0,class:"text-center"},aa={key:1,class:"text-center"},sa={key:2};function ra(e,t,a,s,i,n){const c=(0,r.g2)("router-link");return(0,r.uX)(),(0,r.CE)("div",ea,[t[3]||(t[3]=(0,r.Lk)("h2",{class:"text-center mb-4"},"訂單確認",-1)),s.isLoading?((0,r.uX)(),(0,r.CE)("div",ta,t[0]||(t[0]=[(0,r.Lk)("p",null,"正在加載訂單詳情...",-1)]))):s.orderDetails?((0,r.uX)(),(0,r.CE)("div",sa,[(0,r.Lk)("p",null,"感謝您的購買，您的訂單編號是："+(0,o.v_)(s.orderId),1),(0,r.bF)(c,{to:"/",class:"btn btn-primary mt-3"},{default:(0,r.k6)((()=>t[2]||(t[2]=[(0,r.eW)("繼續購物！")]))),_:1})])):((0,r.uX)(),(0,r.CE)("div",aa,t[1]||(t[1]=[(0,r.Lk)("p",null,"無法加載訂單詳情，請稍後再試。",-1)])))])}var oa={name:"OrderConfirmation",setup(){const e=(0,s.lq)(),t=(0,ce.Pj)(),a=(0,s.rd)(),o=e.params.orderId,i=(0,ne.KR)(null),n=(0,ne.KR)(!0),c=async()=>{n.value=!0;const e=/^[1-9]\d*$/.test(o);if(!e)return console.error("訂單編號格式不正確:",o),t.dispatch("notifications/showNotification",{type:"error",message:"訂單編號格式不正確，無法加載訂單詳情。"}),a.push("/").catch((e=>{"NavigationDuplicated"!==e.name&&console.error(e)})),void(n.value=!1);try{const e=await q.A.orderAPI.getOrderById(o);if(!e||!e.id)return console.error("訂單詳情數據不完整"),t.dispatch("notifications/showNotification",{type:"error",message:"訂單資料不完整，請聯繫客服。"}),void(n.value=!1);i.value=e}catch(s){s.response&&404===s.response.status?(console.error("訂單不存在",s),t.dispatch("notifications/showNotification",{type:"error",message:"訂單不存在，請確認您的訂單編號。"})):(console.error("加載訂單詳情時出錯",s),t.dispatch("notifications/showNotification",{type:"error",message:"加載訂單詳情時出錯，請稍後再試！"})),i.value=null}finally{n.value=!1}};return(0,r.sV)((()=>{if(!o)return console.error("訂單編號缺失"),void a.push("/").catch((e=>{"NavigationDuplicated"!==e.name&&console.error(e)}));c()})),{orderId:o,orderDetails:i,isLoading:n}}};const ia=(0,M.A)(oa,[["render",ra],["__scopeId","data-v-03bd47ad"]]);var na=ia,ca=a(89938),la=a(56689),da=a(42240),ua=a(94625),pa=a(89801),ma=a(7811),ga=a(83686),ha=a(62019),va=a(51839),fa=a(39812);const ka=[{path:"/",name:"HomePage",component:K},{path:"/admin",name:"AdminDashBoard",component:ca.A},{path:"/admin/Products",name:"AdminProducts",component:la.A},{path:"/admin/Users",name:"AdminUsers",component:da.A},{path:"/admin/Orders",name:"AdminOrders",component:ua.A,meta:{requiresAuth:!0,role:"admin"}},{path:"/admin/Orders/:id(\\d+)",name:"OrderDetail",component:ha.A,props:!0},{path:"/admin/CreateProduct",name:"CreateProduct",component:pa.A},{path:"/admin/EditProduct/:id",name:"EditProduct",component:ma.A},{path:"/admin/AdminContact",name:"AdminContact",component:ga.A},{path:"/admin/CarouselImages",name:"CarouselImages",component:va.A},{path:"/admin/SpecialOffers",name:"SpecialOffers",component:fa.A},{path:"/ShopCart",name:"ShopCart",component:V.A,meta:{requiresAuth:!0}},{path:"/ProductsList",name:"ProductsList",component:ye},{path:"/MembersPage",name:"MembersPage",component:qt,meta:{requiresAuth:!0}},{path:"/AboutUsPage",name:"AboutUsPage",component:H},{path:"/ContactUs",name:"ContactUs",component:Ft},{path:"/SearchResults",name:"SearchResults",component:Bt},{path:"/UserRegister",name:"UserRegister",component:jt.A},{path:"/UserLogin",name:"UserLogin",component:Qt.A},{path:"/ForgotPwd",name:"ForgotPwd",component:Zt},{path:"/ProductDetail/:id",name:"ProductDetail",component:qe},{path:"/Order-Confirmation/:orderId",name:"OrderConfirmation",component:na}],ba=(0,s.aE)({history:(0,s.LA)(),routes:ka});ba.beforeEach(((e,t,a)=>{const s=!!localStorage.getItem("authToken"),r=JSON.parse(localStorage.getItem("user")),o=r?r.role:null;e.matched.some((e=>e.meta.requiresAuth))?s?e.meta.role&&e.meta.role!==o?(alert("你沒有權限進入此頁面"),a({path:"/"})):a():(alert("請先登入再使用！"),a({path:"/UserLogin"})):a()}));var ya=ba},74300:function(e,t,a){var s=a(35720),r=a(94373);const o={setHeader(e,t){s.A.defaults.headers.common[e]=t},userAPI:{getAllUsers:()=>s.A.get("/users"),login:e=>s.A.post("/users/login",e),register:e=>s.A.post("/users/register",e),getUserInfo:e=>s.A.get(`/users/${e}`),updateUser:(e,t)=>s.A.put(`/users/${e}`,t),getRecipients:()=>s.A.get("/recipients")},productAPI:{getProducts:e=>s.A.get("/products",{params:e}),getProductById:e=>s.A.get(`/products/${e}`),createProduct:e=>s.A.post("/products",e),updateProduct:(e,t)=>s.A.put(`/products/${e}`,t),deleteProduct:e=>s.A.delete(`/products/${e}`),getAllProducts:()=>s.A.get("/products"),searchProducts:e=>s.A.get("/products/search",{params:e})},tagAPI:{getAllTags:()=>s.A.get("/tags"),createTag:e=>s.A.post("/tags",e),updateTag:(e,t)=>s.A.put(`/tags/${e}`,t),deleteTag:e=>s.A.delete(`/tags/${e}`)},brandAPI:{getAllBrands:()=>s.A.get("/brands"),createBrand:e=>s.A.post("/brands",e),updateBrand:(e,t)=>s.A.put(`/brands/${e}`,t),deleteBrand:e=>s.A.delete(`/brands/${e}`)},orderAPI:{createOrder:e=>s.A.post("/orders",e),getOrders:()=>s.A.get("/orders"),getOrderById:e=>s.A.get(`/orders/${e}`),updateOrder:(e,t)=>s.A.put(`/orders/${e}`,t)},recipientAPI:{getRecipients:e=>s.A.get("/recipients",{params:{user_id:e}}),updateRecipient:(e,t)=>s.A.put(`/recipients/${e}`,t),addRecipient:e=>s.A.post("/recipients",e),deleteRecipient:e=>s.A.delete(`/recipients/${e}`)},carouselAPI:{getAllCarouselImages:()=>s.A.get("/carousel_images"),getCarouselImages:()=>s.A.get("/carousel_images"),uploadCarouselImages:e=>s.A.post("/carousel_images",e,{headers:{"Content-Type":"multipart/form-data"}}),updateCarouselImage:(e,t)=>s.A.put(`/carousel_images/${e}`,t),deleteCarouselImage:e=>s.A.delete(`/carousel_images/${e}`)},specialOffersAPI:{getAllSpecialOffers:()=>s.A.get("/special_offers"),getSpecialOfferById:e=>s.A.get(`/special_offers/${e}`),createSpecialOffer:e=>s.A.post("/special_offers",e),updateSpecialOffer:(e,t)=>s.A.put(`/special_offers/${e}`,t),deleteSpecialOffer:e=>s.A.delete(`/special_offers/${e}`)},rankingAPI:{getRanking:e=>s.A.get("/ranking",{params:{days:e},baseURL:"https://34.169.83.101/api"})},createCancelToken:()=>{const e=r.A.CancelToken.source();return e}};t.A=o},8029:function(e,t,a){a.d(t,{A:function(){return f}});var s=a(4249),r=(a(44114),a(98992),a(72577),a(8872),{namespaced:!0,state:{items:[]},getters:{cartItems:e=>e.items,cartTotal:e=>e.items.reduce(((e,t)=>e+t.price*t.quantity),0),cartItemCount:e=>e.items.reduce(((e,t)=>e+t.quantity),0)},mutations:{addToCart(e,t){const a=Number(t.price);if(isNaN(a)||!t.id||!t.name)return void console.error("Invalid price value",t);const s=e.items.find((e=>e.id===t.id));s?s.quantity++:e.items.push({id:t.id,name:t.name,price:a,image:t.image||"/backend/public/img/wrong.png",quantity:1})},removeFromCart(e,t){e.items.splice(t,1)},updateCartItemQuantity(e,{index:t,quantity:a}){e.items[t].quantity=a<1?1:a},clearCart(e){e.items=[]}},actions:{addProductToCart({commit:e},t){t&&t.id?e("addToCart",t):console.error("Invalid product data")},removeItemFromCart({commit:e},t){e("removeFromCart",t)},updateItemQuantity({commit:e},t){e("updateCartItemQuantity",t)},clearShoppingCart({commit:e}){e("clearCart")}}}),o=a(74300),i={namespaced:!0,state:{isLoggedIn:!1,user:{role:""},showLoginModal:!1},mutations:{login(e,t){e.isLoggedIn=!0,e.user=t},logout(e){e.isLoggedIn=!1,e.user=null,localStorage.removeItem("user"),localStorage.removeItem("authToken")},setShowLoginModal(e,t){e.showLoginModal=t}},actions:{async login({commit:e},t){try{const a=await o.A.userAPI.login(t),{data:s}=a;if(console.log("Login Response Data:",s),!s||!s.token)throw new Error("無法取得用戶資料或 token");const{token:r}=s,{id:i,name:n,email:c,role:l,phone:d,address:u}=s,p={id:i,name:n,email:c,role:l,phone:d,address:u};return r?(localStorage.setItem("authToken",r),console.log("authToken stored:",r)):console.error("登入成功，但未收到 Token"),localStorage.setItem("user",JSON.stringify(p)),console.log("Stored Token:",r),console.log("Stored User:",p),e("login",p),a}catch(a){throw console.error("登入失敗:",a),a}},async checkAuthStatus({commit:e}){localStorage.getItem("authToken"),JSON.parse(localStorage.getItem("user"));return e("logout"),!1},logout({commit:e}){e("logout"),localStorage.removeItem("authToken"),localStorage.removeItem("user")},showLoginModal({commit:e},t){e("setShowLoginModal",t)}},getters:{isLoggedIn:e=>e.isLoggedIn,user:e=>e.user,showLoginModal:e=>e.showLoginModal}};a(37550);const n={notifications:[]},c=3,l=2e3,d={ADD_NOTIFICATION(e,t){if(!t.message||!t.type)return void console.error("Invalid notification data");e.notifications.length>=c&&e.notifications.shift();const a=e.notifications.some((e=>e.message===t.message&&e.type===t.type));a||(e.notifications.length>=c&&e.notifications.shift(),e.notifications.push(t))},REMOVE_NOTIFICATION(e,t){const a=e.notifications.findIndex((e=>e.id===t));-1!==a&&e.notifications.splice(a,1)}},u={showNotification({commit:e},{message:t,type:a,timeout:s=l}){if(!t||!a)return void console.error("Missing required notification parameters");const r=Date.now(),o={id:r,message:t,type:a};e("ADD_NOTIFICATION",o),s>0&&setTimeout((()=>{e("REMOVE_NOTIFICATION",r)}),s)},removeNotification({commit:e},t){e("REMOVE_NOTIFICATION",t)}};var p={namespaced:!0,state:n,mutations:d,actions:u},m=a(55131);const g=(0,s.y$)({modules:{cart:r,auth:i,notifications:p},plugins:[(0,m.A)()]}),h=localStorage.getItem("authToken"),v=localStorage.getItem("user");h&&v&&g.commit("auth/login",JSON.parse(v));var f=(0,s.y$)({modules:{cart:r,auth:i,notifications:p},plugins:[(0,m.A)()]})},79539:function(e,t,a){function s(e,t="操作失敗",a={}){const{showDetailedError:s=!1,customHandler:r=null}=a;if(console.error("API錯誤:",e),e.response){const{status:a,data:s}=e.response,o=s?.message||t;if(console.error("錯誤回應:",e.response),"function"===typeof r)return r(e);switch(a){case 401:alert("未授權：請重新登入");break;case 404:alert("資源未找到："+o);break;case 500:alert("伺服器錯誤，請稍後再試");break;default:alert(o)}}else e.request?(console.error("未收到伺服器響應:",e.request),alert("無法連接到伺服器，請檢查網絡")):(console.error("未知錯誤:",e.message),alert(t))}a.d(t,{h:function(){return s}})},55019:function(e,t){const a=(e,t="carousel")=>{if(console.log("[imageUrl.js] input imagePath:",e,"type:",t),!e)return"/img/wrong.png";if(e.startsWith("http"))return e;let a="";"carousel"===t?(a="https://34.169.83.101/api/img/carouselImages",console.log("[imageUrl.js] (carousel) baseUrl:",a)):"product"===t?(a="https://34.169.83.101/api/img/products",console.log("[imageUrl.js] (product) baseUrl:",a)):a="https://34.169.83.101/api";let s=e;s.startsWith("/api")&&(s=s.replace(/^\/api/,""),console.log("[imageUrl.js] removing leading /api from imagePath, new cleanPath:",s));let r=a;return r.endsWith("/")||s.startsWith("/")||(r+="/"),r+=s,console.log("[imageUrl.js] finalUrl =",r),r};t.A=a},35720:function(e,t,a){var s=a(94373);a(8029);const r=s.A.create({baseURL:"https://34.169.83.101/api",timeout:1e4,withCredentials:!0});r.interceptors.request.use((e=>{const t=localStorage.getItem("authToken");JSON.parse(localStorage.getItem("user"));return t&&(e.headers["Authorization"]=`Bearer ${t}`),e.headers["Content-Type"]||(e.headers["Content-Type"]="application/json"),e}),(e=>(console.error("Request error:",e),Promise.reject(e)))),r.interceptors.response.use((e=>e.data),(e=>{const{response:t}=e;let a="發生錯誤";if(t)switch(t.status){case 401:a="未授權或登入已過期，請重新登入",localStorage.removeItem("authToken"),localStorage.removeItem("user"),alert(a),window.location.href="/UserLogin";break;case 403:a="拒絕訪問";break;case 404:a="請求錯誤，未找到該資源";break;case 500:a="伺服器錯誤";break;default:a=t.data?.message||"未知錯誤"}else"ECONNABORTED"===e.code&&(a="請求超時，請稍後再試！");return console.error("Response error:",e),Promise.reject(new Error(a))})),t.A=r}}]);